<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>ramanchada2 API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#purpose">Purpose</a>
  <ul>
    <li><a href="#cha"><code>md5-7866ebf4eb202d06ea0d6f83557b7679</code"></a></li>
  </ul></li>
  <li><a href="#features">Features</a>
  <ul>
    <li><a href="#read-simulated-data">Read simulated data</a></li>
    <li><a href="#models">Models</a></li>
    <li><a href="#generate-spectra">Generate spectra</a></li>
    <li><a href="#spectrum-manipulation">Spectrum manipulation</a></li>
  </ul></li>
  <li><a href="#concept">Concept</a></li>
  <li><a href="#file-formats">File formats</a>
  <ul>
    <li><a href="#cha"><code>.cha</code></a></li>
    <li><a href="#nexus-format">Nexus format</a></li>
  </ul></li>
  <li><a href="#decorated-functions-in-spectrum">Decorated Functions in Spectrum</a></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="ramanchada2/auxiliary.html">auxiliary</a></li>
                    <li><a href="ramanchada2/io.html">io</a></li>
                    <li><a href="ramanchada2/misc.html">misc</a></li>
                    <li><a href="ramanchada2/protocols.html">protocols</a></li>
                    <li><a href="ramanchada2/spectral_components.html">spectral_components</a></li>
                    <li><a href="ramanchada2/spectrum.html">spectrum</a></li>
                    <li><a href="ramanchada2/theoretical_lines.html">theoretical_lines</a></li>
            </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
ramanchada2    </h1>

                        <div class="docstring"><h1 id="purpose">Purpose</h1>

<p><code><a href="">ramanchada2</a></code> software package is meant to fill the gap between the theoretical
Raman analysis and the experimental Raman spectroscopy by providing means to
compare data of different origin. The software is in early development stage
but still able to solve practical problems.</p>

<h1 id="features">Features</h1>

<h2 id="read-simulated-data">Read simulated data</h2>

<p>Process simulated data by <a href="https://www.vasp.at/">VASP</a> and <a href="https://www.crystal.unito.it/index.php">CRYSTAL</a> and provide same interface.
CRYSTAL data contain intensities for multiple orientations -- laser beam
incidents perpendicularly or parallelly to the observation and information
for mono-crystals. VASP data provide data only for poly-crystals but in
different format. So the perpendicular and parallel intensities are calculated
by an implemented <a href="https://doi.org/10.1103/PhysRevB.54.7830">algorithm</a>.</p>

<h2 id="models">Models</h2>

<p><a href="https://lmfit.github.io/lmfit-py/index.html">LMFIT</a> theoretical models can be build by spectral information obtained by
simulations or by provided by the user. These models can be fit to experimental
data, providing calibration information. At poor initial calibration the minimisation
procedure naturally fails. An iterative procedure aiming to solve this problem
was adopted in the code. On the first iteration the experimental spectrum lines
are artificially broadened. This makes it possible for the minimisation procedure
to find a parameters that are close enough to be used as an initial guess for
the second iteration. In few iterations the algorithm is able to fit to the original
experimental data. This idea is implemented and is at proof-of-concept level.</p>

<h2 id="generate-spectra">Generate spectra</h2>

<p>Spectra can be generated by the theoretical models. Random Poissonian noise and
artificial random-generated baseline can be added to the generated spectra, making
them convenient tools to test new methods for analysis.</p>

<h2 id="spectrum-manipulation">Spectrum manipulation</h2>

<p>A number of filters can be applied to spectra (experimental and generated).
Scaling on both x and y axes is possible. Scaling could be linear or arbitrary
user defined function. A convolution is possible with set of predefined functions
as well as user defined model.</p>

<h1 id="concept">Concept</h1>

<p>The code is object oriented, written in python. Main elements are Spectrum and
theoretical models. Theoretical models are based on LMFIT library, while
Spectrum is a custom made class. Spectrum object contains data for x and y axes
and metadata coming from experimental files or other sources. It is planned
to add information about the uncertainties in x and y. All filters and manipulation
procedures are available as class methods. Measures are taken to preserve spectrum
instances immutable, so filters are generating new spectra, preserving the original
unchanged. Additionally, Spectrum has information about its history -- the sequence
of applied filters.</p>

<h1 id="file-formats">File formats</h1>

<h2 id="cha"><code>.cha</code></h2>

<p><a href="https://github.com/h2020charisma/ramanchada">ramanchada</a> software package introduced <code>.cha</code> file format, which is an <a href="https://hdfgroup.org/">HDF5</a>
with a simple layout.</p>

<h3 id="cache-in-cha-files">Cache in .cha files</h3>

<p>The concept to keep previous variants of data is employed in <code><a href="">ramanchada2</a></code>. If
configured so, the software saves the data for all Spectrum instances to a
tree-organized <code>.cha</code> file. When a particular chain of operations is requested
by the user, the software checks if the final result is present in the cache file,
if so it is provided, otherwise the software checks for its parent. When a parent
or some of the grand parents are present, they are taken as a starting point and
the needed steps are applied to provide the final result. The current implementation
uses <a href="https://h5py.org/">h5py</a> library to access local hdf files. It is foreseen to have implementation
with <a href="https://github.com/HDFGroup/h5pyd">h5pyd</a> that support network operations.</p>

<h2 id="nexus-format">Nexus format</h2>

<p>The latest ramanchada2 package allows export of a spectrum to <a href="https://www.nexusformat.org/">NeXus</a> format.</p>

<h1 id="decorated-functions-in-spectrum">Decorated Functions in Spectrum</h1>

<h3 id="function-__add__">Function: <code>__add__</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-__init__">Function: <code>__init__</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-__mul__">Function: <code>__mul__</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-__sub__">Function: <code>__sub__</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-__truediv__">Function: <code>__truediv__</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-abs_nm_to_shift_cm_1">Function: <code>abs_nm_to_shift_cm_1</code></h3>

<p><strong>Docstring:</strong> 
Convert wavelength to Ramanshift in wavenumber</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Corrected x-values</p>

<hr />

<h3 id="function-abs_nm_to_shift_cm_1_filter">Function: <code>abs_nm_to_shift_cm_1_filter</code></h3>

<p><strong>Docstring:</strong> 
Convert wavelength to Ramanshift in wavenumber</p>

<h6 id="arguments-2">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Spectrum with corrected x-values</p>

<hr />

<h3 id="function-add_baseline">Function: <code>add_baseline</code></h3>

<p><strong>Docstring:</strong> 
Add artificial baseline to the spectrum.
A random baseline is generated in frequency domain using uniform random numbers.
The baseline in frequency domain is tapered with bohman window to reduce the bandwidth
of the baseline to first <code>n_freq</code> frequencies and is transformed to "time" domain.
Additionaly by using <code>func</code> parameter the user can define arbitrary function
to be added as baseline.</p>

<h6 id="arguments-3">Arguments:</h6>

<ul>
<li><strong>n_freq:</strong>  Must be <code>&gt; 2</code>. Number of lowest frequency bins distinct from zero.</li>
<li><strong>amplitude:</strong>  Upper boundary for the uniform random generator.</li>
<li><strong>pedestal:</strong>  Additive constant pedestal to the spectrum.</li>
<li><strong>func:</strong>  Callable. User-defined function to be added as baseline. Example: <code>func = lambda x: x*.01 + x**2*.0001</code>.</li>
<li><strong>rng_seed:</strong>  <code>int</code>, optional. Seed for the random generator.</li>
</ul>

<hr />

<h3 id="function-add_gaussian_noise">Function: <code>add_gaussian_noise</code></h3>

<p><strong>Docstring:</strong> 
Add gaussian noise to the spectrum.</p>

<p>Random number i.i.d. $N(0, \sigma)$ is added to every sample</p>

<h6 id="arguments-4">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>sigma:</strong>  Sigma of the gaussian noise.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional, seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-add_gaussian_noise_drift">Function: <code>add_gaussian_noise_drift</code></h3>

<p><strong>Docstring:</strong> 
Add cumulative gaussian noise to the spectrum.</p>

<p>Exponential-moving-average-like gaussian noise is added
to each sample. The goal is to mimic the low-frequency noise
(or random substructures in spectra).
The additive noise is
$$a_i = coef*\sum_{j=0}^{i-1}g_j + g_i,$$</p>

<p>where
$$g_i = \mathcal{N}(0, 1+\frac{coef}{\sqrt 2}).$$</p>

<p>This way drifting is possible while keeping the
$$\sigma(\Delta(a)) \approx 1.$$</p>

<h6 id="arguments-5">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>sigma:</strong>  Sigma of the gaussian noise.</li>
<li><strong>coef:</strong>  <code>float</code> in <code>[0, 1]</code>, drifting coefficient. If <code>coef == 0</code>,
the result is identical to <code>add_gaussian_noise()</code>.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional. Seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-add_poisson_noise">Function: <code>add_poisson_noise</code></h3>

<p><strong>Docstring:</strong> 
Add poisson noise to the spectrum.</p>

<p>For each particular sample the noise is proportional to $\sqrt{scale*a_i}$.</p>

<h6 id="arguments-6">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>scale:</strong>  <code>float</code>, optional, default is <code>1</code>. Scale the amplitude of the noise.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional. Seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-apply_processing">Function: <code>apply_processing</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-bayesian_gaussian_mixture">Function: <code>bayesian_gaussian_mixture</code></h3>

<p><strong>Docstring:</strong> 
Decompose the spectrum to Bayesian Gaussian Mixture</p>

<h6 id="arguments-7">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>n_samples:</strong>  optional. Defaults to 5000.
Resampled dataset size</li>
<li><strong>n_components:</strong>  optional. Defaults to 50.
Number of expected gaussian components</li>
<li><strong>max_iter:</strong>  optional. Defaults to 100.
Maximal number of iterations.</li>
<li><strong>moving_minimum_window:</strong>  optional. Defaults to None.
If None no moving minimum is subtracted, otherwise as specified.</li>
<li><strong>random_state:</strong>  optional. Defaults to None.
Random generator seed to be used.</li>
<li><strong>trim_range:</strong>  optional. Defaults to None:
If None ignore trimming, otherwise trim range is in x-axis values.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>BayesianGaussianMixture: Fitted Bayesian Gaussian Mixture</p>
</blockquote>

<hr />

<h3 id="function-calibrate_by_deltas_filter">Function: <code>calibrate_by_deltas_filter</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-calibrate_by_deltas_model">Function: <code>calibrate_by_deltas_model</code></h3>

<p><strong>Docstring:</strong> </p>

<ul>
<li>Builds a composite model based on a set of user specified delta lines.</li>
<li>Initial guess is calculated based on 10-th and 90-th percentiles of
the distributions.</li>
</ul>

<p>The phasespace of the model is flat with big amount of narrow minima.
In order to find the best fit, the experimental data are successively
convolved with gaussians with different widths startign from wide to
narrow. The model for the calibration is 3-th order polynomial, which
potentialy can be changed for higher order polynomial. In order to avoid
solving the inverse of the calibration function, the result is tabulated
and interpolated linarly for each bin of the spectrum.
This alogrithm is useful for corse calibration.</p>

<hr />

<h3 id="function-central_moments">Function: <code>central_moments</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-convolve">Function: <code>convolve</code></h3>

<p><strong>Docstring:</strong> 
Convole spectrum with arbitrary lineshape.</p>

<h6 id="arguments-8">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>lineshape:</strong> callable, <code>str</code> or <code>np.ndarray</code>.
 If callable: should have a single positional argument <code>x</code>, e.g.
<code>lambda x: np.exp((x/5)**2)</code>.
If predefined peak profile: can be <code>gaussian</code>, <code>lorentzian</code>, <code>voigt</code>,
<code>pvoigt</code>, <code>moffat</code> or <code>pearson4</code>.
If <code>np.ndarray</code>: lineshape in samples.</li>
<li><strong>**kwargs:</strong>  Additional kwargs will be passed to lineshape function.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-derivative_sharpening">Function: <code>derivative_sharpening</code></h3>

<p><strong>Docstring:</strong> 
Derivative-based sharpening.</p>

<p>Sharpen the spectrum subtracting second derivative and add fourth derivative.</p>

<h6 id="arguments-9">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>filter_fraction <code>float</code> in (0; 1]:</strong>  Default is 0.6
Depth of filtration</li>
<li><strong>signal_width:</strong>  The width of features to be enhanced in sample count</li>
<li><strong>der2_factor:</strong>  Second derivative scaling factor</li>
<li><strong>der4_factor:</strong>  Fourth derivative scaling factor</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-drop_spikes">Function: <code>drop_spikes</code></h3>

<p><strong>Docstring:</strong> 
Removes single-bin spikes.</p>

<p>Remove x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold.</p>

<h6 id="arguments-10">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-dropna">Function: <code>dropna</code></h3>

<p><strong>Docstring:</strong> 
Remove non finite numbers on both axes</p>

<h6 id="arguments-11">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-find_peak_multipeak">Function: <code>find_peak_multipeak</code></h3>

<p><strong>Docstring:</strong> 
Find groups of peaks in spectrum.</p>

<h6 id="arguments-12">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>prominence:</strong>  Optional. Defaults to None
If None the prominence value will be <code>spe.y_nose</code>. Reasonable value for
promience is <code>const * spe.y_noise_MAD</code>.</li>
<li><strong>wlen:</strong>  optional. Defaults to None.
wlen value used in <code>scipy.signal.find_peaks</code>. If wlen is None, 200 will be used.</li>
<li><strong>width:</strong>  optional. Defaults to None.
width value used in <code>scipy.signal.find_peaks</code>. If width is None, 2 will be used.</li>
<li><strong>hht_chain:</strong>  optional. Defaults to None.
List of hht_chain window sizes. If None, no hht sharpening is performed.</li>
<li><strong>bgm_kwargs:</strong>  kwargs for bayesian_gaussian_mixture</li>
<li>sharpening 'hht' or None. Defaults to None.
If 'hht' hht sharpening will be performed before finding peaks.</li>
<li><strong>strategy:</strong>  optional. Defauts to 'topo'.
Peakfinding method</li>
</ul>

<h6 id="returns-2">Returns:</h6>

<blockquote>
  <p>ListPeakCandidateMultiModel: Located peak groups</p>
</blockquote>

<hr />

<h3 id="function-find_peak_multipeak_filter">Function: <code>find_peak_multipeak_filter</code></h3>

<p><strong>Docstring:</strong> 
Same as <code>find_peak_multipeak</code> but the result is stored as metadata in the returned spectrum.</p>

<h6 id="arguments-13">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong><em>args, *</em>kwargs:</strong>  same as <code>find_peak_multipeak</code></li>
</ul>

<hr />

<h3 id="function-fit_peak_multimodel">Function: <code>fit_peak_multimodel</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-fit_peak_positions">Function: <code>fit_peak_positions</code></h3>

<p><strong>Docstring:</strong> 
Calculate peak positions and amplitudes.</p>

<p>Sequence of multiple processings:</p>

<ul>
<li><code>subtract_moving_minimum</code></li>
<li><code>find_peak_multipeak</code></li>
<li>filter peaks with x-location better than threshold</li>
</ul>

<h6 id="arguments-14">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>mov_min:</strong>  optional. Defaults to 40
subtract moving_minimum with the specified window.</li>
<li><strong>center_err_threshold:</strong>  optional. Defaults to 0.5.
threshold for centroid standard deviation. Only peaks
with better uncertainty will be returned.</li>
<li><strong>find_peaks_kw:</strong>  optional
keyword arguments to be used with find_peak_multipeak</li>
<li><strong>fit_peaks_kw:</strong>  optional
keyword arguments to be used with fit_peaks_multipeak</li>
</ul>

<h6 id="returns-3">Returns:</h6>

<blockquote>
  <p>Dict[float, float]: {positions: amplitudes}</p>
</blockquote>

<hr />

<h3 id="function-fit_peaks_filter">Function: <code>fit_peaks_filter</code></h3>

<p><strong>Docstring:</strong> 
Same as <code>fit_peak_multipeak</code> but the result is stored as metadata in the returned spectrum.</p>

<h6 id="arguments-15">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>should_break:</strong>  same as in fit_peaks_multipeak</li>
<li><strong><em>args, *</em>kwargs:</strong>  same as <code>fit_peaks_multipeak</code></li>
</ul>

<hr />

<h3 id="function-from_cache_or_calc">Function: <code>from_cache_or_calc</code></h3>

<p><strong>Docstring:</strong> 
Load spectrum from cache or calculate if needed.</p>

<p>The cache is a nested structure of spectra. All processings applied to
a spectrum result to spectra of the initial one. If part of the requred
processings are available, only the needed steps are calculated and added
to the cache.</p>

<h6 id="arguments-16">Arguments:</h6>

<ul>
<li><strong>required_steps:</strong>  List of required steps in the form
[{'proc': str, 'args': List[Any], 'kwargs': Dict[str, Any]}, ...]</li>
<li><strong>cachefile:</strong>  optional. Defaults to None.
Filename of the cache. If None no cache is used</li>
</ul>

<hr />

<h3 id="function-from_chada">Function: <code>from_chada</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-from_delta_lines">Function: <code>from_delta_lines</code></h3>

<p><strong>Docstring:</strong> 
Generate <code>Spectrum</code> with delta lines.</p>

<h6 id="arguments-17">Arguments:</h6>

<ul>
<li><strong>deltas:</strong>  Keys of the dictionary are the <code>x</code> positions of the deltas; values are the amplitudes of the corresponding
deltas.</li>
<li><strong>xcal:</strong>  Callable, optional. <code>x</code> axis calibration function.</li>
<li><strong>nbins:</strong>  <code>int</code>, optional. Number of bins in the spectrum.</li>
<li><strong>xaxis:</strong>  <code>Array-like</code>, optional. The xaxis of the new spectrum. If <code>xaxis</code> is provided,
<code>xcal</code> should be <code>None</code> and <code>nbins</code> is ignored.</li>
</ul>

<p>Example:</p>

<p>This will produce spectrum with 1000 bins in the range <code>[-1000, 2000)</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">xcal</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">1000</span>
</code></pre>
</div>

<hr />

<h3 id="function-from_local_file">Function: <code>from_local_file</code></h3>

<p><strong>Docstring:</strong> 
Read experimental spectrum from a local file.</p>

<h6 id="arguments-18">Arguments:</h6>

<ul>
<li><strong>in_file_name:</strong>  Path to a local file containing a spectrum.</li>
<li><strong>filetype:</strong>  Specify the filetype. Filetype can be any of: <code>spc</code>, <code>sp</code>, <code>spa</code>, <code>0</code>, <code>1</code>, <code>2</code>, <code>wdf</code>, <code>ngs</code>, <code>jdx</code>, <code>dx</code>,
<code>txt</code>, <code>txtr</code>, <code>tsv</code>, <code>csv</code>, <code>dpt</code>, <code>prn</code>, <code>rruf</code>, <code>spe</code> (Princeton Instruments) or <code>None</code>.
<code>None</code> used to determine by extension of the file.</li>
<li><strong>backend:</strong>  <code>native</code>, <code>rc1_parser</code> or <code>None</code>. <code>None</code> means both.</li>
<li><strong>custom_meta:</strong>  Dict
Add custom metadata fields in the created spectrum</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  When called with unsupported file formats.</li>
</ul>

<hr />

<h3 id="function-from_simulation">Function: <code>from_simulation</code></h3>

<p><strong>Docstring:</strong> 
Generate spectrum from simulation file.</p>

<p>The returned spectrum has only few x/y pairs -- one for each simulated line. Values along
the x-axis will not be uniform. To make it uniform, one needs to resample the spectrum.</p>

<h6 id="arguments-19">Arguments:</h6>

<ul>
<li><strong>in_file:</strong>  Path to a local file, or file-like object.</li>
<li><strong>sim_type:</strong>  If <code>vasp</code>: <code>.dat</code> file from VASP simulation. If <code>crystal_out</code>: <code>.out</code> file from CRYSTAL simulation, not
preferred. If <code>crystal_dat</code>: <code>.dat</code> file from CRYSTAL simulation.</li>
<li><strong>use:</strong>  One of the directions <code>I_tot</code>, <code>I_perp</code>, <code>I_par</code>, <code>I_xx</code>, <code>I_xy</code>,
<code>I_xz</code>, <code>I_yy</code>, <code>I_yz</code>, <code>I_zz</code>, <code>I_tot</code>, <code>I_perp</code>, <code>I_par</code> are
available for both CRYSTAL and VASP. <code>I_xx</code>, <code>I_xy</code>, <code>I_xz</code>,
<code>I_yy</code>, <code>I_yz</code>, <code>I_zz</code> are available only for CRYSTAL. If a Dict is
passed, the key should be directions and values should be weighting factor.
For example, <code>use={'I_perp': .1, 'I_par': .9}</code></li>
</ul>

<hr />

<h3 id="function-from_spectral_component_collection">Function: <code>from_spectral_component_collection</code></h3>

<p><strong>Docstring:</strong> 
from_spectral_component_collection</p>

<h6 id="arguments-20">Arguments:</h6>

<ul>
<li><strong>spe_components:</strong>  SpectralComponentCollection</li>
<li><strong>x:</strong>  <code>int</code> or array-like, optional, default <code>2000</code>. <code>x</code> axis of the spectrum.</li>
</ul>

<hr />

<h3 id="function-from_stream">Function: <code>from_stream</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-from_test_spe">Function: <code>from_test_spe</code></h3>

<p><strong>Docstring:</strong> Create new spectrum from test data.</p>

<h6 id="arguments-21">Arguments:</h6>

<ul>
<li><strong>index:</strong>  <code>int</code> or <code>None</code>, optional, default is <code>None</code>. If <code>int</code>: will be used as an index of filtered list. If
<code>None</code>: a random spectrum will be taken.</li>
<li><strong>**kwargs:</strong>  The rest of the parameters will be used as filter.</li>
</ul>

<hr />

<h3 id="function-from_theoretical_lines">Function: <code>from_theoretical_lines</code></h3>

<p><strong>Docstring:</strong> 
Generate spectrum from <code>lmfit</code> shapes.</p>

<h6 id="arguments-22">Arguments:</h6>

<ul>
<li><strong>shapes:</strong>  The shapes to be used for spectrum generation.</li>
<li><strong>params:</strong>  Shape parameters to be applied to be used with shapes.</li>
<li><strong>x:</strong>  Array with <code>x</code> values, by default <code>np.array(2000)</code>.</li>
</ul>

<hr />

<h3 id="function-gen_samples">Function: <code>gen_samples</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-get_spikes">Function: <code>get_spikes</code></h3>

<p><strong>Docstring:</strong> 
Get single-bin spikes only.</p>

<p>Get x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold
and linear interpolation.</p>

<h6 id="arguments-23">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-hdr_from_multi_exposure">Function: <code>hdr_from_multi_exposure</code></h3>

<p><strong>Docstring:</strong> 
Create an HDR spectrum from several spectra with different exposures.</p>

<p>The resulting spectrum will have the details in low-intensity peaks
from long-exposure-time spectrum. As long-exposure-time
spectrum might be sturated, the information for high-intensity
peaks will be taken from short-exposure-time spectrum.</p>

<h6 id="arguments-24">Arguments:</h6>

<ul>
<li><strong>spes_in (List[Spectrum]):</strong>  Set of spectra with different exposures</li>
<li><strong>meta_exposure_time (str, optional):</strong>  The name of the metadata parameter
having the exposure/integration time. The units should be the same
for all the spectra. Defaults to 'intigration times(ms)'.</li>
<li><strong>meta_ymax (str, optional):</strong>  The name fo the metadata parameter having
the maximum ADC value. This value will be used as a threshold. If
value in a spectrum is higher, the value will be taken from a
spectrum with shorter exposure. Defaults to 'yaxis_max'.</li>
</ul>

<hr />

<h3 id="function-hht_sharpening">Function: <code>hht_sharpening</code></h3>

<p><strong>Docstring:</strong> 
Hilbert-Huang based sharpening.</p>

<p>In order to reduce the overshooting, moving minimum is subtracted from the result</p>

<h6 id="arguments-25">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>movmin:</strong>  optional. Default is 100
Window size for moving minimum</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-hht_sharpening_chain">Function: <code>hht_sharpening_chain</code></h3>

<p><strong>Docstring:</strong> 
Hilbert-Huang based chain sharpening.</p>

<p>Sequence of Hilbert-Huang sharpening procedures are performed.</p>

<h6 id="arguments-26">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>movmin:</strong>  List[int], optional. Default is [150, 50]
The numer of values in the list defines how many iterations
of HHT_sharpening will be performed and the values define
the moving minimum window sizes for the corresponding operations.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-moving_average">Function: <code>moving_average</code></h3>

<p><strong>Docstring:</strong> 
Moving average filter.</p>

<h6 id="arguments-27">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-moving_average_convolve">Function: <code>moving_average_convolve</code></h3>

<p><strong>Docstring:</strong> 
Moving average filter.</p>

<h6 id="arguments-28">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-moving_median">Function: <code>moving_median</code></h3>

<p><strong>Docstring:</strong> 
Moving median filter.</p>

<p>The resultant spectrum is moving minimum of the input.</p>

<h6 id="arguments-29">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-moving_minimum">Function: <code>moving_minimum</code></h3>

<p><strong>Docstring:</strong> 
Moving minimum baseline estimator.
Successive values are calculated as minima of rolling rectangular window.</p>

<hr />

<h3 id="function-normalize">Function: <code>normalize</code></h3>

<p><strong>Docstring:</strong> 
Normalize the spectrum.</p>

<h6 id="arguments-30">Arguments:</h6>

<ul>
<li><strong>strategy:</strong>  If <code>unity</code>: normalize to <code>sum(y)</code>. If <code>min_unity</code>: subtract the minimum and normalize to 'unity'. If
<code>unity_density</code>: normalize to <code>(y_i*x_i)</code>. If <code>unity_area</code>: same as <code>unity_density</code>. If <code>minmax</code>: scale
amplitudes in range <code>[0, 1]</code>. If 'L1' or 'L2': L1 or L2 norm without subtracting the pedestal.</li>
</ul>

<hr />

<h3 id="function-pad_zeros">Function: <code>pad_zeros</code></h3>

<p><strong>Docstring:</strong> 
Extend x-axis by 100% in both directions.</p>

<p>The x-axis of resultant spectrum will be:
$[x_{lower}-(x_{upper}-x_{lower})..(x_{upper}+(x_{upper}-x_{lower}))]$.
The length of the new spectrum is 3 times the original. The added values
are with an uniform step. In the middle is the original spectrum with
original x and y values. The coresponding y vallues for the newly added
x-values are always zeros.</p>

<h6 id="arguments-31">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-recover_spikes">Function: <code>recover_spikes</code></h3>

<p><strong>Docstring:</strong> 
Recover single-bin spikes.</p>

<p>Recover x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold
and linear interpolation.</p>

<h6 id="arguments-32">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-resample_nudft">Function: <code>resample_NUDFT</code></h3>

<p><strong>Docstring:</strong> 
Resample the spectrum using Non-uniform discrete fourier transform.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with NUDFT and inverse FFT.</p>

<h6 id="arguments-33">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>window:</strong>  optional, Defaults to None.
The window to be used for lowpass filter. If None 'blackmanharris' is used.
If no low-pass filter is required, one can use <code>window=lambda x: [1]*len(x)</code>.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<h6 id="returns-4">Returns:</h6>

<blockquote>
  <p>(x_values, y_values)</p>
</blockquote>

<hr />

<h3 id="function-resample_nudft_filter">Function: <code>resample_NUDFT_filter</code></h3>

<p><strong>Docstring:</strong> 
Resample the spectrum using Non-uniform discrete fourier transform.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with NUDFT and inverse FFT.</p>

<h6 id="arguments-34">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>window:</strong>  optional, Defaults to None.
The window to be used for lowpass filter. If None 'blackmanharris' is used.
If no low-pass filter is required, one can use <code>window=lambda x: [1]*len(x)</code>.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-resample_spline">Function: <code>resample_spline</code></h3>

<p><strong>Docstring:</strong> 
Resample the spectrum using spline interpolation.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with spline interpolation.</p>

<h6 id="arguments-35">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>spline:</strong>  optional, Defaults to 'pchip'.
Name of the spline funcion to be used.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<h6 id="returns-5">Returns:</h6>

<blockquote>
  <p>(x_values, y_values)</p>
</blockquote>

<hr />

<h3 id="function-resample_spline_filter">Function: <code>resample_spline_filter</code></h3>

<p><strong>Docstring:</strong> 
Resample the spectrum using spline interpolation.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with spline interpolation.</p>

<h6 id="arguments-36">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>spline:</strong>  optional, Defaults to 'pchip'.
Name of the spline funcion to be used.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-scale_xaxis_fun">Function: <code>scale_xaxis_fun</code></h3>

<p><strong>Docstring:</strong> 
Apply arbitrary calibration function to the x-axis values.</p>

<h6 id="arguments-37">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>fun:</strong>  function to be applied</li>
<li><strong>args:</strong>  Additional arguments to the provided functions</li>
</ul>

<p>Returns: Corrected spectrum</p>

<h6 id="raises-2">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the new x-values are not strictly monotonically increasing.</li>
</ul>

<hr />

<h3 id="function-scale_xaxis_linear">Function: <code>scale_xaxis_linear</code></h3>

<p><strong>Docstring:</strong> 
Scale x-axis using a factor.</p>

<h6 id="arguments-38">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>factor:</strong>  Defaults to 1.
Multiply x-axis values with <code>factor</code></li>
<li><strong>preserve_integral:</strong>  optional. Defaults to False.
If True, preserves the integral in sence
$\sum y_{orig;\,i}*{\Delta x_{orig}}_i = \sum y_{new;\,i}*{\Delta x_{new}}_i = $</li>
</ul>

<p>Returns: Corrected spectrum</p>

<hr />

<h3 id="function-scale_yaxis_linear">Function: <code>scale_yaxis_linear</code></h3>

<p><strong>Docstring:</strong> 
Scale y-axis values</p>

<p>This function provides the same result as <code>spe*const</code></p>

<h6 id="arguments-39">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li>factor optional. Defaults to 1.
Y-values scaling factor</li>
</ul>

<p>Returns: corrected spectrum</p>

<hr />

<h3 id="function-set_new_xaxis">Function: <code>set_new_xaxis</code></h3>

<p><strong>Docstring:</strong> 
Substitute x-axis values with new ones</p>

<h6 id="arguments-40">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>xaxis:</strong>  new x-axis values</li>
</ul>

<p>Returns: corrected spectrum</p>

<h6 id="raises-3">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided array does not match the shape of the spectrum.</li>
</ul>

<hr />

<h3 id="function-shift_cm_1_to_abs_nm">Function: <code>shift_cm_1_to_abs_nm</code></h3>

<p><strong>Docstring:</strong> 
Convert Ramanshift in wavenumber to wavelength</p>

<h6 id="arguments-41">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Corrected x-values</p>

<hr />

<h3 id="function-shift_cm_1_to_abs_nm_filter">Function: <code>shift_cm_1_to_abs_nm_filter</code></h3>

<p><strong>Docstring:</strong> 
Convert Ramanshift in wavenumber to wavelength</p>

<h6 id="arguments-42">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Spectrum with corrected x-values</p>

<hr />

<h3 id="function-smoothing_rc1">Function: <code>smoothing_RC1</code></h3>

<p><strong>Docstring:</strong> 
Smooth the spectrum.</p>

<p>The spectrum will be smoothed using the specified filter.
This method is inherited from ramanchada1 for compatibility reasons.</p>

<h6 id="arguments-43">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>method:</strong>  method to be used</li>
<li><strong>**kwargs:</strong>  keyword arguments to be passed to the selected method</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-spe_distribution">Function: <code>spe_distribution</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-spike_indices">Function: <code>spike_indices</code></h3>

<p><strong>Docstring:</strong> 
Find spikes in spectrum</p>

<p>Single-bin spikes are located using left and right successive
differences. The threshold is based on the standart deviation
of the metric which makes this algorithm less optimal.</p>

<h6 id="arguments-44">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  Threshold value should be <code>n_sigma</code> times the standart
deviation of the metric.</li>
</ul>

<p>Returns: List of spike indices</p>

<hr />

<h3 id="function-subtract_baseline_rc1_als">Function: <code>subtract_baseline_rc1_als</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-subtract_baseline_rc1_snip">Function: <code>subtract_baseline_rc1_snip</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-subtract_moving_median">Function: <code>subtract_moving_median</code></h3>

<p><strong>Docstring:</strong> 
Subtract moving median filter.</p>

<p>The resultant spectrum is moving minimum of the input subtracted from the input.</p>

<h6 id="arguments-45">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-subtract_moving_minimum">Function: <code>subtract_moving_minimum</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-trim_axes">Function: <code>trim_axes</code></h3>

<p><strong>Docstring:</strong> 
Trim axes of the spectrum.</p>

<h6 id="arguments-46">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>method:</strong>  'x-axis' or 'bins'
If 'x-axis' boundaries will be interpreted as x-axis values.
If 'bins' boundaries will be interpreted as indices.</li>
<li><strong>boundaries:</strong>  lower and upper boundary for the trimming.</li>
</ul>

<p>Returns: modified Spectrum</p>

<hr />

<h3 id="function-xcal_argmin2d_iter_lowpass">Function: <code>xcal_argmin2d_iter_lowpass</code></h3>

<p><strong>Docstring:</strong> 
Calibrate spectrum</p>

<p>The calibration is done in multiple steps. Both the spectrum and the reference
are passed through a low-pass filter to preserve only general structure of the
spectrum. <code>low_pass_nfreqs</code> defines the number of frequencies to be preserved in
each step. Once all steps with low-pass filter a final step without a low-pass
filter is performed. Each calibration step is performed using
<code>~<a href="ramanchada2/spectrum/calibration/by_deltas.html#xcal_fine">ramanchada2.spectrum.calibration.by_deltas.xcal_fine()</a></code> algorithm.</p>

<h6 id="arguments-47">Arguments:</h6>

<ul>
<li><strong>old_spe (Spectrum):</strong>  internal use only</li>
<li><strong>new_spe (Spectrum):</strong>  internal use only</li>
<li><strong>ref (Dict[float, float]):</strong>  wavenumber - amplitude pairs</li>
<li><strong>low_pass_nfreqs (List[int], optional):</strong>  The number of elements defines the
number of low-pass steps and their values define the amount of frequencies
to keep. Defaults to [100, 500].</li>
</ul>

<hr />

<h3 id="function-xcal_fine">Function: <code>xcal_fine</code></h3>

<p><strong>Docstring:</strong> 
Iterative calibration with provided reference based on <code>~<a href="ramanchada2/misc/utils/argmin2d.html#align">ramanchada2.misc.utils.argmin2d.align()</a></code></p>

<p>Iteratively apply polynomial of <code>poly_order</code> degree to match
the found peaks to the reference locations. The pairs are created
using <code>~<a href="ramanchada2/misc/utils/argmin2d.html#align">ramanchada2.misc.utils.argmin2d.align()</a></code> algorithm.</p>

<h6 id="arguments-48">Arguments:</h6>

<ul>
<li><strong>old_spe (Spectrum):</strong>  internal use only</li>
<li><strong>new_spe (Spectrum):</strong>  internal use only</li>
<li><strong>ref (Union[Dict[float, float], List[float]]):</strong>  _description_</li>
<li><strong>ref (Dict[float, float]):</strong>  If a dict is provided - wavenumber - amplitude pairs.
If a list is provided - wavenumbers only.</li>
<li><strong>poly_order (NonNegativeInt):</strong>  polynomial degree to be used usualy 2 or 3</li>
<li><strong>max_iter (NonNegativeInt):</strong>  max number of iterations for the iterative
polynomial alignment</li>
<li><strong>should_fit (bool, optional):</strong>  Whether the peaks should be fit or to
associate the positions with the maxima. Defaults to False.</li>
<li><strong>find_peaks_kw (dict, optional):</strong>  kwargs to be used in find_peaks. Defaults to {}.</li>
</ul>

<hr />

<h3 id="function-xcal_fine_rbf">Function: <code>xcal_fine_RBF</code></h3>

<p><strong>Docstring:</strong> Wavelength calibration using Radial basis fuction interpolation</p>

<p>Please be cautious! Interpolation might not be the most appropriate
approach for this type of calibration.</p>

<p>**kwargs are passed to RBFInterpolator</p>

<hr />

<h3 id="function-xcal_rough_poly2_all_pairs">Function: <code>xcal_rough_poly2_all_pairs</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-y_noise_savgol">Function: <code>y_noise_savgol</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />

<h3 id="function-y_noise_savgol_dl">Function: <code>y_noise_savgol_DL</code></h3>

<p><strong>Docstring:</strong> No docstring available</p>

<hr />
</div>

                        <input id="mod-ramanchada2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-ramanchada2-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd"># Purpose</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">`ramanchada2` software package is meant to fill the gap between the theoretical</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">Raman analysis and the experimental Raman spectroscopy by providing means to</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">compare data of different origin. The software is in early development stage</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">but still able to solve practical problems.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd"># Features</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">## Read simulated data</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">Process simulated data by [VASP][] and [CRYSTAL][] and provide same interface.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">CRYSTAL data contain intensities for multiple orientations -- laser beam</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">incidents perpendicularly or parallelly to the observation and information</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">for mono-crystals. VASP data provide data only for poly-crystals but in</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">different format. So the perpendicular and parallel intensities are calculated</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">by an implemented [algorithm][].</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">## Models</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">[LMFIT][] theoretical models can be build by spectral information obtained by</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">simulations or by provided by the user. These models can be fit to experimental</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">data, providing calibration information. At poor initial calibration the minimisation</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">procedure naturally fails. An iterative procedure aiming to solve this problem</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">was adopted in the code. On the first iteration the experimental spectrum lines</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">are artificially broadened. This makes it possible for the minimisation procedure</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">to find a parameters that are close enough to be used as an initial guess for</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">the second iteration. In few iterations the algorithm is able to fit to the original</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">experimental data. This idea is implemented and is at proof-of-concept level.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">## Generate spectra</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">Spectra can be generated by the theoretical models. Random Poissonian noise and</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">artificial random-generated baseline can be added to the generated spectra, making</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">them convenient tools to test new methods for analysis.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">## Spectrum manipulation</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">A number of filters can be applied to spectra (experimental and generated).</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">Scaling on both x and y axes is possible. Scaling could be linear or arbitrary</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">user defined function. A convolution is possible with set of predefined functions</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">as well as user defined model.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd"># Concept</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">The code is object oriented, written in python. Main elements are Spectrum and</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">theoretical models. Theoretical models are based on LMFIT library, while</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">Spectrum is a custom made class. Spectrum object contains data for x and y axes</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">and metadata coming from experimental files or other sources. It is planned</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">to add information about the uncertainties in x and y. All filters and manipulation</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">procedures are available as class methods. Measures are taken to preserve spectrum</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">instances immutable, so filters are generating new spectra, preserving the original</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">unchanged. Additionally, Spectrum has information about its history -- the sequence</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">of applied filters.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd"># File formats</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">## `.cha`</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">[ramanchada][] software package introduced `.cha` file format, which is an [HDF5][]</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">with a simple layout.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">### Cache in .cha files</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">The concept to keep previous variants of data is employed in `ramanchada2`. If</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">configured so, the software saves the data for all Spectrum instances to a</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">tree-organized `.cha` file. When a particular chain of operations is requested</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">by the user, the software checks if the final result is present in the cache file,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">if so it is provided, otherwise the software checks for its parent. When a parent</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">or some of the grand parents are present, they are taken as a starting point and</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">the needed steps are applied to provide the final result. The current implementation</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">uses [h5py][] library to access local hdf files. It is foreseen to have implementation</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">with [h5pyd][] that support network operations.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">## Nexus format</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">The latest ramanchada2 package allows export of a spectrum to [NeXus][] format.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">[CRYSTAL]: https://www.crystal.unito.it/index.php</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">[HDF5]: https://hdfgroup.org/</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">[LMFIT]: https://lmfit.github.io/lmfit-py/index.html</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">[VASP]: https://www.vasp.at/</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">[algorithm]: https://doi.org/10.1103/PhysRevB.54.7830</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">[h5py]: https://h5py.org/</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">[h5pyd]: https://github.com/HDFGroup/h5pyd</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">[ramanchada]: https://github.com/h2020charisma/ramanchada</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">[NeXus]: https://www.nexusformat.org/</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">.. include:: ../../../../../../spectrum_functions.md</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">spectrum</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">theoretical_lines</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="s1">&#39;auxiliary&#39;</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="s1">&#39;io&#39;</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="s1">&#39;misc&#39;</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="s1">&#39;protocols&#39;</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="s1">&#39;spectral_components&#39;</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="s1">&#39;spectrum&#39;</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    <span class="s1">&#39;theoretical_lines&#39;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="p">]</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.3.1&#39;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="n">green</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[32m&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="n">blue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[34m&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="n">yellow</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[33m&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="n">red</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[31m&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="n">bold_red</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[31;1m&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="n">reset</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[0m&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)d</span><span class="s2"> </span><span class="si">%(funcName)s</span><span class="s2">() - </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="n">FORMATS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span> <span class="n">green</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span> <span class="n">blue</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span> <span class="n">yellow</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span> <span class="n">red</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">reset</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span> <span class="n">bold_red</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">reset</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="p">}</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="n">log_fmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FORMATS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">levelno</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">log_fmt</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="k">def</span><span class="w"> </span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">):</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="n">ch</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="n">ch</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="n">ch</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">CustomFormatter</span><span class="p">())</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">handlers</span><span class="o">=</span><span class="p">[</span><span class="n">ch</span><span class="p">],</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="n">stream</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="n">stream</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">CustomFormatter</span><span class="p">())</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">handlers</span><span class="o">=</span><span class="p">[</span><span class="n">stream</span><span class="p">],</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></pre></div>


            </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>