<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>ramanchada2.spectrum.spectrum API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../spectrum.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;ramanchada2.spectrum</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="class" href="#Spectrum">Spectrum</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Spectrum.__init__">Spectrum</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.applied_processings_dict">applied_processings_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.write_csv">write_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.write_cha">write_cha</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.write_nexus">write_nexus</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.write_cache">write_cache</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.process">process</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.apply_creator">apply_creator</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.apply_processing">apply_processing</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.x">x</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.x_bin_boundaries">x_bin_boundaries</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.y_noise">y_noise</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.y_noise_MAD">y_noise_MAD</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.y_noise_savgol_DL">y_noise_savgol_DL</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.y_noise_savgol">y_noise_savgol</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.x_err">x_err</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.y_err">y_err</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.meta">meta</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectrum.result">result</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.spe_distribution">spe_distribution</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.gen_samples">gen_samples</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.add_baseline">add_baseline</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.moving_minimum">moving_minimum</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.subtract_moving_minimum">subtract_moving_minimum</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.subtract_baseline_rc1_als">subtract_baseline_rc1_als</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.subtract_baseline_rc1_snip">subtract_baseline_rc1_snip</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.central_moments">central_moments</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.abs_nm_to_shift_cm_1">abs_nm_to_shift_cm_1</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.shift_cm_1_to_abs_nm">shift_cm_1_to_abs_nm</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.abs_nm_to_shift_cm_1_filter">abs_nm_to_shift_cm_1_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.shift_cm_1_to_abs_nm_filter">shift_cm_1_to_abs_nm_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.scale_xaxis_linear">scale_xaxis_linear</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.scale_xaxis_fun">scale_xaxis_fun</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.set_new_xaxis">set_new_xaxis</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.calibrate_by_deltas_model">calibrate_by_deltas_model</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.calibrate_by_deltas_filter">calibrate_by_deltas_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.xcal_fine">xcal_fine</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.xcal_fine_RBF">xcal_fine_RBF</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.xcal_argmin2d_iter_lowpass">xcal_argmin2d_iter_lowpass</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.xcal_rough_poly2_all_pairs">xcal_rough_poly2_all_pairs</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.scale_yaxis_linear">scale_yaxis_linear</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_cache_or_calc">from_cache_or_calc</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_chada">from_chada</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_delta_lines">from_delta_lines</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_local_file">from_local_file</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_simulation">from_simulation</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_spectral_component_collection">from_spectral_component_collection</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_stream">from_stream</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_test_spe">from_test_spe</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.from_theoretical_lines">from_theoretical_lines</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.hdr_from_multi_exposure">hdr_from_multi_exposure</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.add_poisson_noise">add_poisson_noise</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.pad_zeros">pad_zeros</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.add_gaussian_noise_drift">add_gaussian_noise_drift</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.moving_median">moving_median</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.subtract_moving_median">subtract_moving_median</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.spike_indices">spike_indices</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.drop_spikes">drop_spikes</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.recover_spikes">recover_spikes</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.get_spikes">get_spikes</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.convolve">convolve</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.trim_axes">trim_axes</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.moving_average">moving_average</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.moving_average_convolve">moving_average_convolve</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.smoothing_RC1">smoothing_RC1</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.dropna">dropna</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.resample_NUDFT">resample_NUDFT</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.resample_NUDFT_filter">resample_NUDFT_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.resample_spline">resample_spline</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.resample_spline_filter">resample_spline_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.add_gaussian_noise">add_gaussian_noise</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.derivative_sharpening">derivative_sharpening</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.hht_sharpening">hht_sharpening</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.hht_sharpening_chain">hht_sharpening_chain</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.fit_peak_multimodel">fit_peak_multimodel</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.fit_peaks_filter">fit_peaks_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.bayesian_gaussian_mixture">bayesian_gaussian_mixture</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.fit_peak_positions">fit_peak_positions</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.find_peak_multipeak">find_peak_multipeak</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectrum.find_peak_multipeak_filter">find_peak_multipeak_filter</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../ramanchada2.html">ramanchada2</a><wbr>.<a href="./../spectrum.html">spectrum</a><wbr>.spectrum    </h1>

                
                        <input id="mod-spectrum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-spectrum-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">npt</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">PositiveInt</span><span class="p">,</span> <span class="n">validate_call</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">savgol_coeffs</span><span class="p">,</span> <span class="n">savgol_filter</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">median_abs_deviation</span><span class="p">,</span> <span class="n">rv_histogram</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ramanchada2.io.HSDS</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_cha</span><span class="p">,</span> <span class="n">write_nexus</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ramanchada2.io.output.write_csv</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_csv</span> <span class="k">as</span> <span class="n">io_write_csv</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ramanchada2.misc.plottable</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plottable</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ramanchada2.misc.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">PositiveOddInt</span><span class="p">,</span> <span class="n">SpeMetadataModel</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">ramanchada2.misc.types.spectrum</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">SpeProcessingListModel</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>                                             <span class="n">SpeProcessingModel</span><span class="p">)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Spectrum</span><span class="p">(</span><span class="n">Plottable</span><span class="p">):</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="n">_available_processings</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>                 <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>                 <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>                 <span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>                 <span class="n">metadata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeMetadataModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>                 <span class="n">applied_processings</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeProcessingListModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Plottable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span> <span class="o">=</span> <span class="n">cachefile</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">metadata</span> <span class="ow">or</span> <span class="n">SpeMetadataModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">{}))</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">applied_processings</span> <span class="ow">or</span> <span class="n">SpeProcessingListModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">[]))</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">):</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>                    <span class="sa">f</span><span class="s1">&#39;x and y shold have same dimentions len(x)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span><span class="si">}</span><span class="s1"> len(y)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="k">return</span> <span class="n">Spectrum</span><span class="p">(</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>            <span class="n">cachefile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>            <span class="n">applied_processings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">repr</span><span class="p">()</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">applied_processings_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="n">csv</span> <span class="o">=</span> <span class="n">io_write_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">csv</span><span class="p">:</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="n">write_cha</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_nexus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="n">write_nexus</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">write_cha</span><span class="p">(</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">,</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>                <span class="s1">&#39;/cache/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">cache_path</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/_data&#39;</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_available_processings</span><span class="p">:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown algorithm </span><span class="si">{algorithm}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_creator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="n">cachefile_</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">):</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="n">xerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x_err</span><span class="p">,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_err</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="p">)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sort_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="nd">@property</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x of the spectrum is not set. self._xdata is None&#39;</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="nd">@x</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="nd">@property</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_bin_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="p">))</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="nd">@property</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y of the spectrum is not set. self._ydata is None&#39;</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="nd">@y</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="nd">@property</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_noise_savgol</span><span class="p">()</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_MAD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol_DL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="n">summ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span> <span class="o">-</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">summ</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">/</span><span class="n">scale</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="c1"># subtract smoothed signal from original</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="o">-</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="c1"># normalize coefficients so that `sum(coeff**2) == 1`</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="n">coeff</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="c1"># remove the common floor</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">convolve</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">))</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="nd">@property</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="nd">@x_err</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_err</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x of the spectrum is not set. self._xdata is None&#39;</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                    <span class="s1">&#39;x_err should have same shape as xdata, expected </span><span class="si">{self._xdata.shape}</span><span class="s1">, got </span><span class="si">{val.shape}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="nd">@property</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="nd">@y_err</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_err</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y of the spectrum is not set. self._ydata is None&#39;</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                    <span class="s1">&#39;y_err should have same shape as ydata, expected </span><span class="si">{self._ydata.shape}</span><span class="s1">, got </span><span class="si">{val.shape}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>    <span class="nd">@property</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpeMetadataModel</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="nd">@meta</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">SpeMetadataModel</span><span class="p">]):</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">SpeMetadataModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="nd">@property</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;ramanchada2_filter_result&#39;</span><span class="p">]</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>    <span class="nd">@result</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">]):</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">ramanchada2_filter_result</span><span class="o">=</span><span class="n">res</span><span class="p">))</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">spe_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trim_range</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="n">x_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_bin_boundaries</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="n">trim_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="n">l_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">r_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">],</span> <span class="n">x_all</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">x_all</span><span class="p">))</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="n">spe_dist</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">PositiveInt</span><span class="p">,</span> <span class="n">trim_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="n">spe_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spe_distribution</span><span class="p">(</span><span class="n">trim_range</span><span class="o">=</span><span class="n">trim_range</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="n">samps</span> <span class="o">=</span> <span class="n">spe_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">samps</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger <a href="">ramanchada2.spectrum.spectrum</a> (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="Spectrum">
                            <input id="Spectrum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Spectrum</span><wbr>(<span class="base"><a href="../misc/plottable.html#Plottable">ramanchada2.misc.plottable.Plottable</a></span>):

                <label class="view-source-button" for="Spectrum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum-24"><a href="#Spectrum-24"><span class="linenos"> 24</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Spectrum</span><span class="p">(</span><span class="n">Plottable</span><span class="p">):</span>
</span><span id="Spectrum-25"><a href="#Spectrum-25"><span class="linenos"> 25</span></a>    <span class="n">_available_processings</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Spectrum-26"><a href="#Spectrum-26"><span class="linenos"> 26</span></a>
</span><span id="Spectrum-27"><a href="#Spectrum-27"><span class="linenos"> 27</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-28"><a href="#Spectrum-28"><span class="linenos"> 28</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Spectrum-29"><a href="#Spectrum-29"><span class="linenos"> 29</span></a>                 <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum-30"><a href="#Spectrum-30"><span class="linenos"> 30</span></a>                 <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum-31"><a href="#Spectrum-31"><span class="linenos"> 31</span></a>                 <span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum-32"><a href="#Spectrum-32"><span class="linenos"> 32</span></a>                 <span class="n">metadata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeMetadataModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum-33"><a href="#Spectrum-33"><span class="linenos"> 33</span></a>                 <span class="n">applied_processings</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeProcessingListModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum-34"><a href="#Spectrum-34"><span class="linenos"> 34</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Plottable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Spectrum-35"><a href="#Spectrum-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum-36"><a href="#Spectrum-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum-37"><a href="#Spectrum-37"><span class="linenos"> 37</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-38"><a href="#Spectrum-38"><span class="linenos"> 38</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Spectrum-39"><a href="#Spectrum-39"><span class="linenos"> 39</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span>
</span><span id="Spectrum-40"><a href="#Spectrum-40"><span class="linenos"> 40</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-41"><a href="#Spectrum-41"><span class="linenos"> 41</span></a>                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Spectrum-42"><a href="#Spectrum-42"><span class="linenos"> 42</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum-43"><a href="#Spectrum-43"><span class="linenos"> 43</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-44"><a href="#Spectrum-44"><span class="linenos"> 44</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Spectrum-45"><a href="#Spectrum-45"><span class="linenos"> 45</span></a>        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-46"><a href="#Spectrum-46"><span class="linenos"> 46</span></a>            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Spectrum-47"><a href="#Spectrum-47"><span class="linenos"> 47</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum-48"><a href="#Spectrum-48"><span class="linenos"> 48</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-49"><a href="#Spectrum-49"><span class="linenos"> 49</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="Spectrum-50"><a href="#Spectrum-50"><span class="linenos"> 50</span></a>
</span><span id="Spectrum-51"><a href="#Spectrum-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum-52"><a href="#Spectrum-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum-53"><a href="#Spectrum-53"><span class="linenos"> 53</span></a>
</span><span id="Spectrum-54"><a href="#Spectrum-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span> <span class="o">=</span> <span class="n">cachefile</span>
</span><span id="Spectrum-55"><a href="#Spectrum-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">metadata</span> <span class="ow">or</span> <span class="n">SpeMetadataModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">{}))</span>
</span><span id="Spectrum-56"><a href="#Spectrum-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">applied_processings</span> <span class="ow">or</span> <span class="n">SpeProcessingListModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">[]))</span>
</span><span id="Spectrum-57"><a href="#Spectrum-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-58"><a href="#Spectrum-58"><span class="linenos"> 58</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">):</span>
</span><span id="Spectrum-59"><a href="#Spectrum-59"><span class="linenos"> 59</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Spectrum-60"><a href="#Spectrum-60"><span class="linenos"> 60</span></a>                    <span class="sa">f</span><span class="s1">&#39;x and y shold have same dimentions len(x)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span><span class="si">}</span><span class="s1"> len(y)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum-61"><a href="#Spectrum-61"><span class="linenos"> 61</span></a>
</span><span id="Spectrum-62"><a href="#Spectrum-62"><span class="linenos"> 62</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-63"><a href="#Spectrum-63"><span class="linenos"> 63</span></a>        <span class="k">return</span> <span class="n">Spectrum</span><span class="p">(</span>
</span><span id="Spectrum-64"><a href="#Spectrum-64"><span class="linenos"> 64</span></a>            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">,</span>
</span><span id="Spectrum-65"><a href="#Spectrum-65"><span class="linenos"> 65</span></a>            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">,</span>
</span><span id="Spectrum-66"><a href="#Spectrum-66"><span class="linenos"> 66</span></a>            <span class="n">cachefile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">,</span>
</span><span id="Spectrum-67"><a href="#Spectrum-67"><span class="linenos"> 67</span></a>            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span>
</span><span id="Spectrum-68"><a href="#Spectrum-68"><span class="linenos"> 68</span></a>            <span class="n">applied_processings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="p">,</span>
</span><span id="Spectrum-69"><a href="#Spectrum-69"><span class="linenos"> 69</span></a>        <span class="p">)</span>
</span><span id="Spectrum-70"><a href="#Spectrum-70"><span class="linenos"> 70</span></a>
</span><span id="Spectrum-71"><a href="#Spectrum-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-72"><a href="#Spectrum-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">repr</span><span class="p">()</span>
</span><span id="Spectrum-73"><a href="#Spectrum-73"><span class="linenos"> 73</span></a>
</span><span id="Spectrum-74"><a href="#Spectrum-74"><span class="linenos"> 74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">applied_processings_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-75"><a href="#Spectrum-75"><span class="linenos"> 75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="Spectrum-76"><a href="#Spectrum-76"><span class="linenos"> 76</span></a>
</span><span id="Spectrum-77"><a href="#Spectrum-77"><span class="linenos"> 77</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-78"><a href="#Spectrum-78"><span class="linenos"> 78</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span><span id="Spectrum-79"><a href="#Spectrum-79"><span class="linenos"> 79</span></a>
</span><span id="Spectrum-80"><a href="#Spectrum-80"><span class="linenos"> 80</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="Spectrum-81"><a href="#Spectrum-81"><span class="linenos"> 81</span></a>        <span class="n">csv</span> <span class="o">=</span> <span class="n">io_write_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
</span><span id="Spectrum-82"><a href="#Spectrum-82"><span class="linenos"> 82</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Spectrum-83"><a href="#Spectrum-83"><span class="linenos"> 83</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">csv</span><span class="p">:</span>
</span><span id="Spectrum-84"><a href="#Spectrum-84"><span class="linenos"> 84</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Spectrum-85"><a href="#Spectrum-85"><span class="linenos"> 85</span></a>
</span><span id="Spectrum-86"><a href="#Spectrum-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="Spectrum-87"><a href="#Spectrum-87"><span class="linenos"> 87</span></a>        <span class="n">write_cha</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span><span id="Spectrum-88"><a href="#Spectrum-88"><span class="linenos"> 88</span></a>
</span><span id="Spectrum-89"><a href="#Spectrum-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_nexus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="Spectrum-90"><a href="#Spectrum-90"><span class="linenos"> 90</span></a>        <span class="n">write_nexus</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span><span id="Spectrum-91"><a href="#Spectrum-91"><span class="linenos"> 91</span></a>
</span><span id="Spectrum-92"><a href="#Spectrum-92"><span class="linenos"> 92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-93"><a href="#Spectrum-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">:</span>
</span><span id="Spectrum-94"><a href="#Spectrum-94"><span class="linenos"> 94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">write_cha</span><span class="p">(</span>
</span><span id="Spectrum-95"><a href="#Spectrum-95"><span class="linenos"> 95</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">,</span>
</span><span id="Spectrum-96"><a href="#Spectrum-96"><span class="linenos"> 96</span></a>                <span class="s1">&#39;/cache/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">cache_path</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/_data&#39;</span><span class="p">)</span>
</span><span id="Spectrum-97"><a href="#Spectrum-97"><span class="linenos"> 97</span></a>
</span><span id="Spectrum-98"><a href="#Spectrum-98"><span class="linenos"> 98</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum-99"><a href="#Spectrum-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_available_processings</span><span class="p">:</span>
</span><span id="Spectrum-100"><a href="#Spectrum-100"><span class="linenos">100</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown algorithm </span><span class="si">{algorithm}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum-101"><a href="#Spectrum-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum-102"><a href="#Spectrum-102"><span class="linenos">102</span></a>
</span><span id="Spectrum-103"><a href="#Spectrum-103"><span class="linenos">103</span></a>    <span class="nd">@classmethod</span>
</span><span id="Spectrum-104"><a href="#Spectrum-104"><span class="linenos">104</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-105"><a href="#Spectrum-105"><span class="linenos">105</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_creator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum-106"><a href="#Spectrum-106"><span class="linenos">106</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="Spectrum-107"><a href="#Spectrum-107"><span class="linenos">107</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="n">cachefile_</span><span class="p">)</span>
</span><span id="Spectrum-108"><a href="#Spectrum-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum-109"><a href="#Spectrum-109"><span class="linenos">109</span></a>
</span><span id="Spectrum-110"><a href="#Spectrum-110"><span class="linenos">110</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-111"><a href="#Spectrum-111"><span class="linenos">111</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">):</span>
</span><span id="Spectrum-112"><a href="#Spectrum-112"><span class="linenos">112</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="Spectrum-113"><a href="#Spectrum-113"><span class="linenos">113</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum-114"><a href="#Spectrum-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum-115"><a href="#Spectrum-115"><span class="linenos">115</span></a>
</span><span id="Spectrum-116"><a href="#Spectrum-116"><span class="linenos">116</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum-117"><a href="#Spectrum-117"><span class="linenos">117</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
</span><span id="Spectrum-118"><a href="#Spectrum-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="Spectrum-119"><a href="#Spectrum-119"><span class="linenos">119</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Spectrum-120"><a href="#Spectrum-120"><span class="linenos">120</span></a>            <span class="n">xerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x_err</span><span class="p">,</span>
</span><span id="Spectrum-121"><a href="#Spectrum-121"><span class="linenos">121</span></a>            <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_err</span><span class="p">,</span>
</span><span id="Spectrum-122"><a href="#Spectrum-122"><span class="linenos">122</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Spectrum-123"><a href="#Spectrum-123"><span class="linenos">123</span></a>        <span class="p">)</span>
</span><span id="Spectrum-124"><a href="#Spectrum-124"><span class="linenos">124</span></a>
</span><span id="Spectrum-125"><a href="#Spectrum-125"><span class="linenos">125</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sort_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-126"><a href="#Spectrum-126"><span class="linenos">126</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum-127"><a href="#Spectrum-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="Spectrum-128"><a href="#Spectrum-128"><span class="linenos">128</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum-129"><a href="#Spectrum-129"><span class="linenos">129</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum-130"><a href="#Spectrum-130"><span class="linenos">130</span></a>
</span><span id="Spectrum-131"><a href="#Spectrum-131"><span class="linenos">131</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-132"><a href="#Spectrum-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-133"><a href="#Spectrum-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-134"><a href="#Spectrum-134"><span class="linenos">134</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x of the spectrum is not set. self._xdata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum-135"><a href="#Spectrum-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span><span id="Spectrum-136"><a href="#Spectrum-136"><span class="linenos">136</span></a>
</span><span id="Spectrum-137"><a href="#Spectrum-137"><span class="linenos">137</span></a>    <span class="nd">@x</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-138"><a href="#Spectrum-138"><span class="linenos">138</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
</span><span id="Spectrum-139"><a href="#Spectrum-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="Spectrum-140"><a href="#Spectrum-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Spectrum-141"><a href="#Spectrum-141"><span class="linenos">141</span></a>
</span><span id="Spectrum-142"><a href="#Spectrum-142"><span class="linenos">142</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-143"><a href="#Spectrum-143"><span class="linenos">143</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_bin_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-144"><a href="#Spectrum-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
</span><span id="Spectrum-145"><a href="#Spectrum-145"><span class="linenos">145</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Spectrum-146"><a href="#Spectrum-146"><span class="linenos">146</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Spectrum-147"><a href="#Spectrum-147"><span class="linenos">147</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Spectrum-148"><a href="#Spectrum-148"><span class="linenos">148</span></a>        <span class="p">))</span>
</span><span id="Spectrum-149"><a href="#Spectrum-149"><span class="linenos">149</span></a>
</span><span id="Spectrum-150"><a href="#Spectrum-150"><span class="linenos">150</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-151"><a href="#Spectrum-151"><span class="linenos">151</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
</span><span id="Spectrum-152"><a href="#Spectrum-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-153"><a href="#Spectrum-153"><span class="linenos">153</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y of the spectrum is not set. self._ydata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum-154"><a href="#Spectrum-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span><span id="Spectrum-155"><a href="#Spectrum-155"><span class="linenos">155</span></a>
</span><span id="Spectrum-156"><a href="#Spectrum-156"><span class="linenos">156</span></a>    <span class="nd">@y</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-157"><a href="#Spectrum-157"><span class="linenos">157</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]):</span>
</span><span id="Spectrum-158"><a href="#Spectrum-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="Spectrum-159"><a href="#Spectrum-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Spectrum-160"><a href="#Spectrum-160"><span class="linenos">160</span></a>
</span><span id="Spectrum-161"><a href="#Spectrum-161"><span class="linenos">161</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-162"><a href="#Spectrum-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-163"><a href="#Spectrum-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_noise_savgol</span><span class="p">()</span>
</span><span id="Spectrum-164"><a href="#Spectrum-164"><span class="linenos">164</span></a>
</span><span id="Spectrum-165"><a href="#Spectrum-165"><span class="linenos">165</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_MAD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-166"><a href="#Spectrum-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="Spectrum-167"><a href="#Spectrum-167"><span class="linenos">167</span></a>
</span><span id="Spectrum-168"><a href="#Spectrum-168"><span class="linenos">168</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-169"><a href="#Spectrum-169"><span class="linenos">169</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol_DL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Spectrum-170"><a href="#Spectrum-170"><span class="linenos">170</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="Spectrum-171"><a href="#Spectrum-171"><span class="linenos">171</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum-172"><a href="#Spectrum-172"><span class="linenos">172</span></a>        <span class="n">summ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span> <span class="o">-</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Spectrum-173"><a href="#Spectrum-173"><span class="linenos">173</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="Spectrum-174"><a href="#Spectrum-174"><span class="linenos">174</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Spectrum-175"><a href="#Spectrum-175"><span class="linenos">175</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Spectrum-176"><a href="#Spectrum-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">summ</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">/</span><span class="n">scale</span>
</span><span id="Spectrum-177"><a href="#Spectrum-177"><span class="linenos">177</span></a>
</span><span id="Spectrum-178"><a href="#Spectrum-178"><span class="linenos">178</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-179"><a href="#Spectrum-179"><span class="linenos">179</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Spectrum-180"><a href="#Spectrum-180"><span class="linenos">180</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="Spectrum-181"><a href="#Spectrum-181"><span class="linenos">181</span></a>
</span><span id="Spectrum-182"><a href="#Spectrum-182"><span class="linenos">182</span></a>        <span class="c1"># subtract smoothed signal from original</span>
</span><span id="Spectrum-183"><a href="#Spectrum-183"><span class="linenos">183</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="o">-</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="Spectrum-184"><a href="#Spectrum-184"><span class="linenos">184</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Spectrum-185"><a href="#Spectrum-185"><span class="linenos">185</span></a>
</span><span id="Spectrum-186"><a href="#Spectrum-186"><span class="linenos">186</span></a>        <span class="c1"># normalize coefficients so that `sum(coeff**2) == 1`</span>
</span><span id="Spectrum-187"><a href="#Spectrum-187"><span class="linenos">187</span></a>        <span class="n">coeff</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Spectrum-188"><a href="#Spectrum-188"><span class="linenos">188</span></a>
</span><span id="Spectrum-189"><a href="#Spectrum-189"><span class="linenos">189</span></a>        <span class="c1"># remove the common floor</span>
</span><span id="Spectrum-190"><a href="#Spectrum-190"><span class="linenos">190</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum-191"><a href="#Spectrum-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">convolve</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">))</span>
</span><span id="Spectrum-192"><a href="#Spectrum-192"><span class="linenos">192</span></a>
</span><span id="Spectrum-193"><a href="#Spectrum-193"><span class="linenos">193</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-194"><a href="#Spectrum-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-195"><a href="#Spectrum-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-196"><a href="#Spectrum-196"><span class="linenos">196</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span><span id="Spectrum-197"><a href="#Spectrum-197"><span class="linenos">197</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-198"><a href="#Spectrum-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span>
</span><span id="Spectrum-199"><a href="#Spectrum-199"><span class="linenos">199</span></a>
</span><span id="Spectrum-200"><a href="#Spectrum-200"><span class="linenos">200</span></a>    <span class="nd">@x_err</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-201"><a href="#Spectrum-201"><span class="linenos">201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_err</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
</span><span id="Spectrum-202"><a href="#Spectrum-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-203"><a href="#Spectrum-203"><span class="linenos">203</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x of the spectrum is not set. self._xdata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum-204"><a href="#Spectrum-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-205"><a href="#Spectrum-205"><span class="linenos">205</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="Spectrum-206"><a href="#Spectrum-206"><span class="linenos">206</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Spectrum-207"><a href="#Spectrum-207"><span class="linenos">207</span></a>                    <span class="s1">&#39;x_err should have same shape as xdata, expected </span><span class="si">{self._xdata.shape}</span><span class="s1">, got </span><span class="si">{val.shape}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum-208"><a href="#Spectrum-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="Spectrum-209"><a href="#Spectrum-209"><span class="linenos">209</span></a>
</span><span id="Spectrum-210"><a href="#Spectrum-210"><span class="linenos">210</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-211"><a href="#Spectrum-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-212"><a href="#Spectrum-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-213"><a href="#Spectrum-213"><span class="linenos">213</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span><span id="Spectrum-214"><a href="#Spectrum-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-215"><a href="#Spectrum-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span>
</span><span id="Spectrum-216"><a href="#Spectrum-216"><span class="linenos">216</span></a>
</span><span id="Spectrum-217"><a href="#Spectrum-217"><span class="linenos">217</span></a>    <span class="nd">@y_err</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-218"><a href="#Spectrum-218"><span class="linenos">218</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_err</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
</span><span id="Spectrum-219"><a href="#Spectrum-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-220"><a href="#Spectrum-220"><span class="linenos">220</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y of the spectrum is not set. self._ydata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum-221"><a href="#Spectrum-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-222"><a href="#Spectrum-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="Spectrum-223"><a href="#Spectrum-223"><span class="linenos">223</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Spectrum-224"><a href="#Spectrum-224"><span class="linenos">224</span></a>                    <span class="s1">&#39;y_err should have same shape as ydata, expected </span><span class="si">{self._ydata.shape}</span><span class="s1">, got </span><span class="si">{val.shape}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum-225"><a href="#Spectrum-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="Spectrum-226"><a href="#Spectrum-226"><span class="linenos">226</span></a>
</span><span id="Spectrum-227"><a href="#Spectrum-227"><span class="linenos">227</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-228"><a href="#Spectrum-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpeMetadataModel</span><span class="p">:</span>
</span><span id="Spectrum-229"><a href="#Spectrum-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>
</span><span id="Spectrum-230"><a href="#Spectrum-230"><span class="linenos">230</span></a>
</span><span id="Spectrum-231"><a href="#Spectrum-231"><span class="linenos">231</span></a>    <span class="nd">@meta</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-232"><a href="#Spectrum-232"><span class="linenos">232</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-233"><a href="#Spectrum-233"><span class="linenos">233</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">SpeMetadataModel</span><span class="p">]):</span>
</span><span id="Spectrum-234"><a href="#Spectrum-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Spectrum-235"><a href="#Spectrum-235"><span class="linenos">235</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">SpeMetadataModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="Spectrum-236"><a href="#Spectrum-236"><span class="linenos">236</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-237"><a href="#Spectrum-237"><span class="linenos">237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="Spectrum-238"><a href="#Spectrum-238"><span class="linenos">238</span></a>
</span><span id="Spectrum-239"><a href="#Spectrum-239"><span class="linenos">239</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum-240"><a href="#Spectrum-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum-241"><a href="#Spectrum-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;ramanchada2_filter_result&#39;</span><span class="p">]</span>
</span><span id="Spectrum-242"><a href="#Spectrum-242"><span class="linenos">242</span></a>
</span><span id="Spectrum-243"><a href="#Spectrum-243"><span class="linenos">243</span></a>    <span class="nd">@result</span><span class="o">.</span><span class="n">setter</span>
</span><span id="Spectrum-244"><a href="#Spectrum-244"><span class="linenos">244</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">]):</span>
</span><span id="Spectrum-245"><a href="#Spectrum-245"><span class="linenos">245</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">ramanchada2_filter_result</span><span class="o">=</span><span class="n">res</span><span class="p">))</span>
</span><span id="Spectrum-246"><a href="#Spectrum-246"><span class="linenos">246</span></a>
</span><span id="Spectrum-247"><a href="#Spectrum-247"><span class="linenos">247</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-248"><a href="#Spectrum-248"><span class="linenos">248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">spe_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trim_range</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum-249"><a href="#Spectrum-249"><span class="linenos">249</span></a>        <span class="n">x_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_bin_boundaries</span>
</span><span id="Spectrum-250"><a href="#Spectrum-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="n">trim_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum-251"><a href="#Spectrum-251"><span class="linenos">251</span></a>            <span class="n">l_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="Spectrum-252"><a href="#Spectrum-252"><span class="linenos">252</span></a>            <span class="n">r_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="Spectrum-253"><a href="#Spectrum-253"><span class="linenos">253</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">],</span> <span class="n">x_all</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Spectrum-254"><a href="#Spectrum-254"><span class="linenos">254</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum-255"><a href="#Spectrum-255"><span class="linenos">255</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">x_all</span><span class="p">))</span>
</span><span id="Spectrum-256"><a href="#Spectrum-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">spe_dist</span>
</span><span id="Spectrum-257"><a href="#Spectrum-257"><span class="linenos">257</span></a>
</span><span id="Spectrum-258"><a href="#Spectrum-258"><span class="linenos">258</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum-259"><a href="#Spectrum-259"><span class="linenos">259</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">PositiveInt</span><span class="p">,</span> <span class="n">trim_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum-260"><a href="#Spectrum-260"><span class="linenos">260</span></a>        <span class="n">spe_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spe_distribution</span><span class="p">(</span><span class="n">trim_range</span><span class="o">=</span><span class="n">trim_range</span><span class="p">)</span>
</span><span id="Spectrum-261"><a href="#Spectrum-261"><span class="linenos">261</span></a>        <span class="n">samps</span> <span class="o">=</span> <span class="n">spe_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="Spectrum-262"><a href="#Spectrum-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">samps</span>
</span></pre></div>


            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                            <div id="Spectrum.__init__" class="classattr">
                                        <input id="Spectrum.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="name">Spectrum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]],</span> <span class="nb">int</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="../misc/types/spectrum/metadata.html#SpeMetadataModel">ramanchada2.misc.types.spectrum.metadata.SpeMetadataModel</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">applied_processings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="../misc/types/spectrum/applied_processings.html#SpeProcessingListModel">ramanchada2.misc.types.spectrum.applied_processings.SpeProcessingListModel</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Spectrum.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.__init__-27"><a href="#Spectrum.__init__-27"><span class="linenos">27</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.__init__-28"><a href="#Spectrum.__init__-28"><span class="linenos">28</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Spectrum.__init__-29"><a href="#Spectrum.__init__-29"><span class="linenos">29</span></a>                 <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.__init__-30"><a href="#Spectrum.__init__-30"><span class="linenos">30</span></a>                 <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.__init__-31"><a href="#Spectrum.__init__-31"><span class="linenos">31</span></a>                 <span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.__init__-32"><a href="#Spectrum.__init__-32"><span class="linenos">32</span></a>                 <span class="n">metadata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeMetadataModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.__init__-33"><a href="#Spectrum.__init__-33"><span class="linenos">33</span></a>                 <span class="n">applied_processings</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SpeProcessingListModel</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.__init__-34"><a href="#Spectrum.__init__-34"><span class="linenos">34</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">Plottable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="Spectrum.__init__-35"><a href="#Spectrum.__init__-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum.__init__-36"><a href="#Spectrum.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum.__init__-37"><a href="#Spectrum.__init__-37"><span class="linenos">37</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.__init__-38"><a href="#Spectrum.__init__-38"><span class="linenos">38</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Spectrum.__init__-39"><a href="#Spectrum.__init__-39"><span class="linenos">39</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span>
</span><span id="Spectrum.__init__-40"><a href="#Spectrum.__init__-40"><span class="linenos">40</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.__init__-41"><a href="#Spectrum.__init__-41"><span class="linenos">41</span></a>                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Spectrum.__init__-42"><a href="#Spectrum.__init__-42"><span class="linenos">42</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum.__init__-43"><a href="#Spectrum.__init__-43"><span class="linenos">43</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.__init__-44"><a href="#Spectrum.__init__-44"><span class="linenos">44</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Spectrum.__init__-45"><a href="#Spectrum.__init__-45"><span class="linenos">45</span></a>        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.__init__-46"><a href="#Spectrum.__init__-46"><span class="linenos">46</span></a>            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="Spectrum.__init__-47"><a href="#Spectrum.__init__-47"><span class="linenos">47</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum.__init__-48"><a href="#Spectrum.__init__-48"><span class="linenos">48</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.__init__-49"><a href="#Spectrum.__init__-49"><span class="linenos">49</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="Spectrum.__init__-50"><a href="#Spectrum.__init__-50"><span class="linenos">50</span></a>
</span><span id="Spectrum.__init__-51"><a href="#Spectrum.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum.__init__-52"><a href="#Spectrum.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectrum.__init__-53"><a href="#Spectrum.__init__-53"><span class="linenos">53</span></a>
</span><span id="Spectrum.__init__-54"><a href="#Spectrum.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span> <span class="o">=</span> <span class="n">cachefile</span>
</span><span id="Spectrum.__init__-55"><a href="#Spectrum.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">metadata</span> <span class="ow">or</span> <span class="n">SpeMetadataModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">{}))</span>
</span><span id="Spectrum.__init__-56"><a href="#Spectrum.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">applied_processings</span> <span class="ow">or</span> <span class="n">SpeProcessingListModel</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="p">[]))</span>
</span><span id="Spectrum.__init__-57"><a href="#Spectrum.__init__-57"><span class="linenos">57</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.__init__-58"><a href="#Spectrum.__init__-58"><span class="linenos">58</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">):</span>
</span><span id="Spectrum.__init__-59"><a href="#Spectrum.__init__-59"><span class="linenos">59</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Spectrum.__init__-60"><a href="#Spectrum.__init__-60"><span class="linenos">60</span></a>                    <span class="sa">f</span><span class="s1">&#39;x and y shold have same dimentions len(x)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span><span class="si">}</span><span class="s1"> len(y)=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.applied_processings_dict" class="classattr">
                                        <input id="Spectrum.applied_processings_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">applied_processings_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.applied_processings_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.applied_processings_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.applied_processings_dict-74"><a href="#Spectrum.applied_processings_dict-74"><span class="linenos">74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">applied_processings_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.applied_processings_dict-75"><a href="#Spectrum.applied_processings_dict-75"><span class="linenos">75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.write_csv" class="classattr">
                                        <input id="Spectrum.write_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_csv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>, </span><span class="param"><span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.write_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.write_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.write_csv-80"><a href="#Spectrum.write_csv-80"><span class="linenos">80</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="Spectrum.write_csv-81"><a href="#Spectrum.write_csv-81"><span class="linenos">81</span></a>        <span class="n">csv</span> <span class="o">=</span> <span class="n">io_write_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">)</span>
</span><span id="Spectrum.write_csv-82"><a href="#Spectrum.write_csv-82"><span class="linenos">82</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Spectrum.write_csv-83"><a href="#Spectrum.write_csv-83"><span class="linenos">83</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">csv</span><span class="p">:</span>
</span><span id="Spectrum.write_csv-84"><a href="#Spectrum.write_csv-84"><span class="linenos">84</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.write_cha" class="classattr">
                                        <input id="Spectrum.write_cha-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_cha</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">chafile</span>, </span><span class="param"><span class="n">dataset</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.write_cha-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.write_cha"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.write_cha-86"><a href="#Spectrum.write_cha-86"><span class="linenos">86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="Spectrum.write_cha-87"><a href="#Spectrum.write_cha-87"><span class="linenos">87</span></a>        <span class="n">write_cha</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.write_nexus" class="classattr">
                                        <input id="Spectrum.write_nexus-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_nexus</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">chafile</span>, </span><span class="param"><span class="n">dataset</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.write_nexus-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.write_nexus"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.write_nexus-89"><a href="#Spectrum.write_nexus-89"><span class="linenos">89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_nexus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
</span><span id="Spectrum.write_nexus-90"><a href="#Spectrum.write_nexus-90"><span class="linenos">90</span></a>        <span class="n">write_nexus</span><span class="p">(</span><span class="n">chafile</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.write_cache" class="classattr">
                                        <input id="Spectrum.write_cache-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_cache</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.write_cache-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.write_cache"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.write_cache-92"><a href="#Spectrum.write_cache-92"><span class="linenos">92</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.write_cache-93"><a href="#Spectrum.write_cache-93"><span class="linenos">93</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">:</span>
</span><span id="Spectrum.write_cache-94"><a href="#Spectrum.write_cache-94"><span class="linenos">94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">write_cha</span><span class="p">(</span>
</span><span id="Spectrum.write_cache-95"><a href="#Spectrum.write_cache-95"><span class="linenos">95</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_cachefile</span><span class="p">,</span>
</span><span id="Spectrum.write_cache-96"><a href="#Spectrum.write_cache-96"><span class="linenos">96</span></a>                <span class="s1">&#39;/cache/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">cache_path</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/_data&#39;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.process" class="classattr">
                                        <input id="Spectrum.process-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.process-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.process"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.process-98"><a href="#Spectrum.process-98"><span class="linenos"> 98</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum.process-99"><a href="#Spectrum.process-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_available_processings</span><span class="p">:</span>
</span><span id="Spectrum.process-100"><a href="#Spectrum.process-100"><span class="linenos">100</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown algorithm </span><span class="si">{algorithm}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.process-101"><a href="#Spectrum.process-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.apply_creator" class="classattr">
                                        <input id="Spectrum.apply_creator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">apply_creator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">step</span><span class="p">:</span> <span class="n"><a href="../misc/types/spectrum/applied_processings.html#SpeProcessingModel">ramanchada2.misc.types.spectrum.applied_processings.SpeProcessingModel</a></span>,</span><span class="param">	<span class="n">cachefile_</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.apply_creator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.apply_creator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.apply_creator-103"><a href="#Spectrum.apply_creator-103"><span class="linenos">103</span></a>    <span class="nd">@classmethod</span>
</span><span id="Spectrum.apply_creator-104"><a href="#Spectrum.apply_creator-104"><span class="linenos">104</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.apply_creator-105"><a href="#Spectrum.apply_creator-105"><span class="linenos">105</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_creator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.apply_creator-106"><a href="#Spectrum.apply_creator-106"><span class="linenos">106</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="Spectrum.apply_creator-107"><a href="#Spectrum.apply_creator-107"><span class="linenos">107</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="n">cachefile_</span><span class="p">)</span>
</span><span id="Spectrum.apply_creator-108"><a href="#Spectrum.apply_creator-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.apply_processing" class="classattr">
                                        <input id="Spectrum.apply_processing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">apply_processing</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">step</span><span class="p">:</span> <span class="n"><a href="../misc/types/spectrum/applied_processings.html#SpeProcessingModel">ramanchada2.misc.types.spectrum.applied_processings.SpeProcessingModel</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.apply_processing-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.apply_processing"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.apply_processing-110"><a href="#Spectrum.apply_processing-110"><span class="linenos">110</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.apply_processing-111"><a href="#Spectrum.apply_processing-111"><span class="linenos">111</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">SpeProcessingModel</span><span class="p">):</span>
</span><span id="Spectrum.apply_processing-112"><a href="#Spectrum.apply_processing-112"><span class="linenos">112</span></a>        <span class="n">proc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">proc</span><span class="p">)</span>
</span><span id="Spectrum.apply_processing-113"><a href="#Spectrum.apply_processing-113"><span class="linenos">113</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">proc</span><span class="p">(</span><span class="o">*</span><span class="n">step</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">step</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.apply_processing-114"><a href="#Spectrum.apply_processing-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.x" class="classattr">
                                        <input id="Spectrum.x-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x</span>

                <label class="view-source-button" for="Spectrum.x-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.x"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.x-131"><a href="#Spectrum.x-131"><span class="linenos">131</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.x-132"><a href="#Spectrum.x-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.x-133"><a href="#Spectrum.x-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.x-134"><a href="#Spectrum.x-134"><span class="linenos">134</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x of the spectrum is not set. self._xdata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum.x-135"><a href="#Spectrum.x-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.x_bin_boundaries" class="classattr">
                                        <input id="Spectrum.x_bin_boundaries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x_bin_boundaries</span>

                <label class="view-source-button" for="Spectrum.x_bin_boundaries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.x_bin_boundaries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.x_bin_boundaries-142"><a href="#Spectrum.x_bin_boundaries-142"><span class="linenos">142</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.x_bin_boundaries-143"><a href="#Spectrum.x_bin_boundaries-143"><span class="linenos">143</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_bin_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.x_bin_boundaries-144"><a href="#Spectrum.x_bin_boundaries-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
</span><span id="Spectrum.x_bin_boundaries-145"><a href="#Spectrum.x_bin_boundaries-145"><span class="linenos">145</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
</span><span id="Spectrum.x_bin_boundaries-146"><a href="#Spectrum.x_bin_boundaries-146"><span class="linenos">146</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Spectrum.x_bin_boundaries-147"><a href="#Spectrum.x_bin_boundaries-147"><span class="linenos">147</span></a>            <span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Spectrum.x_bin_boundaries-148"><a href="#Spectrum.x_bin_boundaries-148"><span class="linenos">148</span></a>        <span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y" class="classattr">
                                        <input id="Spectrum.y-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y</span><span class="annotation">: numpy.ndarray[tuple[typing.Any, ...], numpy.dtype[numpy.float64]]</span>

                <label class="view-source-button" for="Spectrum.y-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y-150"><a href="#Spectrum.y-150"><span class="linenos">150</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.y-151"><a href="#Spectrum.y-151"><span class="linenos">151</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
</span><span id="Spectrum.y-152"><a href="#Spectrum.y-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.y-153"><a href="#Spectrum.y-153"><span class="linenos">153</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y of the spectrum is not set. self._ydata is None&#39;</span><span class="p">)</span>
</span><span id="Spectrum.y-154"><a href="#Spectrum.y-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y_noise" class="classattr">
                                        <input id="Spectrum.y_noise-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y_noise</span>

                <label class="view-source-button" for="Spectrum.y_noise-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y_noise"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y_noise-161"><a href="#Spectrum.y_noise-161"><span class="linenos">161</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.y_noise-162"><a href="#Spectrum.y_noise-162"><span class="linenos">162</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.y_noise-163"><a href="#Spectrum.y_noise-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_noise_savgol</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y_noise_MAD" class="classattr">
                                        <input id="Spectrum.y_noise_MAD-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">y_noise_MAD</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.y_noise_MAD-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y_noise_MAD"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y_noise_MAD-165"><a href="#Spectrum.y_noise_MAD-165"><span class="linenos">165</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_MAD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.y_noise_MAD-166"><a href="#Spectrum.y_noise_MAD-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y_noise_savgol_DL" class="classattr">
                                        <input id="Spectrum.y_noise_savgol_DL-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(validate_default=True))</div>

        <span class="def">def</span>
        <span class="name">y_noise_savgol_DL</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">order</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.y_noise_savgol_DL-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y_noise_savgol_DL"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y_noise_savgol_DL-168"><a href="#Spectrum.y_noise_savgol_DL-168"><span class="linenos">168</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.y_noise_savgol_DL-169"><a href="#Spectrum.y_noise_savgol_DL-169"><span class="linenos">169</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol_DL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Spectrum.y_noise_savgol_DL-170"><a href="#Spectrum.y_noise_savgol_DL-170"><span class="linenos">170</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="Spectrum.y_noise_savgol_DL-171"><a href="#Spectrum.y_noise_savgol_DL-171"><span class="linenos">171</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.y_noise_savgol_DL-172"><a href="#Spectrum.y_noise_savgol_DL-172"><span class="linenos">172</span></a>        <span class="n">summ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ydata</span> <span class="o">-</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Spectrum.y_noise_savgol_DL-173"><a href="#Spectrum.y_noise_savgol_DL-173"><span class="linenos">173</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="Spectrum.y_noise_savgol_DL-174"><a href="#Spectrum.y_noise_savgol_DL-174"><span class="linenos">174</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Spectrum.y_noise_savgol_DL-175"><a href="#Spectrum.y_noise_savgol_DL-175"><span class="linenos">175</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Spectrum.y_noise_savgol_DL-176"><a href="#Spectrum.y_noise_savgol_DL-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">summ</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ydata</span><span class="p">))</span><span class="o">/</span><span class="n">scale</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y_noise_savgol" class="classattr">
                                        <input id="Spectrum.y_noise_savgol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(validate_default=True))</div>

        <span class="def">def</span>
        <span class="name">y_noise_savgol</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">order</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.y_noise_savgol-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y_noise_savgol"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y_noise_savgol-178"><a href="#Spectrum.y_noise_savgol-178"><span class="linenos">178</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.y_noise_savgol-179"><a href="#Spectrum.y_noise_savgol-179"><span class="linenos">179</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_noise_savgol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">PositiveOddInt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Spectrum.y_noise_savgol-180"><a href="#Spectrum.y_noise_savgol-180"><span class="linenos">180</span></a>        <span class="n">npts</span> <span class="o">=</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="Spectrum.y_noise_savgol-181"><a href="#Spectrum.y_noise_savgol-181"><span class="linenos">181</span></a>
</span><span id="Spectrum.y_noise_savgol-182"><a href="#Spectrum.y_noise_savgol-182"><span class="linenos">182</span></a>        <span class="c1"># subtract smoothed signal from original</span>
</span><span id="Spectrum.y_noise_savgol-183"><a href="#Spectrum.y_noise_savgol-183"><span class="linenos">183</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="o">-</span> <span class="n">savgol_coeffs</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="Spectrum.y_noise_savgol-184"><a href="#Spectrum.y_noise_savgol-184"><span class="linenos">184</span></a>        <span class="n">coeff</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Spectrum.y_noise_savgol-185"><a href="#Spectrum.y_noise_savgol-185"><span class="linenos">185</span></a>
</span><span id="Spectrum.y_noise_savgol-186"><a href="#Spectrum.y_noise_savgol-186"><span class="linenos">186</span></a>        <span class="c1"># normalize coefficients so that `sum(coeff**2) == 1`</span>
</span><span id="Spectrum.y_noise_savgol-187"><a href="#Spectrum.y_noise_savgol-187"><span class="linenos">187</span></a>        <span class="n">coeff</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coeff</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Spectrum.y_noise_savgol-188"><a href="#Spectrum.y_noise_savgol-188"><span class="linenos">188</span></a>
</span><span id="Spectrum.y_noise_savgol-189"><a href="#Spectrum.y_noise_savgol-189"><span class="linenos">189</span></a>        <span class="c1"># remove the common floor</span>
</span><span id="Spectrum.y_noise_savgol-190"><a href="#Spectrum.y_noise_savgol-190"><span class="linenos">190</span></a>        <span class="n">ydata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.y_noise_savgol-191"><a href="#Spectrum.y_noise_savgol-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">convolve</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.x_err" class="classattr">
                                        <input id="Spectrum.x_err-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">x_err</span>

                <label class="view-source-button" for="Spectrum.x_err-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.x_err"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.x_err-193"><a href="#Spectrum.x_err-193"><span class="linenos">193</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.x_err-194"><a href="#Spectrum.x_err-194"><span class="linenos">194</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">x_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.x_err-195"><a href="#Spectrum.x_err-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.x_err-196"><a href="#Spectrum.x_err-196"><span class="linenos">196</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xdata</span><span class="p">)</span>
</span><span id="Spectrum.x_err-197"><a href="#Spectrum.x_err-197"><span class="linenos">197</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.x_err-198"><a href="#Spectrum.x_err-198"><span class="linenos">198</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_err</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.y_err" class="classattr">
                                        <input id="Spectrum.y_err-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">y_err</span>

                <label class="view-source-button" for="Spectrum.y_err-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.y_err"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.y_err-210"><a href="#Spectrum.y_err-210"><span class="linenos">210</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.y_err-211"><a href="#Spectrum.y_err-211"><span class="linenos">211</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">y_err</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.y_err-212"><a href="#Spectrum.y_err-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.y_err-213"><a href="#Spectrum.y_err-213"><span class="linenos">213</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ydata</span><span class="p">)</span>
</span><span id="Spectrum.y_err-214"><a href="#Spectrum.y_err-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.y_err-215"><a href="#Spectrum.y_err-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y_err</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.meta" class="classattr">
                                        <input id="Spectrum.meta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">meta</span><span class="annotation">: <a href="../misc/types/spectrum/metadata.html#SpeMetadataModel">ramanchada2.misc.types.spectrum.metadata.SpeMetadataModel</a></span>

                <label class="view-source-button" for="Spectrum.meta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.meta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.meta-227"><a href="#Spectrum.meta-227"><span class="linenos">227</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.meta-228"><a href="#Spectrum.meta-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpeMetadataModel</span><span class="p">:</span>
</span><span id="Spectrum.meta-229"><a href="#Spectrum.meta-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.result" class="classattr">
                                        <input id="Spectrum.result-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">result</span>

                <label class="view-source-button" for="Spectrum.result-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.result"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.result-239"><a href="#Spectrum.result-239"><span class="linenos">239</span></a>    <span class="nd">@property</span>
</span><span id="Spectrum.result-240"><a href="#Spectrum.result-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Spectrum.result-241"><a href="#Spectrum.result-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;ramanchada2_filter_result&#39;</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.spe_distribution" class="classattr">
                                        <input id="Spectrum.spe_distribution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">spe_distribution</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">trim_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.spe_distribution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.spe_distribution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.spe_distribution-247"><a href="#Spectrum.spe_distribution-247"><span class="linenos">247</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.spe_distribution-248"><a href="#Spectrum.spe_distribution-248"><span class="linenos">248</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">spe_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trim_range</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.spe_distribution-249"><a href="#Spectrum.spe_distribution-249"><span class="linenos">249</span></a>        <span class="n">x_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_bin_boundaries</span>
</span><span id="Spectrum.spe_distribution-250"><a href="#Spectrum.spe_distribution-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="n">trim_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.spe_distribution-251"><a href="#Spectrum.spe_distribution-251"><span class="linenos">251</span></a>            <span class="n">l_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="Spectrum.spe_distribution-252"><a href="#Spectrum.spe_distribution-252"><span class="linenos">252</span></a>            <span class="n">r_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x_all</span> <span class="o">-</span> <span class="n">trim_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="Spectrum.spe_distribution-253"><a href="#Spectrum.spe_distribution-253"><span class="linenos">253</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">],</span> <span class="n">x_all</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Spectrum.spe_distribution-254"><a href="#Spectrum.spe_distribution-254"><span class="linenos">254</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.spe_distribution-255"><a href="#Spectrum.spe_distribution-255"><span class="linenos">255</span></a>            <span class="n">spe_dist</span> <span class="o">=</span> <span class="n">rv_histogram</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">x_all</span><span class="p">))</span>
</span><span id="Spectrum.spe_distribution-256"><a href="#Spectrum.spe_distribution-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">spe_dist</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.gen_samples" class="classattr">
                                        <input id="Spectrum.gen_samples-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">gen_samples</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">size</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>, </span><span class="param"><span class="n">trim_range</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.gen_samples-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.gen_samples"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.gen_samples-258"><a href="#Spectrum.gen_samples-258"><span class="linenos">258</span></a>    <span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.gen_samples-259"><a href="#Spectrum.gen_samples-259"><span class="linenos">259</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">gen_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">PositiveInt</span><span class="p">,</span> <span class="n">trim_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.gen_samples-260"><a href="#Spectrum.gen_samples-260"><span class="linenos">260</span></a>        <span class="n">spe_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spe_distribution</span><span class="p">(</span><span class="n">trim_range</span><span class="o">=</span><span class="n">trim_range</span><span class="p">)</span>
</span><span id="Spectrum.gen_samples-261"><a href="#Spectrum.gen_samples-261"><span class="linenos">261</span></a>        <span class="n">samps</span> <span class="o">=</span> <span class="n">spe_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="Spectrum.gen_samples-262"><a href="#Spectrum.gen_samples-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">samps</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.add_baseline" class="classattr">
                                        <input id="Spectrum.add_baseline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">add_baseline</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_freq</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">pedestal</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.add_baseline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.add_baseline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.add_baseline-39"><a href="#Spectrum.add_baseline-39"><span class="linenos">39</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.add_baseline-40"><a href="#Spectrum.add_baseline-40"><span class="linenos">40</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.add_baseline-41"><a href="#Spectrum.add_baseline-41"><span class="linenos">41</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_baseline</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">n_freq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">pedestal</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Spectrum.add_baseline-42"><a href="#Spectrum.add_baseline-42"><span class="linenos">42</span></a>                 <span class="n">func</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.add_baseline-43"><a href="#Spectrum.add_baseline-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.add_baseline-44"><a href="#Spectrum.add_baseline-44"><span class="linenos">44</span></a><span class="sd">    Add artificial baseline to the spectrum.</span>
</span><span id="Spectrum.add_baseline-45"><a href="#Spectrum.add_baseline-45"><span class="linenos">45</span></a><span class="sd">    A random baseline is generated in frequency domain using uniform random numbers.</span>
</span><span id="Spectrum.add_baseline-46"><a href="#Spectrum.add_baseline-46"><span class="linenos">46</span></a><span class="sd">    The baseline in frequency domain is tapered with bohman window to reduce the bandwidth</span>
</span><span id="Spectrum.add_baseline-47"><a href="#Spectrum.add_baseline-47"><span class="linenos">47</span></a><span class="sd">    of the baseline to first `n_freq` frequencies and is transformed to &quot;time&quot; domain.</span>
</span><span id="Spectrum.add_baseline-48"><a href="#Spectrum.add_baseline-48"><span class="linenos">48</span></a><span class="sd">    Additionaly by using `func` parameter the user can define arbitrary function</span>
</span><span id="Spectrum.add_baseline-49"><a href="#Spectrum.add_baseline-49"><span class="linenos">49</span></a><span class="sd">    to be added as baseline.</span>
</span><span id="Spectrum.add_baseline-50"><a href="#Spectrum.add_baseline-50"><span class="linenos">50</span></a>
</span><span id="Spectrum.add_baseline-51"><a href="#Spectrum.add_baseline-51"><span class="linenos">51</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.add_baseline-52"><a href="#Spectrum.add_baseline-52"><span class="linenos">52</span></a><span class="sd">        n_freq:</span>
</span><span id="Spectrum.add_baseline-53"><a href="#Spectrum.add_baseline-53"><span class="linenos">53</span></a><span class="sd">            Must be `&gt; 2`. Number of lowest frequency bins distinct from zero.</span>
</span><span id="Spectrum.add_baseline-54"><a href="#Spectrum.add_baseline-54"><span class="linenos">54</span></a><span class="sd">        amplitude:</span>
</span><span id="Spectrum.add_baseline-55"><a href="#Spectrum.add_baseline-55"><span class="linenos">55</span></a><span class="sd">            Upper boundary for the uniform random generator.</span>
</span><span id="Spectrum.add_baseline-56"><a href="#Spectrum.add_baseline-56"><span class="linenos">56</span></a><span class="sd">        pedestal:</span>
</span><span id="Spectrum.add_baseline-57"><a href="#Spectrum.add_baseline-57"><span class="linenos">57</span></a><span class="sd">            Additive constant pedestal to the spectrum.</span>
</span><span id="Spectrum.add_baseline-58"><a href="#Spectrum.add_baseline-58"><span class="linenos">58</span></a><span class="sd">        func:</span>
</span><span id="Spectrum.add_baseline-59"><a href="#Spectrum.add_baseline-59"><span class="linenos">59</span></a><span class="sd">            Callable. User-defined function to be added as baseline. Example: `func = lambda x: x*.01 + x**2*.0001`.</span>
</span><span id="Spectrum.add_baseline-60"><a href="#Spectrum.add_baseline-60"><span class="linenos">60</span></a><span class="sd">        rng_seed:</span>
</span><span id="Spectrum.add_baseline-61"><a href="#Spectrum.add_baseline-61"><span class="linenos">61</span></a><span class="sd">            `int`, optional. Seed for the random generator.</span>
</span><span id="Spectrum.add_baseline-62"><a href="#Spectrum.add_baseline-62"><span class="linenos">62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.add_baseline-63"><a href="#Spectrum.add_baseline-63"><span class="linenos">63</span></a>    <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.add_baseline-64"><a href="#Spectrum.add_baseline-64"><span class="linenos">64</span></a>    <span class="n">base</span> <span class="o">=</span> <span class="n">generate_baseline</span><span class="p">(</span><span class="n">n_freq</span><span class="o">=</span><span class="n">n_freq</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">rng_seed</span><span class="o">=</span><span class="n">rng_seed</span><span class="p">)</span>
</span><span id="Spectrum.add_baseline-65"><a href="#Spectrum.add_baseline-65"><span class="linenos">65</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">amplitude</span><span class="o">*</span><span class="n">base</span> <span class="o">+</span> <span class="n">pedestal</span>
</span><span id="Spectrum.add_baseline-66"><a href="#Spectrum.add_baseline-66"><span class="linenos">66</span></a>    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.add_baseline-67"><a href="#Spectrum.add_baseline-67"><span class="linenos">67</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.add_baseline-68"><a href="#Spectrum.add_baseline-68"><span class="linenos">68</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>Add artificial baseline to the spectrum.
A random baseline is generated in frequency domain using uniform random numbers.
The baseline in frequency domain is tapered with bohman window to reduce the bandwidth
of the baseline to first <code>n_freq</code> frequencies and is transformed to "time" domain.
Additionaly by using <code>func</code> parameter the user can define arbitrary function
to be added as baseline.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>n_freq:</strong>  Must be <code>&gt; 2</code>. Number of lowest frequency bins distinct from zero.</li>
<li><strong>amplitude:</strong>  Upper boundary for the uniform random generator.</li>
<li><strong>pedestal:</strong>  Additive constant pedestal to the spectrum.</li>
<li><strong>func:</strong>  Callable. User-defined function to be added as baseline. Example: <code>func = lambda x: x*.01 + x**2*.0001</code>.</li>
<li><strong>rng_seed:</strong>  <code>int</code>, optional. Seed for the random generator.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.moving_minimum" class="classattr">
                                        <input id="Spectrum.moving_minimum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">moving_minimum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.moving_minimum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.moving_minimum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.moving_minimum-20"><a href="#Spectrum.moving_minimum-20"><span class="linenos">20</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.moving_minimum-21"><a href="#Spectrum.moving_minimum-21"><span class="linenos">21</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.moving_minimum-22"><a href="#Spectrum.moving_minimum-22"><span class="linenos">22</span></a><span class="k">def</span><span class="w"> </span><span class="nf">moving_minimum</span><span class="p">(</span>
</span><span id="Spectrum.moving_minimum-23"><a href="#Spectrum.moving_minimum-23"><span class="linenos">23</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.moving_minimum-24"><a href="#Spectrum.moving_minimum-24"><span class="linenos">24</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.moving_minimum-25"><a href="#Spectrum.moving_minimum-25"><span class="linenos">25</span></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Spectrum.moving_minimum-26"><a href="#Spectrum.moving_minimum-26"><span class="linenos">26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_minimum-27"><a href="#Spectrum.moving_minimum-27"><span class="linenos">27</span></a><span class="sd">    Moving minimum baseline estimator.</span>
</span><span id="Spectrum.moving_minimum-28"><a href="#Spectrum.moving_minimum-28"><span class="linenos">28</span></a><span class="sd">    Successive values are calculated as minima of rolling rectangular window.</span>
</span><span id="Spectrum.moving_minimum-29"><a href="#Spectrum.moving_minimum-29"><span class="linenos">29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_minimum-30"><a href="#Spectrum.moving_minimum-30"><span class="linenos">30</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">_moving_minimum</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Moving minimum baseline estimator.
Successive values are calculated as minima of rolling rectangular window.</p>
</div>


                            </div>
                            <div id="Spectrum.subtract_moving_minimum" class="classattr">
                                        <input id="Spectrum.subtract_moving_minimum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">subtract_moving_minimum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.subtract_moving_minimum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.subtract_moving_minimum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.subtract_moving_minimum-33"><a href="#Spectrum.subtract_moving_minimum-33"><span class="linenos">33</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.subtract_moving_minimum-34"><a href="#Spectrum.subtract_moving_minimum-34"><span class="linenos">34</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.subtract_moving_minimum-35"><a href="#Spectrum.subtract_moving_minimum-35"><span class="linenos">35</span></a><span class="k">def</span><span class="w"> </span><span class="nf">subtract_moving_minimum</span><span class="p">(</span>
</span><span id="Spectrum.subtract_moving_minimum-36"><a href="#Spectrum.subtract_moving_minimum-36"><span class="linenos">36</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_moving_minimum-37"><a href="#Spectrum.subtract_moving_minimum-37"><span class="linenos">37</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_moving_minimum-38"><a href="#Spectrum.subtract_moving_minimum-38"><span class="linenos">38</span></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Spectrum.subtract_moving_minimum-39"><a href="#Spectrum.subtract_moving_minimum-39"><span class="linenos">39</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">_moving_minimum</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.subtract_baseline_rc1_als" class="classattr">
                                        <input id="Spectrum.subtract_baseline_rc1_als-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">subtract_baseline_rc1_als</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">lam</span><span class="o">=</span><span class="mf">100000.0</span>,</span><span class="param">	<span class="n">p</span><span class="o">=</span><span class="mf">0.001</span>,</span><span class="param">	<span class="n">niter</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">smooth</span><span class="o">=</span><span class="mi">7</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.subtract_baseline_rc1_als-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.subtract_baseline_rc1_als"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.subtract_baseline_rc1_als-53"><a href="#Spectrum.subtract_baseline_rc1_als-53"><span class="linenos">53</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-54"><a href="#Spectrum.subtract_baseline_rc1_als-54"><span class="linenos">54</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-55"><a href="#Spectrum.subtract_baseline_rc1_als-55"><span class="linenos">55</span></a><span class="k">def</span><span class="w"> </span><span class="nf">subtract_baseline_rc1_als</span><span class="p">(</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-56"><a href="#Spectrum.subtract_baseline_rc1_als-56"><span class="linenos">56</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-57"><a href="#Spectrum.subtract_baseline_rc1_als-57"><span class="linenos">57</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-58"><a href="#Spectrum.subtract_baseline_rc1_als-58"><span class="linenos">58</span></a>        <span class="n">lam</span><span class="o">=</span><span class="mf">1e5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="mi">7</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-59"><a href="#Spectrum.subtract_baseline_rc1_als-59"><span class="linenos">59</span></a>        <span class="p">):</span>
</span><span id="Spectrum.subtract_baseline_rc1_als-60"><a href="#Spectrum.subtract_baseline_rc1_als-60"><span class="linenos">60</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">baseline_als</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="n">smooth</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.subtract_baseline_rc1_snip" class="classattr">
                                        <input id="Spectrum.subtract_baseline_rc1_snip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">subtract_baseline_rc1_snip</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">niter</span><span class="o">=</span><span class="mi">30</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.subtract_baseline_rc1_snip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.subtract_baseline_rc1_snip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.subtract_baseline_rc1_snip-63"><a href="#Spectrum.subtract_baseline_rc1_snip-63"><span class="linenos">63</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-64"><a href="#Spectrum.subtract_baseline_rc1_snip-64"><span class="linenos">64</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-65"><a href="#Spectrum.subtract_baseline_rc1_snip-65"><span class="linenos">65</span></a><span class="k">def</span><span class="w"> </span><span class="nf">subtract_baseline_rc1_snip</span><span class="p">(</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-66"><a href="#Spectrum.subtract_baseline_rc1_snip-66"><span class="linenos">66</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-67"><a href="#Spectrum.subtract_baseline_rc1_snip-67"><span class="linenos">67</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-68"><a href="#Spectrum.subtract_baseline_rc1_snip-68"><span class="linenos">68</span></a>        <span class="n">niter</span><span class="o">=</span><span class="mi">30</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-69"><a href="#Spectrum.subtract_baseline_rc1_snip-69"><span class="linenos">69</span></a>        <span class="p">):</span>
</span><span id="Spectrum.subtract_baseline_rc1_snip-70"><a href="#Spectrum.subtract_baseline_rc1_snip-70"><span class="linenos">70</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">baseline_snip</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.central_moments" class="classattr">
                                        <input id="Spectrum.central_moments-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">central_moments</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>,</span><span class="param">	<span class="n">moments</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>,</span><span class="param">	<span class="n">normalize</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.central_moments-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.central_moments"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.central_moments-10"><a href="#Spectrum.central_moments-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.central_moments-11"><a href="#Spectrum.central_moments-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.central_moments-12"><a href="#Spectrum.central_moments-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">central_moments</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.central_moments-13"><a href="#Spectrum.central_moments-13"><span class="linenos">13</span></a>                    <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span> <span class="n">moments</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Spectrum.central_moments-14"><a href="#Spectrum.central_moments-14"><span class="linenos">14</span></a>                    <span class="p">):</span>
</span><span id="Spectrum.central_moments-15"><a href="#Spectrum.central_moments-15"><span class="linenos">15</span></a>    <span class="n">mom</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="Spectrum.central_moments-16"><a href="#Spectrum.central_moments-16"><span class="linenos">16</span></a>    <span class="n">filter_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Spectrum.central_moments-17"><a href="#Spectrum.central_moments-17"><span class="linenos">17</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">filter_idx</span><span class="p">]</span>
</span><span id="Spectrum.central_moments-18"><a href="#Spectrum.central_moments-18"><span class="linenos">18</span></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">filter_idx</span><span class="p">]</span>
</span><span id="Spectrum.central_moments-19"><a href="#Spectrum.central_moments-19"><span class="linenos">19</span></a>    <span class="n">p</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="Spectrum.central_moments-20"><a href="#Spectrum.central_moments-20"><span class="linenos">20</span></a>    <span class="n">p</span> <span class="o">/=</span> <span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="Spectrum.central_moments-21"><a href="#Spectrum.central_moments-21"><span class="linenos">21</span></a>    <span class="n">mom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
</span><span id="Spectrum.central_moments-22"><a href="#Spectrum.central_moments-22"><span class="linenos">22</span></a>    <span class="n">mom</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mom</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Spectrum.central_moments-23"><a href="#Spectrum.central_moments-23"><span class="linenos">23</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">:</span>
</span><span id="Spectrum.central_moments-24"><a href="#Spectrum.central_moments-24"><span class="linenos">24</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Spectrum.central_moments-25"><a href="#Spectrum.central_moments-25"><span class="linenos">25</span></a>            <span class="k">continue</span>
</span><span id="Spectrum.central_moments-26"><a href="#Spectrum.central_moments-26"><span class="linenos">26</span></a>        <span class="n">mom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mom</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="n">i</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Spectrum.central_moments-27"><a href="#Spectrum.central_moments-27"><span class="linenos">27</span></a>        <span class="k">if</span> <span class="n">normalize</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Spectrum.central_moments-28"><a href="#Spectrum.central_moments-28"><span class="linenos">28</span></a>            <span class="n">mom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">mom</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="n">i</span><span class="o">/</span><span class="mi">2</span>
</span><span id="Spectrum.central_moments-29"><a href="#Spectrum.central_moments-29"><span class="linenos">29</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">mom</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moments</span><span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.normalize" class="classattr">
                                        <input id="Spectrum.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unity&#39;</span><span class="p">,</span> <span class="s1">&#39;min_unity&#39;</span><span class="p">,</span> <span class="s1">&#39;unity_density&#39;</span><span class="p">,</span> <span class="s1">&#39;unity_area&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.normalize-12"><a href="#Spectrum.normalize-12"><span class="linenos">12</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.normalize-13"><a href="#Spectrum.normalize-13"><span class="linenos">13</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.normalize-14"><a href="#Spectrum.normalize-14"><span class="linenos">14</span></a><span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.normalize-15"><a href="#Spectrum.normalize-15"><span class="linenos">15</span></a>              <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.normalize-16"><a href="#Spectrum.normalize-16"><span class="linenos">16</span></a>              <span class="n">strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;unity&#39;</span><span class="p">,</span> <span class="s1">&#39;min_unity&#39;</span><span class="p">,</span> <span class="s1">&#39;unity_density&#39;</span><span class="p">,</span> <span class="s1">&#39;unity_area&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span>
</span><span id="Spectrum.normalize-17"><a href="#Spectrum.normalize-17"><span class="linenos">17</span></a>                                <span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span><span class="p">):</span>
</span><span id="Spectrum.normalize-18"><a href="#Spectrum.normalize-18"><span class="linenos">18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.normalize-19"><a href="#Spectrum.normalize-19"><span class="linenos">19</span></a><span class="sd">    Normalize the spectrum.</span>
</span><span id="Spectrum.normalize-20"><a href="#Spectrum.normalize-20"><span class="linenos">20</span></a>
</span><span id="Spectrum.normalize-21"><a href="#Spectrum.normalize-21"><span class="linenos">21</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.normalize-22"><a href="#Spectrum.normalize-22"><span class="linenos">22</span></a><span class="sd">        strategy:</span>
</span><span id="Spectrum.normalize-23"><a href="#Spectrum.normalize-23"><span class="linenos">23</span></a><span class="sd">            If `unity`: normalize to `sum(y)`. If `min_unity`: subtract the minimum and normalize to &#39;unity&#39;. If</span>
</span><span id="Spectrum.normalize-24"><a href="#Spectrum.normalize-24"><span class="linenos">24</span></a><span class="sd">            `unity_density`: normalize to `Σ(y_i*Δx_i)`. If `unity_area`: same as `unity_density`. If `minmax`: scale</span>
</span><span id="Spectrum.normalize-25"><a href="#Spectrum.normalize-25"><span class="linenos">25</span></a><span class="sd">            amplitudes in range `[0, 1]`. If &#39;L1&#39; or &#39;L2&#39;: L1 or L2 norm without subtracting the pedestal.</span>
</span><span id="Spectrum.normalize-26"><a href="#Spectrum.normalize-26"><span class="linenos">26</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.normalize-27"><a href="#Spectrum.normalize-27"><span class="linenos">27</span></a>    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;unity&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-28"><a href="#Spectrum.normalize-28"><span class="linenos">28</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.normalize-29"><a href="#Spectrum.normalize-29"><span class="linenos">29</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Spectrum.normalize-30"><a href="#Spectrum.normalize-30"><span class="linenos">30</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="Spectrum.normalize-31"><a href="#Spectrum.normalize-31"><span class="linenos">31</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;min_unity&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-32"><a href="#Spectrum.normalize-32"><span class="linenos">32</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.normalize-33"><a href="#Spectrum.normalize-33"><span class="linenos">33</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Spectrum.normalize-34"><a href="#Spectrum.normalize-34"><span class="linenos">34</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="Spectrum.normalize-35"><a href="#Spectrum.normalize-35"><span class="linenos">35</span></a>    <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;unity_density&#39;</span> <span class="ow">or</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;unity_area&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-36"><a href="#Spectrum.normalize-36"><span class="linenos">36</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.normalize-37"><a href="#Spectrum.normalize-37"><span class="linenos">37</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x_bin_boundaries</span><span class="p">))</span>
</span><span id="Spectrum.normalize-38"><a href="#Spectrum.normalize-38"><span class="linenos">38</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="Spectrum.normalize-39"><a href="#Spectrum.normalize-39"><span class="linenos">39</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;minmax&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-40"><a href="#Spectrum.normalize-40"><span class="linenos">40</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.normalize-41"><a href="#Spectrum.normalize-41"><span class="linenos">41</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Spectrum.normalize-42"><a href="#Spectrum.normalize-42"><span class="linenos">42</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="Spectrum.normalize-43"><a href="#Spectrum.normalize-43"><span class="linenos">43</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-44"><a href="#Spectrum.normalize-44"><span class="linenos">44</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.normalize-45"><a href="#Spectrum.normalize-45"><span class="linenos">45</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Spectrum.normalize-46"><a href="#Spectrum.normalize-46"><span class="linenos">46</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span><span id="Spectrum.normalize-47"><a href="#Spectrum.normalize-47"><span class="linenos">47</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;L2&#39;</span><span class="p">:</span>
</span><span id="Spectrum.normalize-48"><a href="#Spectrum.normalize-48"><span class="linenos">48</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.normalize-49"><a href="#Spectrum.normalize-49"><span class="linenos">49</span></a>        <span class="n">res</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="Spectrum.normalize-50"><a href="#Spectrum.normalize-50"><span class="linenos">50</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Normalize the spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>strategy:</strong>  If <code>unity</code>: normalize to <code>sum(y)</code>. If <code>min_unity</code>: subtract the minimum and normalize to 'unity'. If
<code>unity_density</code>: normalize to <code>Σ(y_i*Δx_i)</code>. If <code>unity_area</code>: same as <code>unity_density</code>. If <code>minmax</code>: scale
amplitudes in range <code>[0, 1]</code>. If 'L1' or 'L2': L1 or L2 norm without subtracting the pedestal.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.abs_nm_to_shift_cm_1" class="classattr">
                                        <input id="Spectrum.abs_nm_to_shift_cm_1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">abs_nm_to_shift_cm_1</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.abs_nm_to_shift_cm_1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.abs_nm_to_shift_cm_1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.abs_nm_to_shift_cm_1-14"><a href="#Spectrum.abs_nm_to_shift_cm_1-14"><span class="linenos">14</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-15"><a href="#Spectrum.abs_nm_to_shift_cm_1-15"><span class="linenos">15</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-16"><a href="#Spectrum.abs_nm_to_shift_cm_1-16"><span class="linenos">16</span></a><span class="k">def</span><span class="w"> </span><span class="nf">abs_nm_to_shift_cm_1</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-17"><a href="#Spectrum.abs_nm_to_shift_cm_1-17"><span class="linenos">17</span></a>                         <span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-18"><a href="#Spectrum.abs_nm_to_shift_cm_1-18"><span class="linenos">18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-19"><a href="#Spectrum.abs_nm_to_shift_cm_1-19"><span class="linenos">19</span></a><span class="sd">    Convert wavelength to Ramanshift in wavenumber</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-20"><a href="#Spectrum.abs_nm_to_shift_cm_1-20"><span class="linenos">20</span></a>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-21"><a href="#Spectrum.abs_nm_to_shift_cm_1-21"><span class="linenos">21</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-22"><a href="#Spectrum.abs_nm_to_shift_cm_1-22"><span class="linenos">22</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-23"><a href="#Spectrum.abs_nm_to_shift_cm_1-23"><span class="linenos">23</span></a><span class="sd">        laser_wave_length_nm: Laser wave length</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-24"><a href="#Spectrum.abs_nm_to_shift_cm_1-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-25"><a href="#Spectrum.abs_nm_to_shift_cm_1-25"><span class="linenos">25</span></a><span class="sd">    Returns: Corrected x-values</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-26"><a href="#Spectrum.abs_nm_to_shift_cm_1-26"><span class="linenos">26</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1-27"><a href="#Spectrum.abs_nm_to_shift_cm_1-27"><span class="linenos">27</span></a>    <span class="k">return</span> <span class="n">util_abs_nm_to_shift_cm_1</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">laser_wave_length_nm</span><span class="o">=</span><span class="n">laser_wave_length_nm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert wavelength to Ramanshift in wavenumber</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Corrected x-values</p>
</div>


                            </div>
                            <div id="Spectrum.shift_cm_1_to_abs_nm" class="classattr">
                                        <input id="Spectrum.shift_cm_1_to_abs_nm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">shift_cm_1_to_abs_nm</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.shift_cm_1_to_abs_nm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.shift_cm_1_to_abs_nm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.shift_cm_1_to_abs_nm-30"><a href="#Spectrum.shift_cm_1_to_abs_nm-30"><span class="linenos">30</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-31"><a href="#Spectrum.shift_cm_1_to_abs_nm-31"><span class="linenos">31</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-32"><a href="#Spectrum.shift_cm_1_to_abs_nm-32"><span class="linenos">32</span></a><span class="k">def</span><span class="w"> </span><span class="nf">shift_cm_1_to_abs_nm</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-33"><a href="#Spectrum.shift_cm_1_to_abs_nm-33"><span class="linenos">33</span></a>                         <span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-34"><a href="#Spectrum.shift_cm_1_to_abs_nm-34"><span class="linenos">34</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-35"><a href="#Spectrum.shift_cm_1_to_abs_nm-35"><span class="linenos">35</span></a><span class="sd">    Convert Ramanshift in wavenumber to wavelength</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-36"><a href="#Spectrum.shift_cm_1_to_abs_nm-36"><span class="linenos">36</span></a>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-37"><a href="#Spectrum.shift_cm_1_to_abs_nm-37"><span class="linenos">37</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-38"><a href="#Spectrum.shift_cm_1_to_abs_nm-38"><span class="linenos">38</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-39"><a href="#Spectrum.shift_cm_1_to_abs_nm-39"><span class="linenos">39</span></a><span class="sd">        laser_wave_length_nm: Laser wave length</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-40"><a href="#Spectrum.shift_cm_1_to_abs_nm-40"><span class="linenos">40</span></a>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-41"><a href="#Spectrum.shift_cm_1_to_abs_nm-41"><span class="linenos">41</span></a><span class="sd">    Returns: Corrected x-values</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-42"><a href="#Spectrum.shift_cm_1_to_abs_nm-42"><span class="linenos">42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm-43"><a href="#Spectrum.shift_cm_1_to_abs_nm-43"><span class="linenos">43</span></a>    <span class="k">return</span> <span class="n">util_shift_cm_1_to_abs_nm</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">laser_wave_length_nm</span><span class="o">=</span><span class="n">laser_wave_length_nm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert Ramanshift in wavenumber to wavelength</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Corrected x-values</p>
</div>


                            </div>
                            <div id="Spectrum.abs_nm_to_shift_cm_1_filter" class="classattr">
                                        <input id="Spectrum.abs_nm_to_shift_cm_1_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">abs_nm_to_shift_cm_1_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.abs_nm_to_shift_cm_1_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.abs_nm_to_shift_cm_1_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-46"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-46"><span class="linenos">46</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-47"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-47"><span class="linenos">47</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-48"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-48"><span class="linenos">48</span></a><span class="k">def</span><span class="w"> </span><span class="nf">abs_nm_to_shift_cm_1_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-49"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-49"><span class="linenos">49</span></a>                                <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-50"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-50"><span class="linenos">50</span></a>                                <span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-51"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-51"><span class="linenos">51</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-52"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-52"><span class="linenos">52</span></a><span class="sd">    Convert wavelength to Ramanshift in wavenumber</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-53"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-53"><span class="linenos">53</span></a>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-54"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-54"><span class="linenos">54</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-55"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-55"><span class="linenos">55</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-56"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-56"><span class="linenos">56</span></a><span class="sd">        laser_wave_length_nm: Laser wave length</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-57"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-57"><span class="linenos">57</span></a>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-58"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-58"><span class="linenos">58</span></a><span class="sd">    Returns: Spectrum with corrected x-values</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-59"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-59"><span class="linenos">59</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.abs_nm_to_shift_cm_1_filter-60"><a href="#Spectrum.abs_nm_to_shift_cm_1_filter-60"><span class="linenos">60</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">util_abs_nm_to_shift_cm_1</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">laser_wave_length_nm</span><span class="o">=</span><span class="n">laser_wave_length_nm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert wavelength to Ramanshift in wavenumber</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Spectrum with corrected x-values</p>
</div>


                            </div>
                            <div id="Spectrum.shift_cm_1_to_abs_nm_filter" class="classattr">
                                        <input id="Spectrum.shift_cm_1_to_abs_nm_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">shift_cm_1_to_abs_nm_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.shift_cm_1_to_abs_nm_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.shift_cm_1_to_abs_nm_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-63"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-63"><span class="linenos">63</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-64"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-64"><span class="linenos">64</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-65"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-65"><span class="linenos">65</span></a><span class="k">def</span><span class="w"> </span><span class="nf">shift_cm_1_to_abs_nm_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-66"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-66"><span class="linenos">66</span></a>                                <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-67"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-67"><span class="linenos">67</span></a>                                <span class="n">laser_wave_length_nm</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-68"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-68"><span class="linenos">68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-69"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-69"><span class="linenos">69</span></a><span class="sd">    Convert Ramanshift in wavenumber to wavelength</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-70"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-70"><span class="linenos">70</span></a>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-71"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-71"><span class="linenos">71</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-72"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-72"><span class="linenos">72</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-73"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-73"><span class="linenos">73</span></a><span class="sd">        laser_wave_length_nm: Laser wave length</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-74"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-74"><span class="linenos">74</span></a>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-75"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-75"><span class="linenos">75</span></a><span class="sd">    Returns: Spectrum with corrected x-values</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-76"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.shift_cm_1_to_abs_nm_filter-77"><a href="#Spectrum.shift_cm_1_to_abs_nm_filter-77"><span class="linenos">77</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">util_shift_cm_1_to_abs_nm</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">laser_wave_length_nm</span><span class="o">=</span><span class="n">laser_wave_length_nm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert Ramanshift in wavenumber to wavelength</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>laser_wave_length_nm:</strong>  Laser wave length</li>
</ul>

<p>Returns: Spectrum with corrected x-values</p>
</div>


                            </div>
                            <div id="Spectrum.scale_xaxis_linear" class="classattr">
                                        <input id="Spectrum.scale_xaxis_linear-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">scale_xaxis_linear</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">preserve_integral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.scale_xaxis_linear-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.scale_xaxis_linear"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.scale_xaxis_linear-13"><a href="#Spectrum.scale_xaxis_linear-13"><span class="linenos">13</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.scale_xaxis_linear-14"><a href="#Spectrum.scale_xaxis_linear-14"><span class="linenos">14</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.scale_xaxis_linear-15"><a href="#Spectrum.scale_xaxis_linear-15"><span class="linenos">15</span></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_xaxis_linear</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.scale_xaxis_linear-16"><a href="#Spectrum.scale_xaxis_linear-16"><span class="linenos">16</span></a>                       <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.scale_xaxis_linear-17"><a href="#Spectrum.scale_xaxis_linear-17"><span class="linenos">17</span></a>                       <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Spectrum.scale_xaxis_linear-18"><a href="#Spectrum.scale_xaxis_linear-18"><span class="linenos">18</span></a>                       <span class="n">preserve_integral</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Spectrum.scale_xaxis_linear-19"><a href="#Spectrum.scale_xaxis_linear-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_xaxis_linear-20"><a href="#Spectrum.scale_xaxis_linear-20"><span class="linenos">20</span></a><span class="sd">    Scale x-axis using a factor.</span>
</span><span id="Spectrum.scale_xaxis_linear-21"><a href="#Spectrum.scale_xaxis_linear-21"><span class="linenos">21</span></a>
</span><span id="Spectrum.scale_xaxis_linear-22"><a href="#Spectrum.scale_xaxis_linear-22"><span class="linenos">22</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.scale_xaxis_linear-23"><a href="#Spectrum.scale_xaxis_linear-23"><span class="linenos">23</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.scale_xaxis_linear-24"><a href="#Spectrum.scale_xaxis_linear-24"><span class="linenos">24</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.scale_xaxis_linear-25"><a href="#Spectrum.scale_xaxis_linear-25"><span class="linenos">25</span></a><span class="sd">        factor: Defaults to 1.</span>
</span><span id="Spectrum.scale_xaxis_linear-26"><a href="#Spectrum.scale_xaxis_linear-26"><span class="linenos">26</span></a><span class="sd">            Multiply x-axis values with `factor`</span>
</span><span id="Spectrum.scale_xaxis_linear-27"><a href="#Spectrum.scale_xaxis_linear-27"><span class="linenos">27</span></a><span class="sd">        preserve_integral: optional. Defaults to False.</span>
</span><span id="Spectrum.scale_xaxis_linear-28"><a href="#Spectrum.scale_xaxis_linear-28"><span class="linenos">28</span></a><span class="sd">            If True, preserves the integral in sence</span>
</span><span id="Spectrum.scale_xaxis_linear-29"><a href="#Spectrum.scale_xaxis_linear-29"><span class="linenos">29</span></a><span class="sd">            $\sum y_{orig;\,i}*{\Delta x_{orig}}_i = \sum y_{new;\,i}*{\Delta x_{new}}_i = $</span>
</span><span id="Spectrum.scale_xaxis_linear-30"><a href="#Spectrum.scale_xaxis_linear-30"><span class="linenos">30</span></a><span class="sd">    Returns: Corrected spectrum</span>
</span><span id="Spectrum.scale_xaxis_linear-31"><a href="#Spectrum.scale_xaxis_linear-31"><span class="linenos">31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_xaxis_linear-32"><a href="#Spectrum.scale_xaxis_linear-32"><span class="linenos">32</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="Spectrum.scale_xaxis_linear-33"><a href="#Spectrum.scale_xaxis_linear-33"><span class="linenos">33</span></a>    <span class="k">if</span> <span class="n">preserve_integral</span><span class="p">:</span>
</span><span id="Spectrum.scale_xaxis_linear-34"><a href="#Spectrum.scale_xaxis_linear-34"><span class="linenos">34</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="n">factor</span>
</span></pre></div>


            <div class="docstring"><p>Scale x-axis using a factor.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>factor:</strong>  Defaults to 1.
Multiply x-axis values with <code>factor</code></li>
<li><strong>preserve_integral:</strong>  optional. Defaults to False.
If True, preserves the integral in sence
$\sum y_{orig;\,i}*{\Delta x_{orig}}_i = \sum y_{new;\,i}*{\Delta x_{new}}_i = $</li>
</ul>

<p>Returns: Corrected spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.scale_xaxis_fun" class="classattr">
                                        <input id="Spectrum.scale_xaxis_fun-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">scale_xaxis_fun</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]],</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">args</span><span class="o">=</span><span class="p">[]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.scale_xaxis_fun-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.scale_xaxis_fun"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.scale_xaxis_fun-37"><a href="#Spectrum.scale_xaxis_fun-37"><span class="linenos">37</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.scale_xaxis_fun-38"><a href="#Spectrum.scale_xaxis_fun-38"><span class="linenos">38</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.scale_xaxis_fun-39"><a href="#Spectrum.scale_xaxis_fun-39"><span class="linenos">39</span></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_xaxis_fun</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.scale_xaxis_fun-40"><a href="#Spectrum.scale_xaxis_fun-40"><span class="linenos">40</span></a>                    <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.scale_xaxis_fun-41"><a href="#Spectrum.scale_xaxis_fun-41"><span class="linenos">41</span></a>                    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]],</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.scale_xaxis_fun-42"><a href="#Spectrum.scale_xaxis_fun-42"><span class="linenos">42</span></a>                    <span class="n">args</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="Spectrum.scale_xaxis_fun-43"><a href="#Spectrum.scale_xaxis_fun-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_xaxis_fun-44"><a href="#Spectrum.scale_xaxis_fun-44"><span class="linenos">44</span></a><span class="sd">    Apply arbitrary calibration function to the x-axis values.</span>
</span><span id="Spectrum.scale_xaxis_fun-45"><a href="#Spectrum.scale_xaxis_fun-45"><span class="linenos">45</span></a>
</span><span id="Spectrum.scale_xaxis_fun-46"><a href="#Spectrum.scale_xaxis_fun-46"><span class="linenos">46</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.scale_xaxis_fun-47"><a href="#Spectrum.scale_xaxis_fun-47"><span class="linenos">47</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.scale_xaxis_fun-48"><a href="#Spectrum.scale_xaxis_fun-48"><span class="linenos">48</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.scale_xaxis_fun-49"><a href="#Spectrum.scale_xaxis_fun-49"><span class="linenos">49</span></a><span class="sd">        fun: function to be applied</span>
</span><span id="Spectrum.scale_xaxis_fun-50"><a href="#Spectrum.scale_xaxis_fun-50"><span class="linenos">50</span></a><span class="sd">        args: Additional arguments to the provided functions</span>
</span><span id="Spectrum.scale_xaxis_fun-51"><a href="#Spectrum.scale_xaxis_fun-51"><span class="linenos">51</span></a>
</span><span id="Spectrum.scale_xaxis_fun-52"><a href="#Spectrum.scale_xaxis_fun-52"><span class="linenos">52</span></a><span class="sd">    Returns: Corrected spectrum</span>
</span><span id="Spectrum.scale_xaxis_fun-53"><a href="#Spectrum.scale_xaxis_fun-53"><span class="linenos">53</span></a>
</span><span id="Spectrum.scale_xaxis_fun-54"><a href="#Spectrum.scale_xaxis_fun-54"><span class="linenos">54</span></a><span class="sd">    Raises:</span>
</span><span id="Spectrum.scale_xaxis_fun-55"><a href="#Spectrum.scale_xaxis_fun-55"><span class="linenos">55</span></a><span class="sd">        ValueError: If the new x-values are not strictly monotonically increasing.</span>
</span><span id="Spectrum.scale_xaxis_fun-56"><a href="#Spectrum.scale_xaxis_fun-56"><span class="linenos">56</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_xaxis_fun-57"><a href="#Spectrum.scale_xaxis_fun-57"><span class="linenos">57</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Spectrum.scale_xaxis_fun-58"><a href="#Spectrum.scale_xaxis_fun-58"><span class="linenos">58</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">new_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="Spectrum.scale_xaxis_fun-59"><a href="#Spectrum.scale_xaxis_fun-59"><span class="linenos">59</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The provided function is not a monoton increasing funciton.&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply arbitrary calibration function to the x-axis values.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>fun:</strong>  function to be applied</li>
<li><strong>args:</strong>  Additional arguments to the provided functions</li>
</ul>

<p>Returns: Corrected spectrum</p>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the new x-values are not strictly monotonically increasing.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.set_new_xaxis" class="classattr">
                                        <input id="Spectrum.set_new_xaxis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">set_new_xaxis</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">xaxis</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.set_new_xaxis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.set_new_xaxis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.set_new_xaxis-10"><a href="#Spectrum.set_new_xaxis-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.set_new_xaxis-11"><a href="#Spectrum.set_new_xaxis-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.set_new_xaxis-12"><a href="#Spectrum.set_new_xaxis-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">set_new_xaxis</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.set_new_xaxis-13"><a href="#Spectrum.set_new_xaxis-13"><span class="linenos">13</span></a>                  <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.set_new_xaxis-14"><a href="#Spectrum.set_new_xaxis-14"><span class="linenos">14</span></a>                  <span class="n">xaxis</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">):</span>
</span><span id="Spectrum.set_new_xaxis-15"><a href="#Spectrum.set_new_xaxis-15"><span class="linenos">15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.set_new_xaxis-16"><a href="#Spectrum.set_new_xaxis-16"><span class="linenos">16</span></a><span class="sd">    Substitute x-axis values with new ones</span>
</span><span id="Spectrum.set_new_xaxis-17"><a href="#Spectrum.set_new_xaxis-17"><span class="linenos">17</span></a>
</span><span id="Spectrum.set_new_xaxis-18"><a href="#Spectrum.set_new_xaxis-18"><span class="linenos">18</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.set_new_xaxis-19"><a href="#Spectrum.set_new_xaxis-19"><span class="linenos">19</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.set_new_xaxis-20"><a href="#Spectrum.set_new_xaxis-20"><span class="linenos">20</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.set_new_xaxis-21"><a href="#Spectrum.set_new_xaxis-21"><span class="linenos">21</span></a><span class="sd">        xaxis: new x-axis values</span>
</span><span id="Spectrum.set_new_xaxis-22"><a href="#Spectrum.set_new_xaxis-22"><span class="linenos">22</span></a>
</span><span id="Spectrum.set_new_xaxis-23"><a href="#Spectrum.set_new_xaxis-23"><span class="linenos">23</span></a><span class="sd">    Returns: corrected spectrum</span>
</span><span id="Spectrum.set_new_xaxis-24"><a href="#Spectrum.set_new_xaxis-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.set_new_xaxis-25"><a href="#Spectrum.set_new_xaxis-25"><span class="linenos">25</span></a><span class="sd">    Raises:</span>
</span><span id="Spectrum.set_new_xaxis-26"><a href="#Spectrum.set_new_xaxis-26"><span class="linenos">26</span></a><span class="sd">        ValueError: If the provided array does not match the shape of the spectrum.</span>
</span><span id="Spectrum.set_new_xaxis-27"><a href="#Spectrum.set_new_xaxis-27"><span class="linenos">27</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.set_new_xaxis-28"><a href="#Spectrum.set_new_xaxis-28"><span class="linenos">28</span></a>    <span class="k">if</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
</span><span id="Spectrum.set_new_xaxis-29"><a href="#Spectrum.set_new_xaxis-29"><span class="linenos">29</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Shape of xaxis should match the shape of xaxis of the spectrum&#39;</span><span class="p">)</span>
</span><span id="Spectrum.set_new_xaxis-30"><a href="#Spectrum.set_new_xaxis-30"><span class="linenos">30</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">xaxis</span>
</span></pre></div>


            <div class="docstring"><p>Substitute x-axis values with new ones</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>xaxis:</strong>  new x-axis values</li>
</ul>

<p>Returns: corrected spectrum</p>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the provided array does not match the shape of the spectrum.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.calibrate_by_deltas_model" class="classattr">
                                        <input id="Spectrum.calibrate_by_deltas_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">calibrate_by_deltas_model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="calibration/by_deltas.html#FitBounds">ramanchada2.spectrum.calibration.by_deltas.FitBounds</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">convolution_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>,</span><span class="param">	<span class="n">scale2</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">scale3</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">init_guess</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cumulative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ax</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.calibrate_by_deltas_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.calibrate_by_deltas_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.calibrate_by_deltas_model-63"><a href="#Spectrum.calibrate_by_deltas_model-63"><span class="linenos"> 63</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.calibrate_by_deltas_model-64"><a href="#Spectrum.calibrate_by_deltas_model-64"><span class="linenos"> 64</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-65"><a href="#Spectrum.calibrate_by_deltas_model-65"><span class="linenos"> 65</span></a><span class="k">def</span><span class="w"> </span><span class="nf">calibrate_by_deltas_model</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_model-66"><a href="#Spectrum.calibrate_by_deltas_model-66"><span class="linenos"> 66</span></a>                              <span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.calibrate_by_deltas_model-67"><a href="#Spectrum.calibrate_by_deltas_model-67"><span class="linenos"> 67</span></a>                              <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FitBounds</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_model-68"><a href="#Spectrum.calibrate_by_deltas_model-68"><span class="linenos"> 68</span></a>                              <span class="n">convolution_steps</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
</span><span id="Spectrum.calibrate_by_deltas_model-69"><a href="#Spectrum.calibrate_by_deltas_model-69"><span class="linenos"> 69</span></a>                              <span class="n">scale2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_model-70"><a href="#Spectrum.calibrate_by_deltas_model-70"><span class="linenos"> 70</span></a>                              <span class="n">init_guess</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;cumulative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_model-71"><a href="#Spectrum.calibrate_by_deltas_model-71"><span class="linenos"> 71</span></a>                              <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Spectrum.calibrate_by_deltas_model-72"><a href="#Spectrum.calibrate_by_deltas_model-72"><span class="linenos"> 72</span></a>                              <span class="p">):</span>
</span><span id="Spectrum.calibrate_by_deltas_model-73"><a href="#Spectrum.calibrate_by_deltas_model-73"><span class="linenos"> 73</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.calibrate_by_deltas_model-74"><a href="#Spectrum.calibrate_by_deltas_model-74"><span class="linenos"> 74</span></a><span class="sd">    - Builds a composite model based on a set of user specified delta lines.</span>
</span><span id="Spectrum.calibrate_by_deltas_model-75"><a href="#Spectrum.calibrate_by_deltas_model-75"><span class="linenos"> 75</span></a><span class="sd">    - Initial guess is calculated based on 10-th and 90-th percentiles of</span>
</span><span id="Spectrum.calibrate_by_deltas_model-76"><a href="#Spectrum.calibrate_by_deltas_model-76"><span class="linenos"> 76</span></a><span class="sd">      the distributions.</span>
</span><span id="Spectrum.calibrate_by_deltas_model-77"><a href="#Spectrum.calibrate_by_deltas_model-77"><span class="linenos"> 77</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-78"><a href="#Spectrum.calibrate_by_deltas_model-78"><span class="linenos"> 78</span></a><span class="sd">    The phasespace of the model is flat with big amount of narrow minima.</span>
</span><span id="Spectrum.calibrate_by_deltas_model-79"><a href="#Spectrum.calibrate_by_deltas_model-79"><span class="linenos"> 79</span></a><span class="sd">    In order to find the best fit, the experimental data are successively</span>
</span><span id="Spectrum.calibrate_by_deltas_model-80"><a href="#Spectrum.calibrate_by_deltas_model-80"><span class="linenos"> 80</span></a><span class="sd">    convolved with gaussians with different widths startign from wide to</span>
</span><span id="Spectrum.calibrate_by_deltas_model-81"><a href="#Spectrum.calibrate_by_deltas_model-81"><span class="linenos"> 81</span></a><span class="sd">    narrow. The model for the calibration is 3-th order polynomial, which</span>
</span><span id="Spectrum.calibrate_by_deltas_model-82"><a href="#Spectrum.calibrate_by_deltas_model-82"><span class="linenos"> 82</span></a><span class="sd">    potentialy can be changed for higher order polynomial. In order to avoid</span>
</span><span id="Spectrum.calibrate_by_deltas_model-83"><a href="#Spectrum.calibrate_by_deltas_model-83"><span class="linenos"> 83</span></a><span class="sd">    solving the inverse of the calibration function, the result is tabulated</span>
</span><span id="Spectrum.calibrate_by_deltas_model-84"><a href="#Spectrum.calibrate_by_deltas_model-84"><span class="linenos"> 84</span></a><span class="sd">    and interpolated linarly for each bin of the spectrum.</span>
</span><span id="Spectrum.calibrate_by_deltas_model-85"><a href="#Spectrum.calibrate_by_deltas_model-85"><span class="linenos"> 85</span></a><span class="sd">    This alogrithm is useful for corse calibration.</span>
</span><span id="Spectrum.calibrate_by_deltas_model-86"><a href="#Spectrum.calibrate_by_deltas_model-86"><span class="linenos"> 86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.calibrate_by_deltas_model-87"><a href="#Spectrum.calibrate_by_deltas_model-87"><span class="linenos"> 87</span></a>    <span class="n">mod</span> <span class="o">=</span> <span class="n">DeltaSpeModel</span><span class="p">(</span><span class="n">deltas</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-88"><a href="#Spectrum.calibrate_by_deltas_model-88"><span class="linenos"> 88</span></a>    <span class="n">spe_padded</span> <span class="o">=</span> <span class="n">spe</span>
</span><span id="Spectrum.calibrate_by_deltas_model-89"><a href="#Spectrum.calibrate_by_deltas_model-89"><span class="linenos"> 89</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-90"><a href="#Spectrum.calibrate_by_deltas_model-90"><span class="linenos"> 90</span></a>    <span class="k">if</span> <span class="n">init_guess</span> <span class="o">==</span> <span class="s1">&#39;cumulative&#39;</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-91"><a href="#Spectrum.calibrate_by_deltas_model-91"><span class="linenos"> 91</span></a>        <span class="n">deltasx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-92"><a href="#Spectrum.calibrate_by_deltas_model-92"><span class="linenos"> 92</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-93"><a href="#Spectrum.calibrate_by_deltas_model-93"><span class="linenos"> 93</span></a>        <span class="n">deltas_cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-94"><a href="#Spectrum.calibrate_by_deltas_model-94"><span class="linenos"> 94</span></a>        <span class="n">deltas_cs</span> <span class="o">/=</span> <span class="n">deltas_cs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.calibrate_by_deltas_model-95"><a href="#Spectrum.calibrate_by_deltas_model-95"><span class="linenos"> 95</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-96"><a href="#Spectrum.calibrate_by_deltas_model-96"><span class="linenos"> 96</span></a>        <span class="n">deltas_idx10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">deltas_cs</span><span class="o">-</span><span class="mf">.1</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-97"><a href="#Spectrum.calibrate_by_deltas_model-97"><span class="linenos"> 97</span></a>        <span class="n">deltas_idx90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">deltas_cs</span><span class="o">-</span><span class="mf">.9</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-98"><a href="#Spectrum.calibrate_by_deltas_model-98"><span class="linenos"> 98</span></a>        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">deltasx</span><span class="p">[[</span><span class="n">deltas_idx10</span><span class="p">,</span> <span class="n">deltas_idx90</span><span class="p">]]</span>
</span><span id="Spectrum.calibrate_by_deltas_model-99"><a href="#Spectrum.calibrate_by_deltas_model-99"><span class="linenos"> 99</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-100"><a href="#Spectrum.calibrate_by_deltas_model-100"><span class="linenos">100</span></a>        <span class="n">spe_cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
</span><span id="Spectrum.calibrate_by_deltas_model-101"><a href="#Spectrum.calibrate_by_deltas_model-101"><span class="linenos">101</span></a>            <span class="n">spe_padded</span><span class="o">.</span><span class="n">moving_average</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">subtract_moving_minimum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">moving_average</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.calibrate_by_deltas_model-102"><a href="#Spectrum.calibrate_by_deltas_model-102"><span class="linenos">102</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-103"><a href="#Spectrum.calibrate_by_deltas_model-103"><span class="linenos">103</span></a>        <span class="n">spe_cs</span> <span class="o">/=</span> <span class="n">spe_cs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.calibrate_by_deltas_model-104"><a href="#Spectrum.calibrate_by_deltas_model-104"><span class="linenos">104</span></a>        <span class="n">spe_idx10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spe_cs</span><span class="o">-</span><span class="mf">.1</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-105"><a href="#Spectrum.calibrate_by_deltas_model-105"><span class="linenos">105</span></a>        <span class="n">spe_idx90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spe_cs</span><span class="o">-</span><span class="mf">.9</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-106"><a href="#Spectrum.calibrate_by_deltas_model-106"><span class="linenos">106</span></a>        <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">spe_padded</span><span class="o">.</span><span class="n">x</span><span class="p">[[</span><span class="n">spe_idx10</span><span class="p">,</span> <span class="n">spe_idx90</span><span class="p">]]</span>
</span><span id="Spectrum.calibrate_by_deltas_model-107"><a href="#Spectrum.calibrate_by_deltas_model-107"><span class="linenos">107</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-108"><a href="#Spectrum.calibrate_by_deltas_model-108"><span class="linenos">108</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-109"><a href="#Spectrum.calibrate_by_deltas_model-109"><span class="linenos">109</span></a>        <span class="n">shift</span> <span class="o">=</span> <span class="o">-</span><span class="n">scale</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">y1</span>
</span><span id="Spectrum.calibrate_by_deltas_model-110"><a href="#Spectrum.calibrate_by_deltas_model-110"><span class="linenos">110</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-111"><a href="#Spectrum.calibrate_by_deltas_model-111"><span class="linenos">111</span></a>        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Spectrum.calibrate_by_deltas_model-112"><a href="#Spectrum.calibrate_by_deltas_model-112"><span class="linenos">112</span></a>        <span class="n">shift</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.calibrate_by_deltas_model-113"><a href="#Spectrum.calibrate_by_deltas_model-113"><span class="linenos">113</span></a>    <span class="n">gain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="Spectrum.calibrate_by_deltas_model-114"><a href="#Spectrum.calibrate_by_deltas_model-114"><span class="linenos">114</span></a>    <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-115"><a href="#Spectrum.calibrate_by_deltas_model-115"><span class="linenos">115</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-116"><a href="#Spectrum.calibrate_by_deltas_model-116"><span class="linenos">116</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">shift</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">shift</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-117"><a href="#Spectrum.calibrate_by_deltas_model-117"><span class="linenos">117</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-118"><a href="#Spectrum.calibrate_by_deltas_model-118"><span class="linenos">118</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-119"><a href="#Spectrum.calibrate_by_deltas_model-119"><span class="linenos">119</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">shift</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-120"><a href="#Spectrum.calibrate_by_deltas_model-120"><span class="linenos">120</span></a>    <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">gain</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-121"><a href="#Spectrum.calibrate_by_deltas_model-121"><span class="linenos">121</span></a>    <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-122"><a href="#Spectrum.calibrate_by_deltas_model-122"><span class="linenos">122</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-123"><a href="#Spectrum.calibrate_by_deltas_model-123"><span class="linenos">123</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-124"><a href="#Spectrum.calibrate_by_deltas_model-124"><span class="linenos">124</span></a>        <span class="n">spe_padded</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-125"><a href="#Spectrum.calibrate_by_deltas_model-125"><span class="linenos">125</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-126"><a href="#Spectrum.calibrate_by_deltas_model-126"><span class="linenos">126</span></a>    <span class="k">if</span> <span class="n">convolution_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-127"><a href="#Spectrum.calibrate_by_deltas_model-127"><span class="linenos">127</span></a>        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">convolution_steps</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-128"><a href="#Spectrum.calibrate_by_deltas_model-128"><span class="linenos">128</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spe</span><span class="o">=</span><span class="n">spe_padded</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-129"><a href="#Spectrum.calibrate_by_deltas_model-129"><span class="linenos">129</span></a>
</span><span id="Spectrum.calibrate_by_deltas_model-130"><a href="#Spectrum.calibrate_by_deltas_model-130"><span class="linenos">130</span></a>    <span class="k">if</span> <span class="n">scale2</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-131"><a href="#Spectrum.calibrate_by_deltas_model-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-132"><a href="#Spectrum.calibrate_by_deltas_model-132"><span class="linenos">132</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale2</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale2</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-133"><a href="#Spectrum.calibrate_by_deltas_model-133"><span class="linenos">133</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-134"><a href="#Spectrum.calibrate_by_deltas_model-134"><span class="linenos">134</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-135"><a href="#Spectrum.calibrate_by_deltas_model-135"><span class="linenos">135</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spe_padded</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-136"><a href="#Spectrum.calibrate_by_deltas_model-136"><span class="linenos">136</span></a>    <span class="k">if</span> <span class="n">scale3</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-137"><a href="#Spectrum.calibrate_by_deltas_model-137"><span class="linenos">137</span></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-138"><a href="#Spectrum.calibrate_by_deltas_model-138"><span class="linenos">138</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale2</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale2</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-139"><a href="#Spectrum.calibrate_by_deltas_model-139"><span class="linenos">139</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale3</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="n">bounds</span><span class="o">.</span><span class="n">scale3</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-140"><a href="#Spectrum.calibrate_by_deltas_model-140"><span class="linenos">140</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.calibrate_by_deltas_model-141"><a href="#Spectrum.calibrate_by_deltas_model-141"><span class="linenos">141</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-142"><a href="#Spectrum.calibrate_by_deltas_model-142"><span class="linenos">142</span></a>            <span class="n">mod</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;scale3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-143"><a href="#Spectrum.calibrate_by_deltas_model-143"><span class="linenos">143</span></a>        <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spe_padded</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_model-144"><a href="#Spectrum.calibrate_by_deltas_model-144"><span class="linenos">144</span></a>    <span class="k">return</span> <span class="n">mod</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">mod</span><span class="o">.</span><span class="n">params</span>
</span></pre></div>


            <div class="docstring"><ul>
<li>Builds a composite model based on a set of user specified delta lines.</li>
<li>Initial guess is calculated based on 10-th and 90-th percentiles of
the distributions.</li>
</ul>

<p>The phasespace of the model is flat with big amount of narrow minima.
In order to find the best fit, the experimental data are successively
convolved with gaussians with different widths startign from wide to
narrow. The model for the calibration is 3-th order polynomial, which
potentialy can be changed for higher order polynomial. In order to avoid
solving the inverse of the calibration function, the result is tabulated
and interpolated linarly for each bin of the spectrum.
This alogrithm is useful for corse calibration.</p>
</div>


                            </div>
                            <div id="Spectrum.calibrate_by_deltas_filter" class="classattr">
                                        <input id="Spectrum.calibrate_by_deltas_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">calibrate_by_deltas_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">convolution_steps</span>,</span><span class="param">	<span class="n">init_guess</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.calibrate_by_deltas_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.calibrate_by_deltas_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.calibrate_by_deltas_filter-147"><a href="#Spectrum.calibrate_by_deltas_filter-147"><span class="linenos">147</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-148"><a href="#Spectrum.calibrate_by_deltas_filter-148"><span class="linenos">148</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-149"><a href="#Spectrum.calibrate_by_deltas_filter-149"><span class="linenos">149</span></a><span class="k">def</span><span class="w"> </span><span class="nf">calibrate_by_deltas_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-150"><a href="#Spectrum.calibrate_by_deltas_filter-150"><span class="linenos">150</span></a>                               <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-151"><a href="#Spectrum.calibrate_by_deltas_filter-151"><span class="linenos">151</span></a>                               <span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-152"><a href="#Spectrum.calibrate_by_deltas_filter-152"><span class="linenos">152</span></a>                               <span class="n">convolution_steps</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-153"><a href="#Spectrum.calibrate_by_deltas_filter-153"><span class="linenos">153</span></a>                               <span class="n">init_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-154"><a href="#Spectrum.calibrate_by_deltas_filter-154"><span class="linenos">154</span></a>                               <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-155"><a href="#Spectrum.calibrate_by_deltas_filter-155"><span class="linenos">155</span></a>                               <span class="p">):</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-156"><a href="#Spectrum.calibrate_by_deltas_filter-156"><span class="linenos">156</span></a>    <span class="n">mod</span><span class="p">,</span> <span class="n">par</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">calibrate_by_deltas_model</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-157"><a href="#Spectrum.calibrate_by_deltas_filter-157"><span class="linenos">157</span></a>        <span class="n">deltas</span><span class="o">=</span><span class="n">deltas</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-158"><a href="#Spectrum.calibrate_by_deltas_filter-158"><span class="linenos">158</span></a>        <span class="n">convolution_steps</span><span class="o">=</span><span class="n">convolution_steps</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-159"><a href="#Spectrum.calibrate_by_deltas_filter-159"><span class="linenos">159</span></a>        <span class="n">init_guess</span><span class="o">=</span><span class="n">init_guess</span><span class="p">,</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-160"><a href="#Spectrum.calibrate_by_deltas_filter-160"><span class="linenos">160</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-161"><a href="#Spectrum.calibrate_by_deltas_filter-161"><span class="linenos">161</span></a>
</span><span id="Spectrum.calibrate_by_deltas_filter-162"><a href="#Spectrum.calibrate_by_deltas_filter-162"><span class="linenos">162</span></a>    <span class="n">deltasx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-163"><a href="#Spectrum.calibrate_by_deltas_filter-163"><span class="linenos">163</span></a>    <span class="n">dxl</span><span class="p">,</span> <span class="n">dxr</span> <span class="o">=</span> <span class="n">deltasx</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-164"><a href="#Spectrum.calibrate_by_deltas_filter-164"><span class="linenos">164</span></a>    <span class="n">xl</span> <span class="o">=</span> <span class="n">dxl</span> <span class="o">-</span> <span class="p">(</span><span class="n">dxr</span> <span class="o">-</span> <span class="n">dxl</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-165"><a href="#Spectrum.calibrate_by_deltas_filter-165"><span class="linenos">165</span></a>    <span class="n">xr</span> <span class="o">=</span> <span class="n">dxl</span> <span class="o">+</span> <span class="p">(</span><span class="n">dxr</span> <span class="o">-</span> <span class="n">dxl</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-166"><a href="#Spectrum.calibrate_by_deltas_filter-166"><span class="linenos">166</span></a>    <span class="n">true_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-167"><a href="#Spectrum.calibrate_by_deltas_filter-167"><span class="linenos">167</span></a>    <span class="n">meas_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">true_x</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">+</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-168"><a href="#Spectrum.calibrate_by_deltas_filter-168"><span class="linenos">168</span></a>              <span class="n">true_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;scale2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">true_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">par</span><span class="p">[</span><span class="s1">&#39;scale3&#39;</span><span class="p">])</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-169"><a href="#Spectrum.calibrate_by_deltas_filter-169"><span class="linenos">169</span></a>    <span class="n">x_cal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-170"><a href="#Spectrum.calibrate_by_deltas_filter-170"><span class="linenos">170</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)):</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-171"><a href="#Spectrum.calibrate_by_deltas_filter-171"><span class="linenos">171</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">meas_x</span> <span class="o">&gt;</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-172"><a href="#Spectrum.calibrate_by_deltas_filter-172"><span class="linenos">172</span></a>        <span class="n">pt_rto</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">meas_x</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">meas_x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">meas_x</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-173"><a href="#Spectrum.calibrate_by_deltas_filter-173"><span class="linenos">173</span></a>        <span class="n">x_cal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">true_x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">true_x</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">pt_rto</span> <span class="o">+</span> <span class="n">true_x</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.calibrate_by_deltas_filter-174"><a href="#Spectrum.calibrate_by_deltas_filter-174"><span class="linenos">174</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_cal</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.xcal_fine" class="classattr">
                                        <input id="Spectrum.xcal_fine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">xcal_fine</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">ref</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>,</span><span class="param">	<span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">poly_order</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Ge</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>,</span><span class="param">	<span class="n">max_iter</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Ge</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1000</span>,</span><span class="param">	<span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.xcal_fine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.xcal_fine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.xcal_fine-177"><a href="#Spectrum.xcal_fine-177"><span class="linenos">177</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.xcal_fine-178"><a href="#Spectrum.xcal_fine-178"><span class="linenos">178</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.xcal_fine-179"><a href="#Spectrum.xcal_fine-179"><span class="linenos">179</span></a><span class="k">def</span><span class="w"> </span><span class="nf">xcal_fine</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine-180"><a href="#Spectrum.xcal_fine-180"><span class="linenos">180</span></a>              <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine-181"><a href="#Spectrum.xcal_fine-181"><span class="linenos">181</span></a>              <span class="n">ref</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
</span><span id="Spectrum.xcal_fine-182"><a href="#Spectrum.xcal_fine-182"><span class="linenos">182</span></a>              <span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine-183"><a href="#Spectrum.xcal_fine-183"><span class="linenos">183</span></a>              <span class="n">poly_order</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine-184"><a href="#Spectrum.xcal_fine-184"><span class="linenos">184</span></a>              <span class="n">max_iter</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine-185"><a href="#Spectrum.xcal_fine-185"><span class="linenos">185</span></a>              <span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.xcal_fine-186"><a href="#Spectrum.xcal_fine-186"><span class="linenos">186</span></a>              <span class="p">):</span>
</span><span id="Spectrum.xcal_fine-187"><a href="#Spectrum.xcal_fine-187"><span class="linenos">187</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.xcal_fine-188"><a href="#Spectrum.xcal_fine-188"><span class="linenos">188</span></a><span class="sd">    Iterative calibration with provided reference based on :func:`~ramanchada2.misc.utils.argmin2d.align`</span>
</span><span id="Spectrum.xcal_fine-189"><a href="#Spectrum.xcal_fine-189"><span class="linenos">189</span></a>
</span><span id="Spectrum.xcal_fine-190"><a href="#Spectrum.xcal_fine-190"><span class="linenos">190</span></a><span class="sd">    Iteratively apply polynomial of `poly_order` degree to match</span>
</span><span id="Spectrum.xcal_fine-191"><a href="#Spectrum.xcal_fine-191"><span class="linenos">191</span></a><span class="sd">    the found peaks to the reference locations. The pairs are created</span>
</span><span id="Spectrum.xcal_fine-192"><a href="#Spectrum.xcal_fine-192"><span class="linenos">192</span></a><span class="sd">    using :func:`~ramanchada2.misc.utils.argmin2d.align` algorithm.</span>
</span><span id="Spectrum.xcal_fine-193"><a href="#Spectrum.xcal_fine-193"><span class="linenos">193</span></a>
</span><span id="Spectrum.xcal_fine-194"><a href="#Spectrum.xcal_fine-194"><span class="linenos">194</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.xcal_fine-195"><a href="#Spectrum.xcal_fine-195"><span class="linenos">195</span></a><span class="sd">        old_spe (Spectrum): internal use only</span>
</span><span id="Spectrum.xcal_fine-196"><a href="#Spectrum.xcal_fine-196"><span class="linenos">196</span></a><span class="sd">        new_spe (Spectrum): internal use only</span>
</span><span id="Spectrum.xcal_fine-197"><a href="#Spectrum.xcal_fine-197"><span class="linenos">197</span></a><span class="sd">        ref (Union[Dict[float, float], List[float]]): _description_</span>
</span><span id="Spectrum.xcal_fine-198"><a href="#Spectrum.xcal_fine-198"><span class="linenos">198</span></a><span class="sd">        ref (Dict[float, float]):</span>
</span><span id="Spectrum.xcal_fine-199"><a href="#Spectrum.xcal_fine-199"><span class="linenos">199</span></a><span class="sd">            If a dict is provided - wavenumber - amplitude pairs.</span>
</span><span id="Spectrum.xcal_fine-200"><a href="#Spectrum.xcal_fine-200"><span class="linenos">200</span></a><span class="sd">            If a list is provided - wavenumbers only.</span>
</span><span id="Spectrum.xcal_fine-201"><a href="#Spectrum.xcal_fine-201"><span class="linenos">201</span></a><span class="sd">        poly_order (NonNegativeInt): polynomial degree to be used usualy 2 or 3</span>
</span><span id="Spectrum.xcal_fine-202"><a href="#Spectrum.xcal_fine-202"><span class="linenos">202</span></a><span class="sd">        max_iter (NonNegativeInt): max number of iterations for the iterative</span>
</span><span id="Spectrum.xcal_fine-203"><a href="#Spectrum.xcal_fine-203"><span class="linenos">203</span></a><span class="sd">            polynomial alignment</span>
</span><span id="Spectrum.xcal_fine-204"><a href="#Spectrum.xcal_fine-204"><span class="linenos">204</span></a><span class="sd">        should_fit (bool, optional): Whether the peaks should be fit or to</span>
</span><span id="Spectrum.xcal_fine-205"><a href="#Spectrum.xcal_fine-205"><span class="linenos">205</span></a><span class="sd">            associate the positions with the maxima. Defaults to False.</span>
</span><span id="Spectrum.xcal_fine-206"><a href="#Spectrum.xcal_fine-206"><span class="linenos">206</span></a><span class="sd">        find_peaks_kw (dict, optional): kwargs to be used in find_peaks. Defaults to {}.</span>
</span><span id="Spectrum.xcal_fine-207"><a href="#Spectrum.xcal_fine-207"><span class="linenos">207</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.xcal_fine-208"><a href="#Spectrum.xcal_fine-208"><span class="linenos">208</span></a>
</span><span id="Spectrum.xcal_fine-209"><a href="#Spectrum.xcal_fine-209"><span class="linenos">209</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Spectrum.xcal_fine-210"><a href="#Spectrum.xcal_fine-210"><span class="linenos">210</span></a>        <span class="n">ref_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.xcal_fine-211"><a href="#Spectrum.xcal_fine-211"><span class="linenos">211</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine-212"><a href="#Spectrum.xcal_fine-212"><span class="linenos">212</span></a>        <span class="n">ref_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-213"><a href="#Spectrum.xcal_fine-213"><span class="linenos">213</span></a>
</span><span id="Spectrum.xcal_fine-214"><a href="#Spectrum.xcal_fine-214"><span class="linenos">214</span></a>    <span class="k">if</span> <span class="n">should_fit</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine-215"><a href="#Spectrum.xcal_fine-215"><span class="linenos">215</span></a>        <span class="n">spe_pos_dict</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">fit_peak_positions</span><span class="p">(</span><span class="n">center_err_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">find_peaks_kw</span><span class="o">=</span><span class="n">find_peaks_kw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine-216"><a href="#Spectrum.xcal_fine-216"><span class="linenos">216</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine-217"><a href="#Spectrum.xcal_fine-217"><span class="linenos">217</span></a>        <span class="n">find_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sharpening</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-218"><a href="#Spectrum.xcal_fine-218"><span class="linenos">218</span></a>        <span class="n">find_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">find_peaks_kw</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-219"><a href="#Spectrum.xcal_fine-219"><span class="linenos">219</span></a>        <span class="n">spe_pos_dict</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">find_peak_multipeak</span><span class="p">(</span><span class="o">**</span><span class="n">find_kw</span><span class="p">)</span><span class="o">.</span><span class="n">get_pos_ampl_dict</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine-220"><a href="#Spectrum.xcal_fine-220"><span class="linenos">220</span></a>    <span class="n">spe_cent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">spe_pos_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.xcal_fine-221"><a href="#Spectrum.xcal_fine-221"><span class="linenos">221</span></a>
</span><span id="Spectrum.xcal_fine-222"><a href="#Spectrum.xcal_fine-222"><span class="linenos">222</span></a>    <span class="k">if</span> <span class="n">poly_order</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine-223"><a href="#Spectrum.xcal_fine-223"><span class="linenos">223</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="n">rc2utils</span><span class="o">.</span><span class="n">align_shift</span><span class="p">(</span><span class="n">spe_cent</span><span class="p">,</span> <span class="n">ref_pos</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-224"><a href="#Spectrum.xcal_fine-224"><span class="linenos">224</span></a>        <span class="n">spe_cal</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">scale_xaxis_fun</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine-225"><a href="#Spectrum.xcal_fine-225"><span class="linenos">225</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine-226"><a href="#Spectrum.xcal_fine-226"><span class="linenos">226</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">cal_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">):</span>
</span><span id="Spectrum.xcal_fine-227"><a href="#Spectrum.xcal_fine-227"><span class="linenos">227</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">par</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">**</span><span class="n">power</span> <span class="k">for</span> <span class="n">power</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
</span><span id="Spectrum.xcal_fine-228"><a href="#Spectrum.xcal_fine-228"><span class="linenos">228</span></a>
</span><span id="Spectrum.xcal_fine-229"><a href="#Spectrum.xcal_fine-229"><span class="linenos">229</span></a>        <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">poly_order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-230"><a href="#Spectrum.xcal_fine-230"><span class="linenos">230</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="n">rc2utils</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">spe_cent</span><span class="p">,</span> <span class="n">ref_pos</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">cal_func</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-231"><a href="#Spectrum.xcal_fine-231"><span class="linenos">231</span></a>        <span class="n">spe_cal</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">scale_xaxis_fun</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine-232"><a href="#Spectrum.xcal_fine-232"><span class="linenos">232</span></a>            <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cal_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span> <span class="n">args</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine-233"><a href="#Spectrum.xcal_fine-233"><span class="linenos">233</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">spe_cal</span><span class="o">.</span><span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>Iterative calibration with provided reference based on <code>~<a href="../misc/utils/argmin2d.html#align">ramanchada2.misc.utils.argmin2d.align()</a></code></p>

<p>Iteratively apply polynomial of <code>poly_order</code> degree to match
the found peaks to the reference locations. The pairs are created
using <code>~<a href="../misc/utils/argmin2d.html#align">ramanchada2.misc.utils.argmin2d.align()</a></code> algorithm.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe (Spectrum):</strong>  internal use only</li>
<li><strong>new_spe (Spectrum):</strong>  internal use only</li>
<li><strong>ref (Union[Dict[float, float], List[float]]):</strong>  _description_</li>
<li><strong>ref (Dict[float, float]):</strong>  If a dict is provided - wavenumber - amplitude pairs.
If a list is provided - wavenumbers only.</li>
<li><strong>poly_order (NonNegativeInt):</strong>  polynomial degree to be used usualy 2 or 3</li>
<li><strong>max_iter (NonNegativeInt):</strong>  max number of iterations for the iterative
polynomial alignment</li>
<li><strong>should_fit (bool, optional):</strong>  Whether the peaks should be fit or to
associate the positions with the maxima. Defaults to False.</li>
<li><strong>find_peaks_kw (dict, optional):</strong>  kwargs to be used in find_peaks. Defaults to {}.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.xcal_fine_RBF" class="classattr">
                                        <input id="Spectrum.xcal_fine_RBF-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">xcal_fine_RBF</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">ref</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]</span>,</span><span class="param">	<span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">kernel</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;thin_plate_spline&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="s1">&#39;quintic&#39;</span><span class="p">,</span> <span class="s1">&#39;multiquadric&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse_multiquadric&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse_quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;thin_plate_spline&#39;</span>,</span><span class="param">	<span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.xcal_fine_RBF-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.xcal_fine_RBF"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.xcal_fine_RBF-236"><a href="#Spectrum.xcal_fine_RBF-236"><span class="linenos">236</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.xcal_fine_RBF-237"><a href="#Spectrum.xcal_fine_RBF-237"><span class="linenos">237</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.xcal_fine_RBF-238"><a href="#Spectrum.xcal_fine_RBF-238"><span class="linenos">238</span></a><span class="k">def</span><span class="w"> </span><span class="nf">xcal_fine_RBF</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-239"><a href="#Spectrum.xcal_fine_RBF-239"><span class="linenos">239</span></a>                  <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-240"><a href="#Spectrum.xcal_fine_RBF-240"><span class="linenos">240</span></a>                  <span class="n">ref</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">],</span>
</span><span id="Spectrum.xcal_fine_RBF-241"><a href="#Spectrum.xcal_fine_RBF-241"><span class="linenos">241</span></a>                  <span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-242"><a href="#Spectrum.xcal_fine_RBF-242"><span class="linenos">242</span></a>                  <span class="n">kernel</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;thin_plate_spline&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="s1">&#39;quintic&#39;</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-243"><a href="#Spectrum.xcal_fine_RBF-243"><span class="linenos">243</span></a>                                  <span class="s1">&#39;multiquadric&#39;</span><span class="p">,</span> <span class="s1">&#39;inverse_multiquadric&#39;</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-244"><a href="#Spectrum.xcal_fine_RBF-244"><span class="linenos">244</span></a>                                  <span class="s1">&#39;inverse_quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-245"><a href="#Spectrum.xcal_fine_RBF-245"><span class="linenos">245</span></a>                                  <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;thin_plate_spline&#39;</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-246"><a href="#Spectrum.xcal_fine_RBF-246"><span class="linenos">246</span></a>                  <span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.xcal_fine_RBF-247"><a href="#Spectrum.xcal_fine_RBF-247"><span class="linenos">247</span></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Spectrum.xcal_fine_RBF-248"><a href="#Spectrum.xcal_fine_RBF-248"><span class="linenos">248</span></a>                  <span class="p">):</span>
</span><span id="Spectrum.xcal_fine_RBF-249"><a href="#Spectrum.xcal_fine_RBF-249"><span class="linenos">249</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wavelength calibration using Radial basis fuction interpolation</span>
</span><span id="Spectrum.xcal_fine_RBF-250"><a href="#Spectrum.xcal_fine_RBF-250"><span class="linenos">250</span></a>
</span><span id="Spectrum.xcal_fine_RBF-251"><a href="#Spectrum.xcal_fine_RBF-251"><span class="linenos">251</span></a><span class="sd">    Please be cautious! Interpolation might not be the most appropriate</span>
</span><span id="Spectrum.xcal_fine_RBF-252"><a href="#Spectrum.xcal_fine_RBF-252"><span class="linenos">252</span></a><span class="sd">    approach for this type of calibration.</span>
</span><span id="Spectrum.xcal_fine_RBF-253"><a href="#Spectrum.xcal_fine_RBF-253"><span class="linenos">253</span></a>
</span><span id="Spectrum.xcal_fine_RBF-254"><a href="#Spectrum.xcal_fine_RBF-254"><span class="linenos">254</span></a><span class="sd">    **kwargs are passed to RBFInterpolator</span>
</span><span id="Spectrum.xcal_fine_RBF-255"><a href="#Spectrum.xcal_fine_RBF-255"><span class="linenos">255</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.xcal_fine_RBF-256"><a href="#Spectrum.xcal_fine_RBF-256"><span class="linenos">256</span></a>
</span><span id="Spectrum.xcal_fine_RBF-257"><a href="#Spectrum.xcal_fine_RBF-257"><span class="linenos">257</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Spectrum.xcal_fine_RBF-258"><a href="#Spectrum.xcal_fine_RBF-258"><span class="linenos">258</span></a>        <span class="n">ref_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.xcal_fine_RBF-259"><a href="#Spectrum.xcal_fine_RBF-259"><span class="linenos">259</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine_RBF-260"><a href="#Spectrum.xcal_fine_RBF-260"><span class="linenos">260</span></a>        <span class="n">ref_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine_RBF-261"><a href="#Spectrum.xcal_fine_RBF-261"><span class="linenos">261</span></a>
</span><span id="Spectrum.xcal_fine_RBF-262"><a href="#Spectrum.xcal_fine_RBF-262"><span class="linenos">262</span></a>    <span class="k">if</span> <span class="n">should_fit</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine_RBF-263"><a href="#Spectrum.xcal_fine_RBF-263"><span class="linenos">263</span></a>        <span class="n">spe_pos_dict</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">fit_peak_positions</span><span class="p">(</span><span class="n">center_err_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">find_peaks_kw</span><span class="o">=</span><span class="n">find_peaks_kw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine_RBF-264"><a href="#Spectrum.xcal_fine_RBF-264"><span class="linenos">264</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine_RBF-265"><a href="#Spectrum.xcal_fine_RBF-265"><span class="linenos">265</span></a>        <span class="n">find_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sharpening</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine_RBF-266"><a href="#Spectrum.xcal_fine_RBF-266"><span class="linenos">266</span></a>        <span class="n">find_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">find_peaks_kw</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine_RBF-267"><a href="#Spectrum.xcal_fine_RBF-267"><span class="linenos">267</span></a>        <span class="n">spe_pos_dict</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">find_peak_multipeak</span><span class="p">(</span><span class="o">**</span><span class="n">find_kw</span><span class="p">)</span><span class="o">.</span><span class="n">get_pos_ampl_dict</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_fine_RBF-268"><a href="#Spectrum.xcal_fine_RBF-268"><span class="linenos">268</span></a>    <span class="n">spe_cent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">spe_pos_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Spectrum.xcal_fine_RBF-269"><a href="#Spectrum.xcal_fine_RBF-269"><span class="linenos">269</span></a>
</span><span id="Spectrum.xcal_fine_RBF-270"><a href="#Spectrum.xcal_fine_RBF-270"><span class="linenos">270</span></a>    <span class="n">spe_idx</span><span class="p">,</span> <span class="n">ref_idx</span> <span class="o">=</span> <span class="n">rc2utils</span><span class="o">.</span><span class="n">find_closest_pairs_idx</span><span class="p">(</span><span class="n">spe_cent</span><span class="p">,</span> <span class="n">ref_pos</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine_RBF-271"><a href="#Spectrum.xcal_fine_RBF-271"><span class="linenos">271</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine_RBF-272"><a href="#Spectrum.xcal_fine_RBF-272"><span class="linenos">272</span></a>        <span class="n">_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">ref_pos</span><span class="p">[</span><span class="n">ref_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">spe_cent</span><span class="p">[</span><span class="n">spe_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Spectrum.xcal_fine_RBF-273"><a href="#Spectrum.xcal_fine_RBF-273"><span class="linenos">273</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">_offset</span>
</span><span id="Spectrum.xcal_fine_RBF-274"><a href="#Spectrum.xcal_fine_RBF-274"><span class="linenos">274</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.xcal_fine_RBF-275"><a href="#Spectrum.xcal_fine_RBF-275"><span class="linenos">275</span></a>        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;kernel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kernel</span>
</span><span id="Spectrum.xcal_fine_RBF-276"><a href="#Spectrum.xcal_fine_RBF-276"><span class="linenos">276</span></a>        <span class="n">interp</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">RBFInterpolator</span><span class="p">(</span><span class="n">spe_cent</span><span class="p">[</span><span class="n">spe_idx</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ref_pos</span><span class="p">[</span><span class="n">ref_idx</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.xcal_fine_RBF-277"><a href="#Spectrum.xcal_fine_RBF-277"><span class="linenos">277</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Wavelength calibration using Radial basis fuction interpolation</p>

<p>Please be cautious! Interpolation might not be the most appropriate
approach for this type of calibration.</p>

<p>**kwargs are passed to RBFInterpolator</p>
</div>


                            </div>
                            <div id="Spectrum.xcal_argmin2d_iter_lowpass" class="classattr">
                                        <input id="Spectrum.xcal_argmin2d_iter_lowpass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">xcal_argmin2d_iter_lowpass</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">ref</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">low_pass_nfreqs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.xcal_argmin2d_iter_lowpass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.xcal_argmin2d_iter_lowpass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.xcal_argmin2d_iter_lowpass-299"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-299"><span class="linenos">299</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-300"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-300"><span class="linenos">300</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-301"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-301"><span class="linenos">301</span></a><span class="k">def</span><span class="w"> </span><span class="nf">xcal_argmin2d_iter_lowpass</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-302"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-302"><span class="linenos">302</span></a>                               <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-303"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-303"><span class="linenos">303</span></a>                               <span class="n">ref</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-304"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-304"><span class="linenos">304</span></a>                               <span class="n">low_pass_nfreqs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]):</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-305"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-305"><span class="linenos">305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-306"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-306"><span class="linenos">306</span></a><span class="sd">    Calibrate spectrum</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-307"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-307"><span class="linenos">307</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-308"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-308"><span class="linenos">308</span></a><span class="sd">    The calibration is done in multiple steps. Both the spectrum and the reference</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-309"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-309"><span class="linenos">309</span></a><span class="sd">    are passed through a low-pass filter to preserve only general structure of the</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-310"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-310"><span class="linenos">310</span></a><span class="sd">    spectrum. `low_pass_nfreqs` defines the number of frequencies to be preserved in</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-311"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-311"><span class="linenos">311</span></a><span class="sd">    each step. Once all steps with low-pass filter a final step without a low-pass</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-312"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-312"><span class="linenos">312</span></a><span class="sd">    filter is performed. Each calibration step is performed using</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-313"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-313"><span class="linenos">313</span></a><span class="sd">    :func:`~ramanchada2.spectrum.calibration.by_deltas.xcal_fine` algorithm.</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-314"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-314"><span class="linenos">314</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-315"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-315"><span class="linenos">315</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-316"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-316"><span class="linenos">316</span></a><span class="sd">        old_spe (Spectrum): internal use only</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-317"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-317"><span class="linenos">317</span></a><span class="sd">        new_spe (Spectrum): internal use only</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-318"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-318"><span class="linenos">318</span></a><span class="sd">        ref (Dict[float, float]): wavenumber - amplitude pairs</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-319"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-319"><span class="linenos">319</span></a><span class="sd">        low_pass_nfreqs (List[int], optional): The number of elements defines the</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-320"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-320"><span class="linenos">320</span></a><span class="sd">            number of low-pass steps and their values define the amount of frequencies</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-321"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-321"><span class="linenos">321</span></a><span class="sd">            to keep. Defaults to [100, 500].</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-322"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-322"><span class="linenos">322</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-323"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-323"><span class="linenos">323</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-324"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-324"><span class="linenos">324</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-325"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-325"><span class="linenos">325</span></a>    <span class="k">for</span> <span class="n">low_pass_i</span> <span class="ow">in</span> <span class="n">low_pass_nfreqs</span><span class="p">:</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-326"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-326"><span class="linenos">326</span></a>        <span class="n">xaxis</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-327"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-327"><span class="linenos">327</span></a>        <span class="n">y_ref_semi_spe</span> <span class="o">=</span> <span class="n">semi_spe_from_dict</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-328"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-328"><span class="linenos">328</span></a>        <span class="n">y_ref_semi_spe</span> <span class="o">=</span> <span class="n">low_pass</span><span class="p">(</span><span class="n">y_ref_semi_spe</span><span class="p">,</span> <span class="n">low_pass_i</span><span class="p">)</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-329"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-329"><span class="linenos">329</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-330"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-330"><span class="linenos">330</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">xaxis</span><span class="p">[</span><span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">y_ref_semi_spe</span><span class="p">,</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-331"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-331"><span class="linenos">331</span></a>                                    <span class="n">prominence</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y_ref_semi_spe</span><span class="p">)</span><span class="o">*</span><span class="mf">.001</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-332"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-332"><span class="linenos">332</span></a>                                    <span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-333"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-333"><span class="linenos">333</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-334"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-334"><span class="linenos">334</span></a>        <span class="n">spe_low</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-335"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-335"><span class="linenos">335</span></a>        <span class="n">spe_low</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">low_pass</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">low_pass_i</span><span class="p">)</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-336"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-336"><span class="linenos">336</span></a>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-337"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-337"><span class="linenos">337</span></a>        <span class="n">spe_cal</span> <span class="o">=</span> <span class="n">spe_low</span><span class="o">.</span><span class="n">xcal_fine</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">poly_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-338"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-338"><span class="linenos">338</span></a>                                    <span class="c1"># disables wlen.</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-339"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-339"><span class="linenos">339</span></a>                                    <span class="c1"># low passed peaks are much broader and</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-340"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-340"><span class="linenos">340</span></a>                                    <span class="c1"># will be affected by `wlen` so disable.</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-341"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-341"><span class="linenos">341</span></a>                                    <span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wlen&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">xaxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">xaxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])},</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-342"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-342"><span class="linenos">342</span></a>                                    <span class="p">)</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-343"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-343"><span class="linenos">343</span></a>        <span class="n">spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">spe_cal</span><span class="o">.</span><span class="n">x</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-344"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-344"><span class="linenos">344</span></a>    <span class="n">spe_cal_fin</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">xcal_fine</span><span class="p">(</span><span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">should_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">poly_order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Spectrum.xcal_argmin2d_iter_lowpass-345"><a href="#Spectrum.xcal_argmin2d_iter_lowpass-345"><span class="linenos">345</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">spe_cal_fin</span><span class="o">.</span><span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>Calibrate spectrum</p>

<p>The calibration is done in multiple steps. Both the spectrum and the reference
are passed through a low-pass filter to preserve only general structure of the
spectrum. <code>low_pass_nfreqs</code> defines the number of frequencies to be preserved in
each step. Once all steps with low-pass filter a final step without a low-pass
filter is performed. Each calibration step is performed using
<code>~<a href="calibration/by_deltas.html#xcal_fine">ramanchada2.spectrum.calibration.by_deltas.xcal_fine()</a></code> algorithm.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe (Spectrum):</strong>  internal use only</li>
<li><strong>new_spe (Spectrum):</strong>  internal use only</li>
<li><strong>ref (Dict[float, float]):</strong>  wavenumber - amplitude pairs</li>
<li><strong>low_pass_nfreqs (List[int], optional):</strong>  The number of elements defines the
number of low-pass steps and their values define the amount of frequencies
to keep. Defaults to [100, 500].</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.xcal_rough_poly2_all_pairs" class="classattr">
                                        <input id="Spectrum.xcal_rough_poly2_all_pairs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">xcal_rough_poly2_all_pairs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">ref</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">prominence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">npeaks</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.xcal_rough_poly2_all_pairs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.xcal_rough_poly2_all_pairs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.xcal_rough_poly2_all_pairs-348"><a href="#Spectrum.xcal_rough_poly2_all_pairs-348"><span class="linenos">348</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-349"><a href="#Spectrum.xcal_rough_poly2_all_pairs-349"><span class="linenos">349</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-350"><a href="#Spectrum.xcal_rough_poly2_all_pairs-350"><span class="linenos">350</span></a><span class="k">def</span><span class="w"> </span><span class="nf">xcal_rough_poly2_all_pairs</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-351"><a href="#Spectrum.xcal_rough_poly2_all_pairs-351"><span class="linenos">351</span></a>                               <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-352"><a href="#Spectrum.xcal_rough_poly2_all_pairs-352"><span class="linenos">352</span></a>                               <span class="n">ref</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-353"><a href="#Spectrum.xcal_rough_poly2_all_pairs-353"><span class="linenos">353</span></a>                               <span class="n">prominence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-354"><a href="#Spectrum.xcal_rough_poly2_all_pairs-354"><span class="linenos">354</span></a>                               <span class="n">npeaks</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-355"><a href="#Spectrum.xcal_rough_poly2_all_pairs-355"><span class="linenos">355</span></a>                               <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-356"><a href="#Spectrum.xcal_rough_poly2_all_pairs-356"><span class="linenos">356</span></a>                               <span class="p">):</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-357"><a href="#Spectrum.xcal_rough_poly2_all_pairs-357"><span class="linenos">357</span></a>    <span class="k">if</span> <span class="n">prominence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-358"><a href="#Spectrum.xcal_rough_poly2_all_pairs-358"><span class="linenos">358</span></a>        <span class="n">prominence</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y_noise_MAD</span><span class="p">()</span><span class="o">*</span><span class="mi">5</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-359"><a href="#Spectrum.xcal_rough_poly2_all_pairs-359"><span class="linenos">359</span></a>    <span class="n">cand</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">find_peak_multipeak</span><span class="p">(</span><span class="n">prominence</span><span class="o">=</span><span class="n">prominence</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-360"><a href="#Spectrum.xcal_rough_poly2_all_pairs-360"><span class="linenos">360</span></a>    <span class="n">spe_dict</span> <span class="o">=</span> <span class="n">cand</span><span class="o">.</span><span class="n">get_pos_ampl_dict</span><span class="p">()</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-361"><a href="#Spectrum.xcal_rough_poly2_all_pairs-361"><span class="linenos">361</span></a>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-362"><a href="#Spectrum.xcal_rough_poly2_all_pairs-362"><span class="linenos">362</span></a>    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">rough_poly2_calibration</span><span class="p">(</span><span class="n">spe_dict</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">npeaks</span><span class="o">=</span><span class="n">npeaks</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.xcal_rough_poly2_all_pairs-363"><a href="#Spectrum.xcal_rough_poly2_all_pairs-363"><span class="linenos">363</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.scale_yaxis_linear" class="classattr">
                                        <input id="Spectrum.scale_yaxis_linear-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">scale_yaxis_linear</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.scale_yaxis_linear-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.scale_yaxis_linear"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.scale_yaxis_linear-9"><a href="#Spectrum.scale_yaxis_linear-9"><span class="linenos"> 9</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.scale_yaxis_linear-10"><a href="#Spectrum.scale_yaxis_linear-10"><span class="linenos">10</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.scale_yaxis_linear-11"><a href="#Spectrum.scale_yaxis_linear-11"><span class="linenos">11</span></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_yaxis_linear</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.scale_yaxis_linear-12"><a href="#Spectrum.scale_yaxis_linear-12"><span class="linenos">12</span></a>                       <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.scale_yaxis_linear-13"><a href="#Spectrum.scale_yaxis_linear-13"><span class="linenos">13</span></a>                       <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Spectrum.scale_yaxis_linear-14"><a href="#Spectrum.scale_yaxis_linear-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_yaxis_linear-15"><a href="#Spectrum.scale_yaxis_linear-15"><span class="linenos">15</span></a><span class="sd">    Scale y-axis values</span>
</span><span id="Spectrum.scale_yaxis_linear-16"><a href="#Spectrum.scale_yaxis_linear-16"><span class="linenos">16</span></a>
</span><span id="Spectrum.scale_yaxis_linear-17"><a href="#Spectrum.scale_yaxis_linear-17"><span class="linenos">17</span></a><span class="sd">    This function provides the same result as `spe*const`</span>
</span><span id="Spectrum.scale_yaxis_linear-18"><a href="#Spectrum.scale_yaxis_linear-18"><span class="linenos">18</span></a>
</span><span id="Spectrum.scale_yaxis_linear-19"><a href="#Spectrum.scale_yaxis_linear-19"><span class="linenos">19</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.scale_yaxis_linear-20"><a href="#Spectrum.scale_yaxis_linear-20"><span class="linenos">20</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.scale_yaxis_linear-21"><a href="#Spectrum.scale_yaxis_linear-21"><span class="linenos">21</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.scale_yaxis_linear-22"><a href="#Spectrum.scale_yaxis_linear-22"><span class="linenos">22</span></a><span class="sd">        factor optional. Defaults to 1.</span>
</span><span id="Spectrum.scale_yaxis_linear-23"><a href="#Spectrum.scale_yaxis_linear-23"><span class="linenos">23</span></a><span class="sd">            Y-values scaling factor</span>
</span><span id="Spectrum.scale_yaxis_linear-24"><a href="#Spectrum.scale_yaxis_linear-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.scale_yaxis_linear-25"><a href="#Spectrum.scale_yaxis_linear-25"><span class="linenos">25</span></a><span class="sd">    Returns: corrected spectrum</span>
</span><span id="Spectrum.scale_yaxis_linear-26"><a href="#Spectrum.scale_yaxis_linear-26"><span class="linenos">26</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.scale_yaxis_linear-27"><a href="#Spectrum.scale_yaxis_linear-27"><span class="linenos">27</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">factor</span>
</span></pre></div>


            <div class="docstring"><p>Scale y-axis values</p>

<p>This function provides the same result as <code>spe*const</code></p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li>factor optional. Defaults to 1.
Y-values scaling factor</li>
</ul>

<p>Returns: corrected spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.from_cache_or_calc" class="classattr">
                                        <input id="Spectrum.from_cache_or_calc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor(set_applied_processing=False)</div>
        <div class="decorator decorator-validate_call">@validate_call</div>

        <span class="def">def</span>
        <span class="name">from_cache_or_calc</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">required_steps</span><span class="p">:</span> <span class="n"><a href="../misc/types/spectrum/applied_processings.html#SpeProcessingListModel">ramanchada2.misc.types.spectrum.applied_processings.SpeProcessingListModel</a></span>,</span><span class="param">	<span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_cache_or_calc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_cache_or_calc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_cache_or_calc-15"><a href="#Spectrum.from_cache_or_calc-15"><span class="linenos">15</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">(</span><span class="n">set_applied_processing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-16"><a href="#Spectrum.from_cache_or_calc-16"><span class="linenos">16</span></a><span class="nd">@validate_call</span>
</span><span id="Spectrum.from_cache_or_calc-17"><a href="#Spectrum.from_cache_or_calc-17"><span class="linenos">17</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_cache_or_calc</span><span class="p">(</span><span class="n">required_steps</span><span class="p">:</span> <span class="n">spe_t</span><span class="o">.</span><span class="n">SpeProcessingListModel</span><span class="p">,</span>
</span><span id="Spectrum.from_cache_or_calc-18"><a href="#Spectrum.from_cache_or_calc-18"><span class="linenos">18</span></a>                       <span class="n">cachefile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.from_cache_or_calc-19"><a href="#Spectrum.from_cache_or_calc-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_cache_or_calc-20"><a href="#Spectrum.from_cache_or_calc-20"><span class="linenos">20</span></a><span class="sd">    Load spectrum from cache or calculate if needed.</span>
</span><span id="Spectrum.from_cache_or_calc-21"><a href="#Spectrum.from_cache_or_calc-21"><span class="linenos">21</span></a>
</span><span id="Spectrum.from_cache_or_calc-22"><a href="#Spectrum.from_cache_or_calc-22"><span class="linenos">22</span></a><span class="sd">    The cache is a nested structure of spectra. All processings applied to</span>
</span><span id="Spectrum.from_cache_or_calc-23"><a href="#Spectrum.from_cache_or_calc-23"><span class="linenos">23</span></a><span class="sd">    a spectrum result to spectra of the initial one. If part of the requred</span>
</span><span id="Spectrum.from_cache_or_calc-24"><a href="#Spectrum.from_cache_or_calc-24"><span class="linenos">24</span></a><span class="sd">    processings are available, only the needed steps are calculated and added</span>
</span><span id="Spectrum.from_cache_or_calc-25"><a href="#Spectrum.from_cache_or_calc-25"><span class="linenos">25</span></a><span class="sd">    to the cache.</span>
</span><span id="Spectrum.from_cache_or_calc-26"><a href="#Spectrum.from_cache_or_calc-26"><span class="linenos">26</span></a>
</span><span id="Spectrum.from_cache_or_calc-27"><a href="#Spectrum.from_cache_or_calc-27"><span class="linenos">27</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_cache_or_calc-28"><a href="#Spectrum.from_cache_or_calc-28"><span class="linenos">28</span></a><span class="sd">        required_steps: List of required steps in the form</span>
</span><span id="Spectrum.from_cache_or_calc-29"><a href="#Spectrum.from_cache_or_calc-29"><span class="linenos">29</span></a><span class="sd">            [{&#39;proc&#39;: str, &#39;args&#39;: List[Any], &#39;kwargs&#39;: Dict[str, Any]}, ...]</span>
</span><span id="Spectrum.from_cache_or_calc-30"><a href="#Spectrum.from_cache_or_calc-30"><span class="linenos">30</span></a><span class="sd">        cachefile: optional. Defaults to None.</span>
</span><span id="Spectrum.from_cache_or_calc-31"><a href="#Spectrum.from_cache_or_calc-31"><span class="linenos">31</span></a><span class="sd">            Filename of the cache. If None no cache is used</span>
</span><span id="Spectrum.from_cache_or_calc-32"><a href="#Spectrum.from_cache_or_calc-32"><span class="linenos">32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_cache_or_calc-33"><a href="#Spectrum.from_cache_or_calc-33"><span class="linenos">33</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">recall</span><span class="p">():</span>
</span><span id="Spectrum.from_cache_or_calc-34"><a href="#Spectrum.from_cache_or_calc-34"><span class="linenos">34</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">required_steps</span><span class="p">):</span>
</span><span id="Spectrum.from_cache_or_calc-35"><a href="#Spectrum.from_cache_or_calc-35"><span class="linenos">35</span></a>            <span class="n">last_proc</span> <span class="o">=</span> <span class="n">required_steps</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Spectrum.from_cache_or_calc-36"><a href="#Spectrum.from_cache_or_calc-36"><span class="linenos">36</span></a>            <span class="k">if</span> <span class="n">last_proc</span><span class="o">.</span><span class="n">is_constructor</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-37"><a href="#Spectrum.from_cache_or_calc-37"><span class="linenos">37</span></a>                <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="o">.</span><span class="n">apply_creator</span><span class="p">(</span><span class="n">last_proc</span><span class="p">,</span> <span class="n">cachefile_</span><span class="o">=</span><span class="n">cachefile</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-38"><a href="#Spectrum.from_cache_or_calc-38"><span class="linenos">38</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-39"><a href="#Spectrum.from_cache_or_calc-39"><span class="linenos">39</span></a>                <span class="n">spe</span> <span class="o">=</span> <span class="n">recur</span><span class="p">(</span><span class="n">required_steps</span><span class="o">=</span><span class="n">required_steps</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-40"><a href="#Spectrum.from_cache_or_calc-40"><span class="linenos">40</span></a>                <span class="n">spe</span><span class="o">.</span><span class="n">_cachefile</span> <span class="o">=</span> <span class="n">cachefile</span>
</span><span id="Spectrum.from_cache_or_calc-41"><a href="#Spectrum.from_cache_or_calc-41"><span class="linenos">41</span></a>                <span class="n">spe</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">apply_processing</span><span class="p">(</span><span class="n">last_proc</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-42"><a href="#Spectrum.from_cache_or_calc-42"><span class="linenos">42</span></a>            <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_cache_or_calc-43"><a href="#Spectrum.from_cache_or_calc-43"><span class="linenos">43</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-44"><a href="#Spectrum.from_cache_or_calc-44"><span class="linenos">44</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;no starting point&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-45"><a href="#Spectrum.from_cache_or_calc-45"><span class="linenos">45</span></a>
</span><span id="Spectrum.from_cache_or_calc-46"><a href="#Spectrum.from_cache_or_calc-46"><span class="linenos">46</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">recur</span><span class="p">(</span><span class="n">required_steps</span><span class="p">:</span> <span class="n">spe_t</span><span class="o">.</span><span class="n">SpeProcessingListModel</span><span class="p">):</span>
</span><span id="Spectrum.from_cache_or_calc-47"><a href="#Spectrum.from_cache_or_calc-47"><span class="linenos">47</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-48"><a href="#Spectrum.from_cache_or_calc-48"><span class="linenos">48</span></a>            <span class="k">if</span> <span class="n">cachefile</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-49"><a href="#Spectrum.from_cache_or_calc-49"><span class="linenos">49</span></a>                <span class="n">spe</span> <span class="o">=</span> <span class="n">get_cache</span><span class="p">()</span>
</span><span id="Spectrum.from_cache_or_calc-50"><a href="#Spectrum.from_cache_or_calc-50"><span class="linenos">50</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-51"><a href="#Spectrum.from_cache_or_calc-51"><span class="linenos">51</span></a>                <span class="n">spe</span> <span class="o">=</span> <span class="n">recall</span><span class="p">()</span>
</span><span id="Spectrum.from_cache_or_calc-52"><a href="#Spectrum.from_cache_or_calc-52"><span class="linenos">52</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-53"><a href="#Spectrum.from_cache_or_calc-53"><span class="linenos">53</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">recall</span><span class="p">()</span>
</span><span id="Spectrum.from_cache_or_calc-54"><a href="#Spectrum.from_cache_or_calc-54"><span class="linenos">54</span></a>        <span class="n">spe</span><span class="o">.</span><span class="n">_cachefile</span> <span class="o">=</span> <span class="n">cachefile</span>
</span><span id="Spectrum.from_cache_or_calc-55"><a href="#Spectrum.from_cache_or_calc-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_cache_or_calc-56"><a href="#Spectrum.from_cache_or_calc-56"><span class="linenos">56</span></a>
</span><span id="Spectrum.from_cache_or_calc-57"><a href="#Spectrum.from_cache_or_calc-57"><span class="linenos">57</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_cache</span><span class="p">():</span>
</span><span id="Spectrum.from_cache_or_calc-58"><a href="#Spectrum.from_cache_or_calc-58"><span class="linenos">58</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-59"><a href="#Spectrum.from_cache_or_calc-59"><span class="linenos">59</span></a>            <span class="n">cache_path</span> <span class="o">=</span> <span class="n">required_steps</span><span class="o">.</span><span class="n">cache_path</span><span class="p">()</span>
</span><span id="Spectrum.from_cache_or_calc-60"><a href="#Spectrum.from_cache_or_calc-60"><span class="linenos">60</span></a>            <span class="k">if</span> <span class="n">cache_path</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-61"><a href="#Spectrum.from_cache_or_calc-61"><span class="linenos">61</span></a>                <span class="n">cache_path</span> <span class="o">=</span> <span class="s1">&#39;/cache/&#39;</span><span class="o">+</span><span class="n">cache_path</span><span class="o">+</span><span class="s1">&#39;/_data&#39;</span>
</span><span id="Spectrum.from_cache_or_calc-62"><a href="#Spectrum.from_cache_or_calc-62"><span class="linenos">62</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-63"><a href="#Spectrum.from_cache_or_calc-63"><span class="linenos">63</span></a>                <span class="n">cache_path</span> <span class="o">=</span> <span class="s1">&#39;raw&#39;</span>
</span><span id="Spectrum.from_cache_or_calc-64"><a href="#Spectrum.from_cache_or_calc-64"><span class="linenos">64</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="o">.</span><span class="n">from_chada</span><span class="p">(</span><span class="n">cachefile</span><span class="p">,</span> <span class="n">cache_path</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-65"><a href="#Spectrum.from_cache_or_calc-65"><span class="linenos">65</span></a>            <span class="n">spe</span><span class="o">.</span><span class="n">_applied_processings</span><span class="o">.</span><span class="n">extend_left</span><span class="p">(</span><span class="n">required_steps</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span><span id="Spectrum.from_cache_or_calc-66"><a href="#Spectrum.from_cache_or_calc-66"><span class="linenos">66</span></a>            <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_cache_or_calc-67"><a href="#Spectrum.from_cache_or_calc-67"><span class="linenos">67</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Spectrum.from_cache_or_calc-68"><a href="#Spectrum.from_cache_or_calc-68"><span class="linenos">68</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="Spectrum.from_cache_or_calc-69"><a href="#Spectrum.from_cache_or_calc-69"><span class="linenos">69</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="Spectrum.from_cache_or_calc-70"><a href="#Spectrum.from_cache_or_calc-70"><span class="linenos">70</span></a>
</span><span id="Spectrum.from_cache_or_calc-71"><a href="#Spectrum.from_cache_or_calc-71"><span class="linenos">71</span></a>    <span class="k">return</span> <span class="n">recur</span><span class="p">(</span><span class="n">required_steps</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load spectrum from cache or calculate if needed.</p>

<p>The cache is a nested structure of spectra. All processings applied to
a spectrum result to spectra of the initial one. If part of the requred
processings are available, only the needed steps are calculated and added
to the cache.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>required_steps:</strong>  List of required steps in the form
[{'proc': str, 'args': List[Any], 'kwargs': Dict[str, Any]}, ...]</li>
<li><strong>cachefile:</strong>  optional. Defaults to None.
Filename of the cache. If None no cache is used</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.from_chada" class="classattr">
                                        <input id="Spectrum.from_chada-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor(set_applied_processing=False)</div>
        <div class="decorator decorator-validate_call">@validate_call</div>

        <span class="def">def</span>
        <span class="name">from_chada</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;/raw&#39;</span>, </span><span class="param"><span class="n">h5module</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_chada-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_chada"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_chada-10"><a href="#Spectrum.from_chada-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">(</span><span class="n">set_applied_processing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.from_chada-11"><a href="#Spectrum.from_chada-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span>
</span><span id="Spectrum.from_chada-12"><a href="#Spectrum.from_chada-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_chada</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;/raw&#39;</span><span class="p">,</span> <span class="n">h5module</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.from_chada-13"><a href="#Spectrum.from_chada-13"><span class="linenos">13</span></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_cha</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">h5module</span><span class="o">=</span><span class="n">h5module</span><span class="p">)</span>
</span><span id="Spectrum.from_chada-14"><a href="#Spectrum.from_chada-14"><span class="linenos">14</span></a>    <span class="k">return</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.from_delta_lines" class="classattr">
                                        <input id="Spectrum.from_delta_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_delta_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">xcal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">nbins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2000</span>,</span><span class="param">	<span class="n">xaxis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_delta_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_delta_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_delta_lines-14"><a href="#Spectrum.from_delta_lines-14"><span class="linenos">14</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_delta_lines-15"><a href="#Spectrum.from_delta_lines-15"><span class="linenos">15</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_delta_lines-16"><a href="#Spectrum.from_delta_lines-16"><span class="linenos">16</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_delta_lines</span><span class="p">(</span>
</span><span id="Spectrum.from_delta_lines-17"><a href="#Spectrum.from_delta_lines-17"><span class="linenos">17</span></a>        <span class="n">deltas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.from_delta_lines-18"><a href="#Spectrum.from_delta_lines-18"><span class="linenos">18</span></a>        <span class="n">xcal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_delta_lines-19"><a href="#Spectrum.from_delta_lines-19"><span class="linenos">19</span></a>        <span class="n">nbins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
</span><span id="Spectrum.from_delta_lines-20"><a href="#Spectrum.from_delta_lines-20"><span class="linenos">20</span></a>        <span class="n">xaxis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_delta_lines-21"><a href="#Spectrum.from_delta_lines-21"><span class="linenos">21</span></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Spectrum.from_delta_lines-22"><a href="#Spectrum.from_delta_lines-22"><span class="linenos">22</span></a>        <span class="p">):</span>
</span><span id="Spectrum.from_delta_lines-23"><a href="#Spectrum.from_delta_lines-23"><span class="linenos">23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_delta_lines-24"><a href="#Spectrum.from_delta_lines-24"><span class="linenos">24</span></a><span class="sd">    Generate `Spectrum` with delta lines.</span>
</span><span id="Spectrum.from_delta_lines-25"><a href="#Spectrum.from_delta_lines-25"><span class="linenos">25</span></a>
</span><span id="Spectrum.from_delta_lines-26"><a href="#Spectrum.from_delta_lines-26"><span class="linenos">26</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_delta_lines-27"><a href="#Spectrum.from_delta_lines-27"><span class="linenos">27</span></a><span class="sd">        deltas:</span>
</span><span id="Spectrum.from_delta_lines-28"><a href="#Spectrum.from_delta_lines-28"><span class="linenos">28</span></a><span class="sd">            Keys of the dictionary are the `x` positions of the deltas; values are the amplitudes of the corresponding</span>
</span><span id="Spectrum.from_delta_lines-29"><a href="#Spectrum.from_delta_lines-29"><span class="linenos">29</span></a><span class="sd">            deltas.</span>
</span><span id="Spectrum.from_delta_lines-30"><a href="#Spectrum.from_delta_lines-30"><span class="linenos">30</span></a><span class="sd">        xcal:</span>
</span><span id="Spectrum.from_delta_lines-31"><a href="#Spectrum.from_delta_lines-31"><span class="linenos">31</span></a><span class="sd">            Callable, optional. `x` axis calibration function.</span>
</span><span id="Spectrum.from_delta_lines-32"><a href="#Spectrum.from_delta_lines-32"><span class="linenos">32</span></a><span class="sd">        nbins:</span>
</span><span id="Spectrum.from_delta_lines-33"><a href="#Spectrum.from_delta_lines-33"><span class="linenos">33</span></a><span class="sd">            `int`, optional. Number of bins in the spectrum.</span>
</span><span id="Spectrum.from_delta_lines-34"><a href="#Spectrum.from_delta_lines-34"><span class="linenos">34</span></a><span class="sd">        xaxis:</span>
</span><span id="Spectrum.from_delta_lines-35"><a href="#Spectrum.from_delta_lines-35"><span class="linenos">35</span></a><span class="sd">            `Array-like`, optional. The xaxis of the new spectrum. If `xaxis` is provided,</span>
</span><span id="Spectrum.from_delta_lines-36"><a href="#Spectrum.from_delta_lines-36"><span class="linenos">36</span></a><span class="sd">            `xcal` should be `None` and `nbins` is ignored.</span>
</span><span id="Spectrum.from_delta_lines-37"><a href="#Spectrum.from_delta_lines-37"><span class="linenos">37</span></a>
</span><span id="Spectrum.from_delta_lines-38"><a href="#Spectrum.from_delta_lines-38"><span class="linenos">38</span></a><span class="sd">    Example:</span>
</span><span id="Spectrum.from_delta_lines-39"><a href="#Spectrum.from_delta_lines-39"><span class="linenos">39</span></a>
</span><span id="Spectrum.from_delta_lines-40"><a href="#Spectrum.from_delta_lines-40"><span class="linenos">40</span></a><span class="sd">    This will produce spectrum with 1000 bins in the range `[-1000, 2000)`:</span>
</span><span id="Spectrum.from_delta_lines-41"><a href="#Spectrum.from_delta_lines-41"><span class="linenos">41</span></a><span class="sd">    ```py</span>
</span><span id="Spectrum.from_delta_lines-42"><a href="#Spectrum.from_delta_lines-42"><span class="linenos">42</span></a><span class="sd">    xcal = lambda x: x*3 -1000, nbins=1000</span>
</span><span id="Spectrum.from_delta_lines-43"><a href="#Spectrum.from_delta_lines-43"><span class="linenos">43</span></a><span class="sd">    ```</span>
</span><span id="Spectrum.from_delta_lines-44"><a href="#Spectrum.from_delta_lines-44"><span class="linenos">44</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_delta_lines-45"><a href="#Spectrum.from_delta_lines-45"><span class="linenos">45</span></a>    <span class="k">if</span> <span class="n">xaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xcal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.from_delta_lines-46"><a href="#Spectrum.from_delta_lines-46"><span class="linenos">46</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;xaxis and xcal/nbins are mutually exclusive&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-47"><a href="#Spectrum.from_delta_lines-47"><span class="linenos">47</span></a>    <span class="k">if</span> <span class="n">xaxis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-48"><a href="#Spectrum.from_delta_lines-48"><span class="linenos">48</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">xaxis</span>
</span><span id="Spectrum.from_delta_lines-49"><a href="#Spectrum.from_delta_lines-49"><span class="linenos">49</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-50"><a href="#Spectrum.from_delta_lines-50"><span class="linenos">50</span></a>        <span class="k">if</span> <span class="n">xcal</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-51"><a href="#Spectrum.from_delta_lines-51"><span class="linenos">51</span></a>            <span class="n">dk</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">deltas</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Spectrum.from_delta_lines-52"><a href="#Spectrum.from_delta_lines-52"><span class="linenos">52</span></a>            <span class="n">dkmin</span><span class="p">,</span> <span class="n">dkmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dk</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dk</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-53"><a href="#Spectrum.from_delta_lines-53"><span class="linenos">53</span></a>            <span class="k">if</span> <span class="n">dkmin</span> <span class="o">==</span> <span class="n">dkmax</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-54"><a href="#Spectrum.from_delta_lines-54"><span class="linenos">54</span></a>                <span class="n">dkmin</span><span class="p">,</span> <span class="n">dkmax</span> <span class="o">=</span> <span class="n">dkmin</span><span class="o">*</span><span class="mf">.8</span><span class="p">,</span> <span class="n">dkmax</span><span class="o">*</span><span class="mf">1.2</span>
</span><span id="Spectrum.from_delta_lines-55"><a href="#Spectrum.from_delta_lines-55"><span class="linenos">55</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-56"><a href="#Spectrum.from_delta_lines-56"><span class="linenos">56</span></a>                <span class="n">dkmin</span> <span class="o">-=</span> <span class="p">(</span><span class="n">dkmax</span><span class="o">-</span><span class="n">dkmin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
</span><span id="Spectrum.from_delta_lines-57"><a href="#Spectrum.from_delta_lines-57"><span class="linenos">57</span></a>                <span class="n">dkmax</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dkmax</span><span class="o">-</span><span class="n">dkmin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">.1</span>
</span><span id="Spectrum.from_delta_lines-58"><a href="#Spectrum.from_delta_lines-58"><span class="linenos">58</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dkmin</span><span class="p">,</span> <span class="n">dkmax</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-59"><a href="#Spectrum.from_delta_lines-59"><span class="linenos">59</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_delta_lines-60"><a href="#Spectrum.from_delta_lines-60"><span class="linenos">60</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xcal</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">xcal</span><span class="p">(</span><span class="n">nbins</span><span class="p">),</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-61"><a href="#Spectrum.from_delta_lines-61"><span class="linenos">61</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-62"><a href="#Spectrum.from_delta_lines-62"><span class="linenos">62</span></a>    <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ampl</span> <span class="ow">in</span> <span class="n">deltas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectrum.from_delta_lines-63"><a href="#Spectrum.from_delta_lines-63"><span class="linenos">63</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">pos</span><span class="p">))</span>
</span><span id="Spectrum.from_delta_lines-64"><a href="#Spectrum.from_delta_lines-64"><span class="linenos">64</span></a>        <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ampl</span>
</span><span id="Spectrum.from_delta_lines-65"><a href="#Spectrum.from_delta_lines-65"><span class="linenos">65</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.from_delta_lines-66"><a href="#Spectrum.from_delta_lines-66"><span class="linenos">66</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>Generate <code><a href="#Spectrum">Spectrum</a></code> with delta lines.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>deltas:</strong>  Keys of the dictionary are the <code><a href="#Spectrum.x">x</a></code> positions of the deltas; values are the amplitudes of the corresponding
deltas.</li>
<li><strong>xcal:</strong>  Callable, optional. <code><a href="#Spectrum.x">x</a></code> axis calibration function.</li>
<li><strong>nbins:</strong>  <code>int</code>, optional. Number of bins in the spectrum.</li>
<li><strong>xaxis:</strong>  <code>Array-like</code>, optional. The xaxis of the new spectrum. If <code>xaxis</code> is provided,
<code>xcal</code> should be <code>None</code> and <code>nbins</code> is ignored.</li>
</ul>

<p>Example:</p>

<p>This will produce spectrum with 1000 bins in the range <code>[-1000, 2000)</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">xcal</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">1000</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Spectrum.from_local_file" class="classattr">
                                        <input id="Spectrum.from_local_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_local_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">in_file_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filetype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;spa&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;wdf&#39;</span><span class="p">,</span> <span class="s1">&#39;ngs&#39;</span><span class="p">,</span> <span class="s1">&#39;jdx&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">,</span> <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;cha&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;native&#39;</span><span class="p">,</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">custom_meta</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_local_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_local_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_local_file-19"><a href="#Spectrum.from_local_file-19"><span class="linenos">19</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-20"><a href="#Spectrum.from_local_file-20"><span class="linenos">20</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_local_file-21"><a href="#Spectrum.from_local_file-21"><span class="linenos">21</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_local_file</span><span class="p">(</span>
</span><span id="Spectrum.from_local_file-22"><a href="#Spectrum.from_local_file-22"><span class="linenos">22</span></a>        <span class="n">in_file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-23"><a href="#Spectrum.from_local_file-23"><span class="linenos">23</span></a>        <span class="n">filetype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;spa&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-24"><a href="#Spectrum.from_local_file-24"><span class="linenos">24</span></a>                                      <span class="s1">&#39;wdf&#39;</span><span class="p">,</span> <span class="s1">&#39;ngs&#39;</span><span class="p">,</span> <span class="s1">&#39;jdx&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-25"><a href="#Spectrum.from_local_file-25"><span class="linenos">25</span></a>                                      <span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-26"><a href="#Spectrum.from_local_file-26"><span class="linenos">26</span></a>                                      <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">,</span> <span class="s1">&#39;cha&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-27"><a href="#Spectrum.from_local_file-27"><span class="linenos">27</span></a>        <span class="n">backend</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;native&#39;</span><span class="p">,</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_local_file-28"><a href="#Spectrum.from_local_file-28"><span class="linenos">28</span></a>        <span class="n">custom_meta</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Spectrum.from_local_file-29"><a href="#Spectrum.from_local_file-29"><span class="linenos">29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_local_file-30"><a href="#Spectrum.from_local_file-30"><span class="linenos">30</span></a><span class="sd">    Read experimental spectrum from a local file.</span>
</span><span id="Spectrum.from_local_file-31"><a href="#Spectrum.from_local_file-31"><span class="linenos">31</span></a>
</span><span id="Spectrum.from_local_file-32"><a href="#Spectrum.from_local_file-32"><span class="linenos">32</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_local_file-33"><a href="#Spectrum.from_local_file-33"><span class="linenos">33</span></a><span class="sd">        in_file_name:</span>
</span><span id="Spectrum.from_local_file-34"><a href="#Spectrum.from_local_file-34"><span class="linenos">34</span></a><span class="sd">            Path to a local file containing a spectrum.</span>
</span><span id="Spectrum.from_local_file-35"><a href="#Spectrum.from_local_file-35"><span class="linenos">35</span></a><span class="sd">        filetype:</span>
</span><span id="Spectrum.from_local_file-36"><a href="#Spectrum.from_local_file-36"><span class="linenos">36</span></a><span class="sd">            Specify the filetype. Filetype can be any of: `spc`, `sp`, `spa`, `0`, `1`, `2`, `wdf`, `ngs`, `jdx`, `dx`,</span>
</span><span id="Spectrum.from_local_file-37"><a href="#Spectrum.from_local_file-37"><span class="linenos">37</span></a><span class="sd">            `txt`, `txtr`, `tsv`, `csv`, `dpt`, `prn`, `rruf`, `spe` (Princeton Instruments) or `None`.</span>
</span><span id="Spectrum.from_local_file-38"><a href="#Spectrum.from_local_file-38"><span class="linenos">38</span></a><span class="sd">            `None` used to determine by extension of the file.</span>
</span><span id="Spectrum.from_local_file-39"><a href="#Spectrum.from_local_file-39"><span class="linenos">39</span></a><span class="sd">        backend:</span>
</span><span id="Spectrum.from_local_file-40"><a href="#Spectrum.from_local_file-40"><span class="linenos">40</span></a><span class="sd">            `native`, `rc1_parser` or `None`. `None` means both.</span>
</span><span id="Spectrum.from_local_file-41"><a href="#Spectrum.from_local_file-41"><span class="linenos">41</span></a><span class="sd">        custom_meta: Dict</span>
</span><span id="Spectrum.from_local_file-42"><a href="#Spectrum.from_local_file-42"><span class="linenos">42</span></a><span class="sd">            Add custom metadata fields in the created spectrum</span>
</span><span id="Spectrum.from_local_file-43"><a href="#Spectrum.from_local_file-43"><span class="linenos">43</span></a>
</span><span id="Spectrum.from_local_file-44"><a href="#Spectrum.from_local_file-44"><span class="linenos">44</span></a><span class="sd">    Raises:</span>
</span><span id="Spectrum.from_local_file-45"><a href="#Spectrum.from_local_file-45"><span class="linenos">45</span></a><span class="sd">        ValueError:</span>
</span><span id="Spectrum.from_local_file-46"><a href="#Spectrum.from_local_file-46"><span class="linenos">46</span></a><span class="sd">            When called with unsupported file formats.</span>
</span><span id="Spectrum.from_local_file-47"><a href="#Spectrum.from_local_file-47"><span class="linenos">47</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_local_file-48"><a href="#Spectrum.from_local_file-48"><span class="linenos">48</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_native</span><span class="p">():</span>
</span><span id="Spectrum.from_local_file-49"><a href="#Spectrum.from_local_file-49"><span class="linenos">49</span></a>        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-50"><a href="#Spectrum.from_local_file-50"><span class="linenos">50</span></a>            <span class="n">ft</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Spectrum.from_local_file-51"><a href="#Spectrum.from_local_file-51"><span class="linenos">51</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-52"><a href="#Spectrum.from_local_file-52"><span class="linenos">52</span></a>            <span class="n">ft</span> <span class="o">=</span> <span class="n">filetype</span>
</span><span id="Spectrum.from_local_file-53"><a href="#Spectrum.from_local_file-53"><span class="linenos">53</span></a>        <span class="k">if</span> <span class="n">ft</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;cha&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_local_file-54"><a href="#Spectrum.from_local_file-54"><span class="linenos">54</span></a>            <span class="k">return</span> <span class="n">from_chada</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">in_file_name</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-55"><a href="#Spectrum.from_local_file-55"><span class="linenos">55</span></a>        <span class="k">elif</span> <span class="n">ft</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_local_file-56"><a href="#Spectrum.from_local_file-56"><span class="linenos">56</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-57"><a href="#Spectrum.from_local_file-57"><span class="linenos">57</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_txt</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-58"><a href="#Spectrum.from_local_file-58"><span class="linenos">58</span></a>        <span class="k">elif</span> <span class="n">ft</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;csv&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_local_file-59"><a href="#Spectrum.from_local_file-59"><span class="linenos">59</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-60"><a href="#Spectrum.from_local_file-60"><span class="linenos">60</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-61"><a href="#Spectrum.from_local_file-61"><span class="linenos">61</span></a>        <span class="k">elif</span> <span class="n">ft</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spc&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_local_file-62"><a href="#Spectrum.from_local_file-62"><span class="linenos">62</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-63"><a href="#Spectrum.from_local_file-63"><span class="linenos">63</span></a>                <span class="n">spc</span> <span class="o">=</span> <span class="n">spc_io</span><span class="o">.</span><span class="n">SPC</span><span class="o">.</span><span class="n">from_bytes_io</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-64"><a href="#Spectrum.from_local_file-64"><span class="linenos">64</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-65"><a href="#Spectrum.from_local_file-65"><span class="linenos">65</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Single subfile SPCs are supported. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span><span class="si">}</span><span class="s1"> subfiles found&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-66"><a href="#Spectrum.from_local_file-66"><span class="linenos">66</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="n">spc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xarray</span>
</span><span id="Spectrum.from_local_file-67"><a href="#Spectrum.from_local_file-67"><span class="linenos">67</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">spc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yarray</span>
</span><span id="Spectrum.from_local_file-68"><a href="#Spectrum.from_local_file-68"><span class="linenos">68</span></a>                <span class="n">meta</span> <span class="o">=</span> <span class="n">spc</span><span class="o">.</span><span class="n">log_book</span><span class="o">.</span><span class="n">text</span>
</span><span id="Spectrum.from_local_file-69"><a href="#Spectrum.from_local_file-69"><span class="linenos">69</span></a>        <span class="k">elif</span> <span class="n">ft</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spe&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_local_file-70"><a href="#Spectrum.from_local_file-70"><span class="linenos">70</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_spe</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-71"><a href="#Spectrum.from_local_file-71"><span class="linenos">71</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-72"><a href="#Spectrum.from_local_file-72"><span class="linenos">72</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;filetype </span><span class="si">{</span><span class="n">ft</span><span class="si">}</span><span class="s1"> not supported&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-73"><a href="#Spectrum.from_local_file-73"><span class="linenos">73</span></a>        <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;Original file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-74"><a href="#Spectrum.from_local_file-74"><span class="linenos">74</span></a>        <span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">custom_meta</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-75"><a href="#Spectrum.from_local_file-75"><span class="linenos">75</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.from_local_file-76"><a href="#Spectrum.from_local_file-76"><span class="linenos">76</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_local_file-77"><a href="#Spectrum.from_local_file-77"><span class="linenos">77</span></a>
</span><span id="Spectrum.from_local_file-78"><a href="#Spectrum.from_local_file-78"><span class="linenos">78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_rc1</span><span class="p">():</span>
</span><span id="Spectrum.from_local_file-79"><a href="#Spectrum.from_local_file-79"><span class="linenos">79</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">rc1_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">in_file_name</span><span class="p">,</span> <span class="n">filetype</span><span class="p">)</span>
</span><span id="Spectrum.from_local_file-80"><a href="#Spectrum.from_local_file-80"><span class="linenos">80</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">SpeMetadataModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">meta</span><span class="p">))</span>
</span><span id="Spectrum.from_local_file-81"><a href="#Spectrum.from_local_file-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_local_file-82"><a href="#Spectrum.from_local_file-82"><span class="linenos">82</span></a>
</span><span id="Spectrum.from_local_file-83"><a href="#Spectrum.from_local_file-83"><span class="linenos">83</span></a>    <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;native&#39;</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-84"><a href="#Spectrum.from_local_file-84"><span class="linenos">84</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">load_native</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-85"><a href="#Spectrum.from_local_file-85"><span class="linenos">85</span></a>    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-86"><a href="#Spectrum.from_local_file-86"><span class="linenos">86</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">load_rc1</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-87"><a href="#Spectrum.from_local_file-87"><span class="linenos">87</span></a>    <span class="k">elif</span> <span class="n">backend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-88"><a href="#Spectrum.from_local_file-88"><span class="linenos">88</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-89"><a href="#Spectrum.from_local_file-89"><span class="linenos">89</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">load_native</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-90"><a href="#Spectrum.from_local_file-90"><span class="linenos">90</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Spectrum.from_local_file-91"><a href="#Spectrum.from_local_file-91"><span class="linenos">91</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">load_rc1</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-92"><a href="#Spectrum.from_local_file-92"><span class="linenos">92</span></a>    <span class="n">spe</span><span class="o">.</span><span class="n">_sort_x</span><span class="p">()</span>
</span><span id="Spectrum.from_local_file-93"><a href="#Spectrum.from_local_file-93"><span class="linenos">93</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>Read experimental spectrum from a local file.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>in_file_name:</strong>  Path to a local file containing a spectrum.</li>
<li><strong>filetype:</strong>  Specify the filetype. Filetype can be any of: <code>spc</code>, <code>sp</code>, <code>spa</code>, <code>0</code>, <code>1</code>, <code>2</code>, <code>wdf</code>, <code>ngs</code>, <code>jdx</code>, <code>dx</code>,
<code>txt</code>, <code>txtr</code>, <code>tsv</code>, <code>csv</code>, <code>dpt</code>, <code>prn</code>, <code>rruf</code>, <code>spe</code> (Princeton Instruments) or <code>None</code>.
<code>None</code> used to determine by extension of the file.</li>
<li><strong>backend:</strong>  <code>native</code>, <code>rc1_parser</code> or <code>None</code>. <code>None</code> means both.</li>
<li><strong>custom_meta:</strong>  Dict
Add custom metadata fields in the created spectrum</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  When called with unsupported file formats.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.from_simulation" class="classattr">
                                        <input id="Spectrum.from_simulation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_simulation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">in_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">]</span>,</span><span class="param">	<span class="n">sim_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;vasp&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_out&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_dat&#39;</span><span class="p">,</span> <span class="s1">&#39;raw_dat&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">use</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;I_tot&#39;</span><span class="p">,</span> <span class="s1">&#39;I_perp&#39;</span><span class="p">,</span> <span class="s1">&#39;I_par&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xx&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xy&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xz&#39;</span><span class="p">,</span> <span class="s1">&#39;I_yy&#39;</span><span class="p">,</span> <span class="s1">&#39;I_yz&#39;</span><span class="p">,</span> <span class="s1">&#39;I_zz&#39;</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;I_tot&#39;</span><span class="p">,</span> <span class="s1">&#39;I_perp&#39;</span><span class="p">,</span> <span class="s1">&#39;I_par&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xx&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xy&#39;</span><span class="p">,</span> <span class="s1">&#39;I_xz&#39;</span><span class="p">,</span> <span class="s1">&#39;I_yy&#39;</span><span class="p">,</span> <span class="s1">&#39;I_yz&#39;</span><span class="p">,</span> <span class="s1">&#39;I_zz&#39;</span><span class="p">],</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]]</span> <span class="o">=</span> <span class="s1">&#39;I_tot&#39;</span>,</span><span class="param">	<span class="n">nbins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2000</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_simulation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_simulation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_simulation-18"><a href="#Spectrum.from_simulation-18"><span class="linenos">18</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_simulation-19"><a href="#Spectrum.from_simulation-19"><span class="linenos">19</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_simulation-20"><a href="#Spectrum.from_simulation-20"><span class="linenos">20</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_simulation</span><span class="p">(</span><span class="n">in_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TextIOBase</span><span class="p">],</span>
</span><span id="Spectrum.from_simulation-21"><a href="#Spectrum.from_simulation-21"><span class="linenos">21</span></a>                    <span class="n">sim_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;vasp&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_out&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_dat&#39;</span><span class="p">,</span> <span class="s1">&#39;raw_dat&#39;</span><span class="p">],</span>
</span><span id="Spectrum.from_simulation-22"><a href="#Spectrum.from_simulation-22"><span class="linenos">22</span></a>                    <span class="n">use</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">_DIRECTION_LITERALS</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="n">_DIRECTION_LITERALS</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;I_tot&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_simulation-23"><a href="#Spectrum.from_simulation-23"><span class="linenos">23</span></a>                    <span class="n">nbins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>
</span><span id="Spectrum.from_simulation-24"><a href="#Spectrum.from_simulation-24"><span class="linenos">24</span></a>                    <span class="p">):</span>
</span><span id="Spectrum.from_simulation-25"><a href="#Spectrum.from_simulation-25"><span class="linenos">25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_simulation-26"><a href="#Spectrum.from_simulation-26"><span class="linenos">26</span></a><span class="sd">    Generate spectrum from simulation file.</span>
</span><span id="Spectrum.from_simulation-27"><a href="#Spectrum.from_simulation-27"><span class="linenos">27</span></a>
</span><span id="Spectrum.from_simulation-28"><a href="#Spectrum.from_simulation-28"><span class="linenos">28</span></a><span class="sd">    The returned spectrum has only few x/y pairs -- one for each simulated line. Values along</span>
</span><span id="Spectrum.from_simulation-29"><a href="#Spectrum.from_simulation-29"><span class="linenos">29</span></a><span class="sd">    the x-axis will not be uniform. To make it uniform, one needs to resample the spectrum.</span>
</span><span id="Spectrum.from_simulation-30"><a href="#Spectrum.from_simulation-30"><span class="linenos">30</span></a>
</span><span id="Spectrum.from_simulation-31"><a href="#Spectrum.from_simulation-31"><span class="linenos">31</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_simulation-32"><a href="#Spectrum.from_simulation-32"><span class="linenos">32</span></a><span class="sd">        in_file:</span>
</span><span id="Spectrum.from_simulation-33"><a href="#Spectrum.from_simulation-33"><span class="linenos">33</span></a><span class="sd">            Path to a local file, or file-like object.</span>
</span><span id="Spectrum.from_simulation-34"><a href="#Spectrum.from_simulation-34"><span class="linenos">34</span></a><span class="sd">        sim_type:</span>
</span><span id="Spectrum.from_simulation-35"><a href="#Spectrum.from_simulation-35"><span class="linenos">35</span></a><span class="sd">            If `vasp`: `.dat` file from VASP simulation. If `crystal_out`: `.out` file from CRYSTAL simulation, not</span>
</span><span id="Spectrum.from_simulation-36"><a href="#Spectrum.from_simulation-36"><span class="linenos">36</span></a><span class="sd">            preferred. If `crystal_dat`: `.dat` file from CRYSTAL simulation.</span>
</span><span id="Spectrum.from_simulation-37"><a href="#Spectrum.from_simulation-37"><span class="linenos">37</span></a><span class="sd">        use:</span>
</span><span id="Spectrum.from_simulation-38"><a href="#Spectrum.from_simulation-38"><span class="linenos">38</span></a><span class="sd">            One of the directions `I_tot`, `I_perp`, `I_par`, `I_xx`, `I_xy`,</span>
</span><span id="Spectrum.from_simulation-39"><a href="#Spectrum.from_simulation-39"><span class="linenos">39</span></a><span class="sd">            `I_xz`, `I_yy`, `I_yz`, `I_zz`, `I_tot`, `I_perp`, `I_par` are</span>
</span><span id="Spectrum.from_simulation-40"><a href="#Spectrum.from_simulation-40"><span class="linenos">40</span></a><span class="sd">            available for both CRYSTAL and VASP. `I_xx`, `I_xy`, `I_xz`,</span>
</span><span id="Spectrum.from_simulation-41"><a href="#Spectrum.from_simulation-41"><span class="linenos">41</span></a><span class="sd">            `I_yy`, `I_yz`, `I_zz` are available only for CRYSTAL. If a Dict is</span>
</span><span id="Spectrum.from_simulation-42"><a href="#Spectrum.from_simulation-42"><span class="linenos">42</span></a><span class="sd">            passed, the key should be directions and values should be weighting factor.</span>
</span><span id="Spectrum.from_simulation-43"><a href="#Spectrum.from_simulation-43"><span class="linenos">43</span></a><span class="sd">            For example, `use={&#39;I_perp&#39;: .1, &#39;I_par&#39;: .9}`</span>
</span><span id="Spectrum.from_simulation-44"><a href="#Spectrum.from_simulation-44"><span class="linenos">44</span></a>
</span><span id="Spectrum.from_simulation-45"><a href="#Spectrum.from_simulation-45"><span class="linenos">45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_simulation-46"><a href="#Spectrum.from_simulation-46"><span class="linenos">46</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectrum.from_simulation-47"><a href="#Spectrum.from_simulation-47"><span class="linenos">47</span></a>        <span class="n">use_directions</span> <span class="o">=</span> <span class="p">{</span><span class="n">use</span><span class="p">}</span>
</span><span id="Spectrum.from_simulation-48"><a href="#Spectrum.from_simulation-48"><span class="linenos">48</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_simulation-49"><a href="#Spectrum.from_simulation-49"><span class="linenos">49</span></a>        <span class="n">use_directions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">use</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Spectrum.from_simulation-50"><a href="#Spectrum.from_simulation-50"><span class="linenos">50</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_simulation-51"><a href="#Spectrum.from_simulation-51"><span class="linenos">51</span></a>        <span class="n">labels</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ydict</span> <span class="o">=</span> <span class="n">read_simulated_lines</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="n">sim_type</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="n">use_directions</span><span class="p">)</span>
</span><span id="Spectrum.from_simulation-52"><a href="#Spectrum.from_simulation-52"><span class="linenos">52</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_simulation-53"><a href="#Spectrum.from_simulation-53"><span class="linenos">53</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="Spectrum.from_simulation-54"><a href="#Spectrum.from_simulation-54"><span class="linenos">54</span></a>            <span class="n">labels</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ydict</span> <span class="o">=</span> <span class="n">read_simulated_lines</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">sim_type</span><span class="o">=</span><span class="n">sim_type</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="n">use_directions</span><span class="p">)</span>
</span><span id="Spectrum.from_simulation-55"><a href="#Spectrum.from_simulation-55"><span class="linenos">55</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectrum.from_simulation-56"><a href="#Spectrum.from_simulation-56"><span class="linenos">56</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">ydict</span><span class="p">[</span><span class="n">use</span><span class="p">]</span>
</span><span id="Spectrum.from_simulation-57"><a href="#Spectrum.from_simulation-57"><span class="linenos">57</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_simulation-58"><a href="#Spectrum.from_simulation-58"><span class="linenos">58</span></a>        <span class="n">dirs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">use</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="Spectrum.from_simulation-59"><a href="#Spectrum.from_simulation-59"><span class="linenos">59</span></a>        <span class="n">fact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">use</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="Spectrum.from_simulation-60"><a href="#Spectrum.from_simulation-60"><span class="linenos">60</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">ydict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">])</span> <span class="o">@</span> <span class="n">fact</span>
</span><span id="Spectrum.from_simulation-61"><a href="#Spectrum.from_simulation-61"><span class="linenos">61</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">from_delta_lines</span><span class="p">(</span><span class="n">deltas</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)),</span> <span class="n">nbins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
</span><span id="Spectrum.from_simulation-62"><a href="#Spectrum.from_simulation-62"><span class="linenos">62</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>Generate spectrum from simulation file.</p>

<p>The returned spectrum has only few x/y pairs -- one for each simulated line. Values along
the x-axis will not be uniform. To make it uniform, one needs to resample the spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>in_file:</strong>  Path to a local file, or file-like object.</li>
<li><strong>sim_type:</strong>  If <code>vasp</code>: <code>.dat</code> file from VASP simulation. If <code>crystal_out</code>: <code>.out</code> file from CRYSTAL simulation, not
preferred. If <code>crystal_dat</code>: <code>.dat</code> file from CRYSTAL simulation.</li>
<li><strong>use:</strong>  One of the directions <code>I_tot</code>, <code>I_perp</code>, <code>I_par</code>, <code>I_xx</code>, <code>I_xy</code>,
<code>I_xz</code>, <code>I_yy</code>, <code>I_yz</code>, <code>I_zz</code>, <code>I_tot</code>, <code>I_perp</code>, <code>I_par</code> are
available for both CRYSTAL and VASP. <code>I_xx</code>, <code>I_xy</code>, <code>I_xz</code>,
<code>I_yy</code>, <code>I_yz</code>, <code>I_zz</code> are available only for CRYSTAL. If a Dict is
passed, the key should be directions and values should be weighting factor.
For example, <code>use={'I_perp': .1, 'I_par': .9}</code></li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.from_spectral_component_collection" class="classattr">
                                        <input id="Spectrum.from_spectral_component_collection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_spectral_component_collection</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe_components</span><span class="p">:</span> <span class="n"><a href="../spectral_components/spectral_component_collection.html#SpectralComponentCollection">ramanchada2.spectral_components.spectral_component_collection.SpectralComponentCollection</a></span>,</span><span class="param">	<span class="n">x</span><span class="o">=</span><span class="mi">2000</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_spectral_component_collection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_spectral_component_collection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_spectral_component_collection-11"><a href="#Spectrum.from_spectral_component_collection-11"><span class="linenos">11</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_spectral_component_collection-12"><a href="#Spectrum.from_spectral_component_collection-12"><span class="linenos">12</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_spectral_component_collection-13"><a href="#Spectrum.from_spectral_component_collection-13"><span class="linenos">13</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_spectral_component_collection</span><span class="p">(</span>
</span><span id="Spectrum.from_spectral_component_collection-14"><a href="#Spectrum.from_spectral_component_collection-14"><span class="linenos">14</span></a>        <span class="n">spe_components</span><span class="p">:</span> <span class="n">SpectralComponentCollection</span><span class="p">,</span>
</span><span id="Spectrum.from_spectral_component_collection-15"><a href="#Spectrum.from_spectral_component_collection-15"><span class="linenos">15</span></a>        <span class="n">x</span><span class="o">=</span><span class="mi">2000</span><span class="p">):</span>
</span><span id="Spectrum.from_spectral_component_collection-16"><a href="#Spectrum.from_spectral_component_collection-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_spectral_component_collection-17"><a href="#Spectrum.from_spectral_component_collection-17"><span class="linenos">17</span></a><span class="sd">    from_spectral_component_collection</span>
</span><span id="Spectrum.from_spectral_component_collection-18"><a href="#Spectrum.from_spectral_component_collection-18"><span class="linenos">18</span></a>
</span><span id="Spectrum.from_spectral_component_collection-19"><a href="#Spectrum.from_spectral_component_collection-19"><span class="linenos">19</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_spectral_component_collection-20"><a href="#Spectrum.from_spectral_component_collection-20"><span class="linenos">20</span></a><span class="sd">        spe_components:</span>
</span><span id="Spectrum.from_spectral_component_collection-21"><a href="#Spectrum.from_spectral_component_collection-21"><span class="linenos">21</span></a><span class="sd">            SpectralComponentCollection</span>
</span><span id="Spectrum.from_spectral_component_collection-22"><a href="#Spectrum.from_spectral_component_collection-22"><span class="linenos">22</span></a><span class="sd">        x:</span>
</span><span id="Spectrum.from_spectral_component_collection-23"><a href="#Spectrum.from_spectral_component_collection-23"><span class="linenos">23</span></a><span class="sd">            `int` or array-like, optional, default `2000`. `x` axis of the spectrum.</span>
</span><span id="Spectrum.from_spectral_component_collection-24"><a href="#Spectrum.from_spectral_component_collection-24"><span class="linenos">24</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_spectral_component_collection-25"><a href="#Spectrum.from_spectral_component_collection-25"><span class="linenos">25</span></a>
</span><span id="Spectrum.from_spectral_component_collection-26"><a href="#Spectrum.from_spectral_component_collection-26"><span class="linenos">26</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="s1">&#39;generated&#39;</span><span class="p">})</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.from_spectral_component_collection-27"><a href="#Spectrum.from_spectral_component_collection-27"><span class="linenos">27</span></a>    <span class="n">spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">spe_components</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.from_spectral_component_collection-28"><a href="#Spectrum.from_spectral_component_collection-28"><span class="linenos">28</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>from_spectral_component_collection</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe_components:</strong>  SpectralComponentCollection</li>
<li><strong>x:</strong>  <code>int</code> or array-like, optional, default <code>2000</code>. <code><a href="#Spectrum.x">x</a></code> axis of the spectrum.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.from_stream" class="classattr">
                                        <input id="Spectrum.from_stream-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_stream</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">in_stream</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">,</span> <span class="n">_io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">,</span> <span class="n">_io</span><span class="o">.</span><span class="n">BufferedReader</span><span class="p">]</span>,</span><span class="param">	<span class="n">filetype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;spa&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;wdf&#39;</span><span class="p">,</span> <span class="s1">&#39;ngs&#39;</span><span class="p">,</span> <span class="s1">&#39;jdx&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span> <span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">,</span> <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">]]</span>,</span><span class="param">	<span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;native&#39;</span><span class="p">,</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_stream-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_stream"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_stream-19"><a href="#Spectrum.from_stream-19"><span class="linenos">19</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-20"><a href="#Spectrum.from_stream-20"><span class="linenos">20</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_stream-21"><a href="#Spectrum.from_stream-21"><span class="linenos">21</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_stream</span><span class="p">(</span><span class="n">in_stream</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BufferedReader</span><span class="p">],</span>
</span><span id="Spectrum.from_stream-22"><a href="#Spectrum.from_stream-22"><span class="linenos">22</span></a>                <span class="n">filetype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;spa&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_stream-23"><a href="#Spectrum.from_stream-23"><span class="linenos">23</span></a>                                              <span class="s1">&#39;wdf&#39;</span><span class="p">,</span> <span class="s1">&#39;ngs&#39;</span><span class="p">,</span> <span class="s1">&#39;jdx&#39;</span><span class="p">,</span> <span class="s1">&#39;dx&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_stream-24"><a href="#Spectrum.from_stream-24"><span class="linenos">24</span></a>                                              <span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">,</span>
</span><span id="Spectrum.from_stream-25"><a href="#Spectrum.from_stream-25"><span class="linenos">25</span></a>                                              <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;spe&#39;</span><span class="p">]],</span>
</span><span id="Spectrum.from_stream-26"><a href="#Spectrum.from_stream-26"><span class="linenos">26</span></a>                <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_stream-27"><a href="#Spectrum.from_stream-27"><span class="linenos">27</span></a>                <span class="n">backend</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;native&#39;</span><span class="p">,</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.from_stream-28"><a href="#Spectrum.from_stream-28"><span class="linenos">28</span></a>                <span class="p">):</span>
</span><span id="Spectrum.from_stream-29"><a href="#Spectrum.from_stream-29"><span class="linenos">29</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_native</span><span class="p">():</span>
</span><span id="Spectrum.from_stream-30"><a href="#Spectrum.from_stream-30"><span class="linenos">30</span></a>        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;txt&#39;</span><span class="p">,</span> <span class="s1">&#39;txtr&#39;</span><span class="p">,</span> <span class="s1">&#39;tsv&#39;</span><span class="p">,</span> <span class="s1">&#39;prn&#39;</span><span class="p">,</span> <span class="s1">&#39;rruf&#39;</span><span class="p">,</span> <span class="s1">&#39;dpt&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_stream-31"><a href="#Spectrum.from_stream-31"><span class="linenos">31</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_stream-32"><a href="#Spectrum.from_stream-32"><span class="linenos">32</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">in_stream</span>
</span><span id="Spectrum.from_stream-33"><a href="#Spectrum.from_stream-33"><span class="linenos">33</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-34"><a href="#Spectrum.from_stream-34"><span class="linenos">34</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">in_stream</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-35"><a href="#Spectrum.from_stream-35"><span class="linenos">35</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_txt</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-36"><a href="#Spectrum.from_stream-36"><span class="linenos">36</span></a>        <span class="k">elif</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;csv&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_stream-37"><a href="#Spectrum.from_stream-37"><span class="linenos">37</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_stream-38"><a href="#Spectrum.from_stream-38"><span class="linenos">38</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">in_stream</span>
</span><span id="Spectrum.from_stream-39"><a href="#Spectrum.from_stream-39"><span class="linenos">39</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-40"><a href="#Spectrum.from_stream-40"><span class="linenos">40</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">in_stream</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-41"><a href="#Spectrum.from_stream-41"><span class="linenos">41</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-42"><a href="#Spectrum.from_stream-42"><span class="linenos">42</span></a>        <span class="k">elif</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spc&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_stream-43"><a href="#Spectrum.from_stream-43"><span class="linenos">43</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_stream-44"><a href="#Spectrum.from_stream-44"><span class="linenos">44</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;For spc filetype does not support io.TextIOBase&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-45"><a href="#Spectrum.from_stream-45"><span class="linenos">45</span></a>            <span class="n">fp</span> <span class="o">=</span> <span class="n">in_stream</span>
</span><span id="Spectrum.from_stream-46"><a href="#Spectrum.from_stream-46"><span class="linenos">46</span></a>            <span class="n">spc</span> <span class="o">=</span> <span class="n">spc_io</span><span class="o">.</span><span class="n">SPC</span><span class="o">.</span><span class="n">from_bytes_io</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-47"><a href="#Spectrum.from_stream-47"><span class="linenos">47</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-48"><a href="#Spectrum.from_stream-48"><span class="linenos">48</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Single subfile SPCs are supported. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span><span class="si">}</span><span class="s1"> subfiles found&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-49"><a href="#Spectrum.from_stream-49"><span class="linenos">49</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">spc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xarray</span>
</span><span id="Spectrum.from_stream-50"><a href="#Spectrum.from_stream-50"><span class="linenos">50</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">spc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yarray</span>
</span><span id="Spectrum.from_stream-51"><a href="#Spectrum.from_stream-51"><span class="linenos">51</span></a>            <span class="n">meta</span> <span class="o">=</span> <span class="n">spc</span><span class="o">.</span><span class="n">log_book</span><span class="o">.</span><span class="n">text</span>
</span><span id="Spectrum.from_stream-52"><a href="#Spectrum.from_stream-52"><span class="linenos">52</span></a>        <span class="k">elif</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;spe&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.from_stream-53"><a href="#Spectrum.from_stream-53"><span class="linenos">53</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_stream-54"><a href="#Spectrum.from_stream-54"><span class="linenos">54</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;For spc filetype does not support io.TextIOBase&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-55"><a href="#Spectrum.from_stream-55"><span class="linenos">55</span></a>            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;ramanchada2&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dn</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-56"><a href="#Spectrum.from_stream-56"><span class="linenos">56</span></a>                <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span> <span class="ow">or</span> <span class="n">in_stream</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;noname.</span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-57"><a href="#Spectrum.from_stream-57"><span class="linenos">57</span></a>                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dn</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-58"><a href="#Spectrum.from_stream-58"><span class="linenos">58</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-59"><a href="#Spectrum.from_stream-59"><span class="linenos">59</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-60"><a href="#Spectrum.from_stream-60"><span class="linenos">60</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;shutil.copyfileobj(</span><span class="si">{</span><span class="n">in_stream</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-61"><a href="#Spectrum.from_stream-61"><span class="linenos">61</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">read_spe</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-62"><a href="#Spectrum.from_stream-62"><span class="linenos">62</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-63"><a href="#Spectrum.from_stream-63"><span class="linenos">63</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-64"><a href="#Spectrum.from_stream-64"><span class="linenos">64</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;filetype </span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s1"> not supported&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-65"><a href="#Spectrum.from_stream-65"><span class="linenos">65</span></a>        <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;Original file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">if</span> <span class="n">filename</span> <span class="k">else</span> <span class="s1">&#39;N/A loaded from stream&#39;</span>
</span><span id="Spectrum.from_stream-66"><a href="#Spectrum.from_stream-66"><span class="linenos">66</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">meta</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.from_stream-67"><a href="#Spectrum.from_stream-67"><span class="linenos">67</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_stream-68"><a href="#Spectrum.from_stream-68"><span class="linenos">68</span></a>
</span><span id="Spectrum.from_stream-69"><a href="#Spectrum.from_stream-69"><span class="linenos">69</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_rc1</span><span class="p">():</span>
</span><span id="Spectrum.from_stream-70"><a href="#Spectrum.from_stream-70"><span class="linenos">70</span></a>        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;ramanchada2&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dn</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-71"><a href="#Spectrum.from_stream-71"><span class="linenos">71</span></a>            <span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span> <span class="ow">or</span> <span class="n">in_stream</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s1">&#39;noname.</span><span class="si">{</span><span class="n">filetype</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-72"><a href="#Spectrum.from_stream-72"><span class="linenos">72</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dn</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-73"><a href="#Spectrum.from_stream-73"><span class="linenos">73</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
</span><span id="Spectrum.from_stream-74"><a href="#Spectrum.from_stream-74"><span class="linenos">74</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-75"><a href="#Spectrum.from_stream-75"><span class="linenos">75</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-76"><a href="#Spectrum.from_stream-76"><span class="linenos">76</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;shutil.copyfileobj(</span><span class="si">{</span><span class="n">in_stream</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-77"><a href="#Spectrum.from_stream-77"><span class="linenos">77</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-78"><a href="#Spectrum.from_stream-78"><span class="linenos">78</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-79"><a href="#Spectrum.from_stream-79"><span class="linenos">79</span></a>                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">in_stream</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-80"><a href="#Spectrum.from_stream-80"><span class="linenos">80</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;shutil.copyfileobj(</span><span class="si">{</span><span class="n">in_stream</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-81"><a href="#Spectrum.from_stream-81"><span class="linenos">81</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">rc1_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filetype</span><span class="p">)</span>
</span><span id="Spectrum.from_stream-82"><a href="#Spectrum.from_stream-82"><span class="linenos">82</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">SpeMetadataModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">meta</span><span class="p">))</span>
</span><span id="Spectrum.from_stream-83"><a href="#Spectrum.from_stream-83"><span class="linenos">83</span></a>        <span class="k">return</span> <span class="n">spe</span>
</span><span id="Spectrum.from_stream-84"><a href="#Spectrum.from_stream-84"><span class="linenos">84</span></a>
</span><span id="Spectrum.from_stream-85"><a href="#Spectrum.from_stream-85"><span class="linenos">85</span></a>    <span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;native&#39;</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-86"><a href="#Spectrum.from_stream-86"><span class="linenos">86</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">load_native</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-87"><a href="#Spectrum.from_stream-87"><span class="linenos">87</span></a>    <span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s1">&#39;rc1_parser&#39;</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-88"><a href="#Spectrum.from_stream-88"><span class="linenos">88</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">load_rc1</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-89"><a href="#Spectrum.from_stream-89"><span class="linenos">89</span></a>    <span class="k">elif</span> <span class="n">backend</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-90"><a href="#Spectrum.from_stream-90"><span class="linenos">90</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-91"><a href="#Spectrum.from_stream-91"><span class="linenos">91</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">load_native</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-92"><a href="#Spectrum.from_stream-92"><span class="linenos">92</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Spectrum.from_stream-93"><a href="#Spectrum.from_stream-93"><span class="linenos">93</span></a>            <span class="n">spe</span> <span class="o">=</span> <span class="n">load_rc1</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-94"><a href="#Spectrum.from_stream-94"><span class="linenos">94</span></a>
</span><span id="Spectrum.from_stream-95"><a href="#Spectrum.from_stream-95"><span class="linenos">95</span></a>    <span class="n">spe</span><span class="o">.</span><span class="n">_sort_x</span><span class="p">()</span>
</span><span id="Spectrum.from_stream-96"><a href="#Spectrum.from_stream-96"><span class="linenos">96</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.from_test_spe" class="classattr">
                                        <input id="Spectrum.from_test_spe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>

        <span class="def">def</span>
        <span class="name">from_test_spe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">index</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_test_spe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_test_spe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_test_spe-14"><a href="#Spectrum.from_test_spe-14"><span class="linenos">14</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_test_spe-15"><a href="#Spectrum.from_test_spe-15"><span class="linenos">15</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_test_spe</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum.from_test_spe-16"><a href="#Spectrum.from_test_spe-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create new spectrum from test data.</span>
</span><span id="Spectrum.from_test_spe-17"><a href="#Spectrum.from_test_spe-17"><span class="linenos">17</span></a>
</span><span id="Spectrum.from_test_spe-18"><a href="#Spectrum.from_test_spe-18"><span class="linenos">18</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_test_spe-19"><a href="#Spectrum.from_test_spe-19"><span class="linenos">19</span></a><span class="sd">        index:</span>
</span><span id="Spectrum.from_test_spe-20"><a href="#Spectrum.from_test_spe-20"><span class="linenos">20</span></a><span class="sd">            `int` or `None`, optional, default is `None`. If `int`: will be used as an index of filtered list. If</span>
</span><span id="Spectrum.from_test_spe-21"><a href="#Spectrum.from_test_spe-21"><span class="linenos">21</span></a><span class="sd">            `None`: a random spectrum will be taken.</span>
</span><span id="Spectrum.from_test_spe-22"><a href="#Spectrum.from_test_spe-22"><span class="linenos">22</span></a><span class="sd">        **kwargs:</span>
</span><span id="Spectrum.from_test_spe-23"><a href="#Spectrum.from_test_spe-23"><span class="linenos">23</span></a><span class="sd">            The rest of the parameters will be used as filter.</span>
</span><span id="Spectrum.from_test_spe-24"><a href="#Spectrum.from_test_spe-24"><span class="linenos">24</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_test_spe-25"><a href="#Spectrum.from_test_spe-25"><span class="linenos">25</span></a>    <span class="n">filtered</span> <span class="o">=</span> <span class="n">prepend_prefix</span><span class="p">(</span><span class="n">get_filenames</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="Spectrum.from_test_spe-26"><a href="#Spectrum.from_test_spe-26"><span class="linenos">26</span></a>    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.from_test_spe-27"><a href="#Spectrum.from_test_spe-27"><span class="linenos">27</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Spectrum.from_test_spe-28"><a href="#Spectrum.from_test_spe-28"><span class="linenos">28</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.from_test_spe-29"><a href="#Spectrum.from_test_spe-29"><span class="linenos">29</span></a>        <span class="n">fn</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="Spectrum.from_test_spe-30"><a href="#Spectrum.from_test_spe-30"><span class="linenos">30</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="o">.</span><span class="n">from_local_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</span><span id="Spectrum.from_test_spe-31"><a href="#Spectrum.from_test_spe-31"><span class="linenos">31</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>Create new spectrum from test data.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>index:</strong>  <code>int</code> or <code>None</code>, optional, default is <code>None</code>. If <code>int</code>: will be used as an index of filtered list. If
<code>None</code>: a random spectrum will be taken.</li>
<li><strong>**kwargs:</strong>  The rest of the parameters will be used as filter.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.from_theoretical_lines" class="classattr">
                                        <input id="Spectrum.from_theoretical_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor()</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">from_theoretical_lines</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">shapes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian2d&#39;</span><span class="p">,</span> <span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span> <span class="s1">&#39;voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;pvoigt&#39;</span><span class="p">,</span> <span class="s1">&#39;moffat&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson4&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson7&#39;</span><span class="p">,</span> <span class="s1">&#39;breit_wigner&#39;</span><span class="p">,</span> <span class="s1">&#39;damped_oscillator&#39;</span><span class="p">,</span> <span class="s1">&#39;dho&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic&#39;</span><span class="p">,</span> <span class="s1">&#39;lognormal&#39;</span><span class="p">,</span> <span class="s1">&#39;students_t&#39;</span><span class="p">,</span> <span class="s1">&#39;expgaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;doniach&#39;</span><span class="p">,</span> <span class="s1">&#39;skewed_gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;skewed_voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;thermal_distribution&#39;</span><span class="p">,</span> <span class="s1">&#39;bose&#39;</span><span class="p">,</span> <span class="s1">&#39;fermi&#39;</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;powerlaw&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;parabolic&#39;</span><span class="p">,</span> <span class="s1">&#39;sine&#39;</span><span class="p">,</span> <span class="s1">&#39;expsine&#39;</span><span class="p">,</span> <span class="s1">&#39;split_lorentzian&#39;</span><span class="p">]]</span>,</span><span class="param">	<span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">]]]</span> <span class="o">=</span> <span class="mi">2000</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.from_theoretical_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.from_theoretical_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.from_theoretical_lines-26"><a href="#Spectrum.from_theoretical_lines-26"><span class="linenos">26</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">()</span>
</span><span id="Spectrum.from_theoretical_lines-27"><a href="#Spectrum.from_theoretical_lines-27"><span class="linenos">27</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.from_theoretical_lines-28"><a href="#Spectrum.from_theoretical_lines-28"><span class="linenos">28</span></a><span class="k">def</span><span class="w"> </span><span class="nf">from_theoretical_lines</span><span class="p">(</span>
</span><span id="Spectrum.from_theoretical_lines-29"><a href="#Spectrum.from_theoretical_lines-29"><span class="linenos">29</span></a>        <span class="n">shapes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="n">lineshapes</span><span class="o">.</span><span class="n">functions</span><span class="p">]],</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.from_theoretical_lines-30"><a href="#Spectrum.from_theoretical_lines-30"><span class="linenos">30</span></a>        <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
</span><span id="Spectrum.from_theoretical_lines-31"><a href="#Spectrum.from_theoretical_lines-31"><span class="linenos">31</span></a>        <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">):</span>
</span><span id="Spectrum.from_theoretical_lines-32"><a href="#Spectrum.from_theoretical_lines-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.from_theoretical_lines-33"><a href="#Spectrum.from_theoretical_lines-33"><span class="linenos">33</span></a><span class="sd">    Generate spectrum from `lmfit` shapes.</span>
</span><span id="Spectrum.from_theoretical_lines-34"><a href="#Spectrum.from_theoretical_lines-34"><span class="linenos">34</span></a>
</span><span id="Spectrum.from_theoretical_lines-35"><a href="#Spectrum.from_theoretical_lines-35"><span class="linenos">35</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.from_theoretical_lines-36"><a href="#Spectrum.from_theoretical_lines-36"><span class="linenos">36</span></a><span class="sd">        shapes:</span>
</span><span id="Spectrum.from_theoretical_lines-37"><a href="#Spectrum.from_theoretical_lines-37"><span class="linenos">37</span></a><span class="sd">            The shapes to be used for spectrum generation.</span>
</span><span id="Spectrum.from_theoretical_lines-38"><a href="#Spectrum.from_theoretical_lines-38"><span class="linenos">38</span></a><span class="sd">        params:</span>
</span><span id="Spectrum.from_theoretical_lines-39"><a href="#Spectrum.from_theoretical_lines-39"><span class="linenos">39</span></a><span class="sd">            Shape parameters to be applied to be used with shapes.</span>
</span><span id="Spectrum.from_theoretical_lines-40"><a href="#Spectrum.from_theoretical_lines-40"><span class="linenos">40</span></a><span class="sd">        x:</span>
</span><span id="Spectrum.from_theoretical_lines-41"><a href="#Spectrum.from_theoretical_lines-41"><span class="linenos">41</span></a><span class="sd">            Array with `x` values, by default `np.array(2000)`.</span>
</span><span id="Spectrum.from_theoretical_lines-42"><a href="#Spectrum.from_theoretical_lines-42"><span class="linenos">42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.from_theoretical_lines-43"><a href="#Spectrum.from_theoretical_lines-43"><span class="linenos">43</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.from_theoretical_lines-44"><a href="#Spectrum.from_theoretical_lines-44"><span class="linenos">44</span></a>    <span class="n">spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_theoretical_lines</span><span class="p">(</span><span class="n">shapes</span><span class="o">=</span><span class="n">shapes</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.from_theoretical_lines-45"><a href="#Spectrum.from_theoretical_lines-45"><span class="linenos">45</span></a>    <span class="k">return</span> <span class="n">spe</span>
</span></pre></div>


            <div class="docstring"><p>Generate spectrum from <code>lmfit</code> shapes.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>shapes:</strong>  The shapes to be used for spectrum generation.</li>
<li><strong>params:</strong>  Shape parameters to be applied to be used with shapes.</li>
<li><strong>x:</strong>  Array with <code><a href="#Spectrum.x">x</a></code> values, by default <code>np.array(2000)</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.hdr_from_multi_exposure" class="classattr">
                                        <input id="Spectrum.hdr_from_multi_exposure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_constructor">@add_spectrum_constructor(set_applied_processing=True)</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">hdr_from_multi_exposure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spes_in</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n"><a href="#Spectrum">Spectrum</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">meta_exposure_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;intigration times(ms)&#39;</span>,</span><span class="param">	<span class="n">meta_ymax</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;yaxis_max&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.hdr_from_multi_exposure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.hdr_from_multi_exposure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.hdr_from_multi_exposure-12"><a href="#Spectrum.hdr_from_multi_exposure-12"><span class="linenos">12</span></a><span class="nd">@add_spectrum_constructor</span><span class="p">(</span><span class="n">set_applied_processing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.hdr_from_multi_exposure-13"><a href="#Spectrum.hdr_from_multi_exposure-13"><span class="linenos">13</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.hdr_from_multi_exposure-14"><a href="#Spectrum.hdr_from_multi_exposure-14"><span class="linenos">14</span></a><span class="k">def</span><span class="w"> </span><span class="nf">hdr_from_multi_exposure</span><span class="p">(</span><span class="n">spes_in</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Spectrum</span><span class="p">],</span>
</span><span id="Spectrum.hdr_from_multi_exposure-15"><a href="#Spectrum.hdr_from_multi_exposure-15"><span class="linenos">15</span></a>                            <span class="n">meta_exposure_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;intigration times(ms)&#39;</span><span class="p">,</span>
</span><span id="Spectrum.hdr_from_multi_exposure-16"><a href="#Spectrum.hdr_from_multi_exposure-16"><span class="linenos">16</span></a>                            <span class="n">meta_ymax</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;yaxis_max&#39;</span><span class="p">):</span>
</span><span id="Spectrum.hdr_from_multi_exposure-17"><a href="#Spectrum.hdr_from_multi_exposure-17"><span class="linenos">17</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.hdr_from_multi_exposure-18"><a href="#Spectrum.hdr_from_multi_exposure-18"><span class="linenos">18</span></a><span class="sd">    Create an HDR spectrum from several spectra with different exposures.</span>
</span><span id="Spectrum.hdr_from_multi_exposure-19"><a href="#Spectrum.hdr_from_multi_exposure-19"><span class="linenos">19</span></a>
</span><span id="Spectrum.hdr_from_multi_exposure-20"><a href="#Spectrum.hdr_from_multi_exposure-20"><span class="linenos">20</span></a><span class="sd">    The resulting spectrum will have the details in low-intensity peaks</span>
</span><span id="Spectrum.hdr_from_multi_exposure-21"><a href="#Spectrum.hdr_from_multi_exposure-21"><span class="linenos">21</span></a><span class="sd">    from long-exposure-time spectrum. As long-exposure-time</span>
</span><span id="Spectrum.hdr_from_multi_exposure-22"><a href="#Spectrum.hdr_from_multi_exposure-22"><span class="linenos">22</span></a><span class="sd">    spectrum might be sturated, the information for high-intensity</span>
</span><span id="Spectrum.hdr_from_multi_exposure-23"><a href="#Spectrum.hdr_from_multi_exposure-23"><span class="linenos">23</span></a><span class="sd">    peaks will be taken from short-exposure-time spectrum.</span>
</span><span id="Spectrum.hdr_from_multi_exposure-24"><a href="#Spectrum.hdr_from_multi_exposure-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.hdr_from_multi_exposure-25"><a href="#Spectrum.hdr_from_multi_exposure-25"><span class="linenos">25</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.hdr_from_multi_exposure-26"><a href="#Spectrum.hdr_from_multi_exposure-26"><span class="linenos">26</span></a><span class="sd">        spes_in (List[Spectrum]): Set of spectra with different exposures</span>
</span><span id="Spectrum.hdr_from_multi_exposure-27"><a href="#Spectrum.hdr_from_multi_exposure-27"><span class="linenos">27</span></a><span class="sd">        meta_exposure_time (str, optional): The name of the metadata parameter</span>
</span><span id="Spectrum.hdr_from_multi_exposure-28"><a href="#Spectrum.hdr_from_multi_exposure-28"><span class="linenos">28</span></a><span class="sd">            having the exposure/integration time. The units should be the same</span>
</span><span id="Spectrum.hdr_from_multi_exposure-29"><a href="#Spectrum.hdr_from_multi_exposure-29"><span class="linenos">29</span></a><span class="sd">            for all the spectra. Defaults to &#39;intigration times(ms)&#39;.</span>
</span><span id="Spectrum.hdr_from_multi_exposure-30"><a href="#Spectrum.hdr_from_multi_exposure-30"><span class="linenos">30</span></a><span class="sd">        meta_ymax (str, optional): The name fo the metadata parameter having</span>
</span><span id="Spectrum.hdr_from_multi_exposure-31"><a href="#Spectrum.hdr_from_multi_exposure-31"><span class="linenos">31</span></a><span class="sd">            the maximum ADC value. This value will be used as a threshold. If</span>
</span><span id="Spectrum.hdr_from_multi_exposure-32"><a href="#Spectrum.hdr_from_multi_exposure-32"><span class="linenos">32</span></a><span class="sd">            value in a spectrum is higher, the value will be taken from a</span>
</span><span id="Spectrum.hdr_from_multi_exposure-33"><a href="#Spectrum.hdr_from_multi_exposure-33"><span class="linenos">33</span></a><span class="sd">            spectrum with shorter exposure. Defaults to &#39;yaxis_max&#39;.</span>
</span><span id="Spectrum.hdr_from_multi_exposure-34"><a href="#Spectrum.hdr_from_multi_exposure-34"><span class="linenos">34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.hdr_from_multi_exposure-35"><a href="#Spectrum.hdr_from_multi_exposure-35"><span class="linenos">35</span></a>
</span><span id="Spectrum.hdr_from_multi_exposure-36"><a href="#Spectrum.hdr_from_multi_exposure-36"><span class="linenos">36</span></a>    <span class="n">spes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">spes_in</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">meta_exposure_time</span><span class="p">])))</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.hdr_from_multi_exposure-37"><a href="#Spectrum.hdr_from_multi_exposure-37"><span class="linenos">37</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="n">spes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spes</span><span class="p">]):</span>
</span><span id="Spectrum.hdr_from_multi_exposure-38"><a href="#Spectrum.hdr_from_multi_exposure-38"><span class="linenos">38</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x-axes of the spectra should be equal&#39;</span><span class="p">)</span>
</span><span id="Spectrum.hdr_from_multi_exposure-39"><a href="#Spectrum.hdr_from_multi_exposure-39"><span class="linenos">39</span></a>    <span class="n">spes_cpms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">meta_exposure_time</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spes</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.hdr_from_multi_exposure-40"><a href="#Spectrum.hdr_from_multi_exposure-40"><span class="linenos">40</span></a>    <span class="n">masks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">meta_ymax</span><span class="p">],</span> <span class="n">spes</span><span class="p">)))</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.hdr_from_multi_exposure-41"><a href="#Spectrum.hdr_from_multi_exposure-41"><span class="linenos">41</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">spes_cpms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Spectrum.hdr_from_multi_exposure-42"><a href="#Spectrum.hdr_from_multi_exposure-42"><span class="linenos">42</span></a>    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spes_cpms</span><span class="p">)):</span>
</span><span id="Spectrum.hdr_from_multi_exposure-43"><a href="#Spectrum.hdr_from_multi_exposure-43"><span class="linenos">43</span></a>        <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">masks</span><span class="p">[</span><span class="n">si</span><span class="p">]]</span> <span class="o">=</span> <span class="n">spes_cpms</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="o">~</span><span class="n">masks</span><span class="p">[</span><span class="n">si</span><span class="p">]]</span>
</span><span id="Spectrum.hdr_from_multi_exposure-44"><a href="#Spectrum.hdr_from_multi_exposure-44"><span class="linenos">44</span></a>    <span class="k">return</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">spes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an HDR spectrum from several spectra with different exposures.</p>

<p>The resulting spectrum will have the details in low-intensity peaks
from long-exposure-time spectrum. As long-exposure-time
spectrum might be sturated, the information for high-intensity
peaks will be taken from short-exposure-time spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spes_in (List[Spectrum]):</strong>  Set of spectra with different exposures</li>
<li><strong>meta_exposure_time (str, optional):</strong>  The name of the metadata parameter
having the exposure/integration time. The units should be the same
for all the spectra. Defaults to 'intigration times(ms)'.</li>
<li><strong>meta_ymax (str, optional):</strong>  The name fo the metadata parameter having
the maximum ADC value. This value will be used as a threshold. If
value in a spectrum is higher, the value will be taken from a
spectrum with shorter exposure. Defaults to 'yaxis_max'.</li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.add_poisson_noise" class="classattr">
                                        <input id="Spectrum.add_poisson_noise-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">add_poisson_noise</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.add_poisson_noise-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.add_poisson_noise"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.add_poisson_noise-10"><a href="#Spectrum.add_poisson_noise-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.add_poisson_noise-11"><a href="#Spectrum.add_poisson_noise-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.add_poisson_noise-12"><a href="#Spectrum.add_poisson_noise-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_poisson_noise</span><span class="p">(</span>
</span><span id="Spectrum.add_poisson_noise-13"><a href="#Spectrum.add_poisson_noise-13"><span class="linenos">13</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.add_poisson_noise-14"><a href="#Spectrum.add_poisson_noise-14"><span class="linenos">14</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.add_poisson_noise-15"><a href="#Spectrum.add_poisson_noise-15"><span class="linenos">15</span></a>        <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Spectrum.add_poisson_noise-16"><a href="#Spectrum.add_poisson_noise-16"><span class="linenos">16</span></a>        <span class="c1"># validation for rng_seed is removed because</span>
</span><span id="Spectrum.add_poisson_noise-17"><a href="#Spectrum.add_poisson_noise-17"><span class="linenos">17</span></a>        <span class="c1"># it makes in-place modification impossible</span>
</span><span id="Spectrum.add_poisson_noise-18"><a href="#Spectrum.add_poisson_noise-18"><span class="linenos">18</span></a>        <span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.add_poisson_noise-19"><a href="#Spectrum.add_poisson_noise-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.add_poisson_noise-20"><a href="#Spectrum.add_poisson_noise-20"><span class="linenos">20</span></a><span class="sd">    Add poisson noise to the spectrum.</span>
</span><span id="Spectrum.add_poisson_noise-21"><a href="#Spectrum.add_poisson_noise-21"><span class="linenos">21</span></a>
</span><span id="Spectrum.add_poisson_noise-22"><a href="#Spectrum.add_poisson_noise-22"><span class="linenos">22</span></a><span class="sd">    For each particular sample the noise is proportional to $\sqrt{scale*a_i}$.</span>
</span><span id="Spectrum.add_poisson_noise-23"><a href="#Spectrum.add_poisson_noise-23"><span class="linenos">23</span></a>
</span><span id="Spectrum.add_poisson_noise-24"><a href="#Spectrum.add_poisson_noise-24"><span class="linenos">24</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.add_poisson_noise-25"><a href="#Spectrum.add_poisson_noise-25"><span class="linenos">25</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.add_poisson_noise-26"><a href="#Spectrum.add_poisson_noise-26"><span class="linenos">26</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.add_poisson_noise-27"><a href="#Spectrum.add_poisson_noise-27"><span class="linenos">27</span></a><span class="sd">        scale:</span>
</span><span id="Spectrum.add_poisson_noise-28"><a href="#Spectrum.add_poisson_noise-28"><span class="linenos">28</span></a><span class="sd">            `float`, optional, default is `1`. Scale the amplitude of the noise.</span>
</span><span id="Spectrum.add_poisson_noise-29"><a href="#Spectrum.add_poisson_noise-29"><span class="linenos">29</span></a><span class="sd">        rng_seed:</span>
</span><span id="Spectrum.add_poisson_noise-30"><a href="#Spectrum.add_poisson_noise-30"><span class="linenos">30</span></a><span class="sd">            `int` or rng state, optional. Seed for the random generator.</span>
</span><span id="Spectrum.add_poisson_noise-31"><a href="#Spectrum.add_poisson_noise-31"><span class="linenos">31</span></a><span class="sd">            If a state is provided, it is updated in-place.</span>
</span><span id="Spectrum.add_poisson_noise-32"><a href="#Spectrum.add_poisson_noise-32"><span class="linenos">32</span></a>
</span><span id="Spectrum.add_poisson_noise-33"><a href="#Spectrum.add_poisson_noise-33"><span class="linenos">33</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.add_poisson_noise-34"><a href="#Spectrum.add_poisson_noise-34"><span class="linenos">34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.add_poisson_noise-35"><a href="#Spectrum.add_poisson_noise-35"><span class="linenos">35</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng_seed</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Spectrum.add_poisson_noise-36"><a href="#Spectrum.add_poisson_noise-36"><span class="linenos">36</span></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
</span><span id="Spectrum.add_poisson_noise-37"><a href="#Spectrum.add_poisson_noise-37"><span class="linenos">37</span></a>        <span class="n">rng</span><span class="o">.</span><span class="n">bit_generator</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">rng_seed</span>
</span><span id="Spectrum.add_poisson_noise-38"><a href="#Spectrum.add_poisson_noise-38"><span class="linenos">38</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.add_poisson_noise-39"><a href="#Spectrum.add_poisson_noise-39"><span class="linenos">39</span></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">rng_seed</span><span class="p">)</span>
</span><span id="Spectrum.add_poisson_noise-40"><a href="#Spectrum.add_poisson_noise-40"><span class="linenos">40</span></a>    <span class="n">dat</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">scale</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">]</span>
</span><span id="Spectrum.add_poisson_noise-41"><a href="#Spectrum.add_poisson_noise-41"><span class="linenos">41</span></a>    <span class="n">dat</span><span class="p">[</span><span class="n">dat</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.add_poisson_noise-42"><a href="#Spectrum.add_poisson_noise-42"><span class="linenos">42</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rng_seed</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="Spectrum.add_poisson_noise-43"><a href="#Spectrum.add_poisson_noise-43"><span class="linenos">43</span></a>        <span class="n">rng_seed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">bit_generator</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
</span><span id="Spectrum.add_poisson_noise-44"><a href="#Spectrum.add_poisson_noise-44"><span class="linenos">44</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add poisson noise to the spectrum.</p>

<p>For each particular sample the noise is proportional to $\sqrt{scale*a_i}$.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>scale:</strong>  <code>float</code>, optional, default is <code>1</code>. Scale the amplitude of the noise.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional. Seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.pad_zeros" class="classattr">
                                        <input id="Spectrum.pad_zeros-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">pad_zeros</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.pad_zeros-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.pad_zeros"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.pad_zeros-10"><a href="#Spectrum.pad_zeros-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.pad_zeros-11"><a href="#Spectrum.pad_zeros-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.pad_zeros-12"><a href="#Spectrum.pad_zeros-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">pad_zeros</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.pad_zeros-13"><a href="#Spectrum.pad_zeros-13"><span class="linenos">13</span></a>              <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
</span><span id="Spectrum.pad_zeros-14"><a href="#Spectrum.pad_zeros-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.pad_zeros-15"><a href="#Spectrum.pad_zeros-15"><span class="linenos">15</span></a><span class="sd">    Extend x-axis by 100% in both directions.</span>
</span><span id="Spectrum.pad_zeros-16"><a href="#Spectrum.pad_zeros-16"><span class="linenos">16</span></a>
</span><span id="Spectrum.pad_zeros-17"><a href="#Spectrum.pad_zeros-17"><span class="linenos">17</span></a><span class="sd">    The x-axis of resultant spectrum will be:</span>
</span><span id="Spectrum.pad_zeros-18"><a href="#Spectrum.pad_zeros-18"><span class="linenos">18</span></a><span class="sd">    $[x_{lower}-(x_{upper}-x_{lower})..(x_{upper}+(x_{upper}-x_{lower}))]$.</span>
</span><span id="Spectrum.pad_zeros-19"><a href="#Spectrum.pad_zeros-19"><span class="linenos">19</span></a><span class="sd">    The length of the new spectrum is 3 times the original. The added values</span>
</span><span id="Spectrum.pad_zeros-20"><a href="#Spectrum.pad_zeros-20"><span class="linenos">20</span></a><span class="sd">    are with an uniform step. In the middle is the original spectrum with</span>
</span><span id="Spectrum.pad_zeros-21"><a href="#Spectrum.pad_zeros-21"><span class="linenos">21</span></a><span class="sd">    original x and y values. The coresponding y vallues for the newly added</span>
</span><span id="Spectrum.pad_zeros-22"><a href="#Spectrum.pad_zeros-22"><span class="linenos">22</span></a><span class="sd">    x-values are always zeros.</span>
</span><span id="Spectrum.pad_zeros-23"><a href="#Spectrum.pad_zeros-23"><span class="linenos">23</span></a>
</span><span id="Spectrum.pad_zeros-24"><a href="#Spectrum.pad_zeros-24"><span class="linenos">24</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.pad_zeros-25"><a href="#Spectrum.pad_zeros-25"><span class="linenos">25</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.pad_zeros-26"><a href="#Spectrum.pad_zeros-26"><span class="linenos">26</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.pad_zeros-27"><a href="#Spectrum.pad_zeros-27"><span class="linenos">27</span></a>
</span><span id="Spectrum.pad_zeros-28"><a href="#Spectrum.pad_zeros-28"><span class="linenos">28</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.pad_zeros-29"><a href="#Spectrum.pad_zeros-29"><span class="linenos">29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.pad_zeros-30"><a href="#Spectrum.pad_zeros-30"><span class="linenos">30</span></a>    <span class="n">lenx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.pad_zeros-31"><a href="#Spectrum.pad_zeros-31"><span class="linenos">31</span></a>    <span class="n">minx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.pad_zeros-32"><a href="#Spectrum.pad_zeros-32"><span class="linenos">32</span></a>    <span class="n">maxx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.pad_zeros-33"><a href="#Spectrum.pad_zeros-33"><span class="linenos">33</span></a>    <span class="n">xl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minx</span><span class="o">-</span><span class="p">(</span><span class="n">maxx</span><span class="o">-</span><span class="n">minx</span><span class="p">),</span> <span class="n">minx</span><span class="p">,</span> <span class="n">lenx</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.pad_zeros-34"><a href="#Spectrum.pad_zeros-34"><span class="linenos">34</span></a>    <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">maxx</span><span class="p">,</span> <span class="n">maxx</span><span class="o">+</span><span class="p">(</span><span class="n">maxx</span><span class="o">-</span><span class="n">minx</span><span class="p">),</span> <span class="n">lenx</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Spectrum.pad_zeros-35"><a href="#Spectrum.pad_zeros-35"><span class="linenos">35</span></a>
</span><span id="Spectrum.pad_zeros-36"><a href="#Spectrum.pad_zeros-36"><span class="linenos">36</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lenx</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">lenx</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
</span><span id="Spectrum.pad_zeros-37"><a href="#Spectrum.pad_zeros-37"><span class="linenos">37</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xl</span><span class="p">,</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">xr</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Extend x-axis by 100% in both directions.</p>

<p>The x-axis of resultant spectrum will be:
$[x_{lower}-(x_{upper}-x_{lower})..(x_{upper}+(x_{upper}-x_{lower}))]$.
The length of the new spectrum is 3 times the original. The added values
are with an uniform step. In the middle is the original spectrum with
original x and y values. The coresponding y vallues for the newly added
x-values are always zeros.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.add_gaussian_noise_drift" class="classattr">
                                        <input id="Spectrum.add_gaussian_noise_drift-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">add_gaussian_noise_drift</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>,</span><span class="param">	<span class="n">coef</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>,</span><span class="param">	<span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.add_gaussian_noise_drift-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.add_gaussian_noise_drift"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.add_gaussian_noise_drift-36"><a href="#Spectrum.add_gaussian_noise_drift-36"><span class="linenos">36</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.add_gaussian_noise_drift-37"><a href="#Spectrum.add_gaussian_noise_drift-37"><span class="linenos">37</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.add_gaussian_noise_drift-38"><a href="#Spectrum.add_gaussian_noise_drift-38"><span class="linenos">38</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_gaussian_noise_drift</span><span class="p">(</span>
</span><span id="Spectrum.add_gaussian_noise_drift-39"><a href="#Spectrum.add_gaussian_noise_drift-39"><span class="linenos">39</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-40"><a href="#Spectrum.add_gaussian_noise_drift-40"><span class="linenos">40</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-41"><a href="#Spectrum.add_gaussian_noise_drift-41"><span class="linenos">41</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-42"><a href="#Spectrum.add_gaussian_noise_drift-42"><span class="linenos">42</span></a>        <span class="n">coef</span><span class="p">:</span> <span class="n">confloat</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># type: ignore [valid-type]</span>
</span><span id="Spectrum.add_gaussian_noise_drift-43"><a href="#Spectrum.add_gaussian_noise_drift-43"><span class="linenos">43</span></a>        <span class="c1"># validation for rng_seed is removed because</span>
</span><span id="Spectrum.add_gaussian_noise_drift-44"><a href="#Spectrum.add_gaussian_noise_drift-44"><span class="linenos">44</span></a>        <span class="c1"># it makes in-place modification impossible</span>
</span><span id="Spectrum.add_gaussian_noise_drift-45"><a href="#Spectrum.add_gaussian_noise_drift-45"><span class="linenos">45</span></a>        <span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.add_gaussian_noise_drift-46"><a href="#Spectrum.add_gaussian_noise_drift-46"><span class="linenos">46</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.add_gaussian_noise_drift-47"><a href="#Spectrum.add_gaussian_noise_drift-47"><span class="linenos">47</span></a><span class="sd">    Add cumulative gaussian noise to the spectrum.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-48"><a href="#Spectrum.add_gaussian_noise_drift-48"><span class="linenos">48</span></a>
</span><span id="Spectrum.add_gaussian_noise_drift-49"><a href="#Spectrum.add_gaussian_noise_drift-49"><span class="linenos">49</span></a><span class="sd">    Exponential-moving-average-like gaussian noise is added</span>
</span><span id="Spectrum.add_gaussian_noise_drift-50"><a href="#Spectrum.add_gaussian_noise_drift-50"><span class="linenos">50</span></a><span class="sd">    to each sample. The goal is to mimic the low-frequency noise</span>
</span><span id="Spectrum.add_gaussian_noise_drift-51"><a href="#Spectrum.add_gaussian_noise_drift-51"><span class="linenos">51</span></a><span class="sd">    (or random substructures in spectra).</span>
</span><span id="Spectrum.add_gaussian_noise_drift-52"><a href="#Spectrum.add_gaussian_noise_drift-52"><span class="linenos">52</span></a><span class="sd">    The additive noise is</span>
</span><span id="Spectrum.add_gaussian_noise_drift-53"><a href="#Spectrum.add_gaussian_noise_drift-53"><span class="linenos">53</span></a><span class="sd">    .. math::</span>
</span><span id="Spectrum.add_gaussian_noise_drift-54"><a href="#Spectrum.add_gaussian_noise_drift-54"><span class="linenos">54</span></a><span class="sd">        a_i = coef*\sum_{j=0}^{i-1}g_j + g_i,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-55"><a href="#Spectrum.add_gaussian_noise_drift-55"><span class="linenos">55</span></a><span class="sd">    where</span>
</span><span id="Spectrum.add_gaussian_noise_drift-56"><a href="#Spectrum.add_gaussian_noise_drift-56"><span class="linenos">56</span></a><span class="sd">    .. math::</span>
</span><span id="Spectrum.add_gaussian_noise_drift-57"><a href="#Spectrum.add_gaussian_noise_drift-57"><span class="linenos">57</span></a><span class="sd">        g_i = \mathcal{N}(0, 1+\frac{coef}{\sqrt 2}).</span>
</span><span id="Spectrum.add_gaussian_noise_drift-58"><a href="#Spectrum.add_gaussian_noise_drift-58"><span class="linenos">58</span></a><span class="sd">    This way drifting is possible while keeping the</span>
</span><span id="Spectrum.add_gaussian_noise_drift-59"><a href="#Spectrum.add_gaussian_noise_drift-59"><span class="linenos">59</span></a><span class="sd">    .. math::</span>
</span><span id="Spectrum.add_gaussian_noise_drift-60"><a href="#Spectrum.add_gaussian_noise_drift-60"><span class="linenos">60</span></a><span class="sd">        \sigma(\Delta(a)) \approx 1.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-61"><a href="#Spectrum.add_gaussian_noise_drift-61"><span class="linenos">61</span></a>
</span><span id="Spectrum.add_gaussian_noise_drift-62"><a href="#Spectrum.add_gaussian_noise_drift-62"><span class="linenos">62</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.add_gaussian_noise_drift-63"><a href="#Spectrum.add_gaussian_noise_drift-63"><span class="linenos">63</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.add_gaussian_noise_drift-64"><a href="#Spectrum.add_gaussian_noise_drift-64"><span class="linenos">64</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.add_gaussian_noise_drift-65"><a href="#Spectrum.add_gaussian_noise_drift-65"><span class="linenos">65</span></a><span class="sd">        sigma:</span>
</span><span id="Spectrum.add_gaussian_noise_drift-66"><a href="#Spectrum.add_gaussian_noise_drift-66"><span class="linenos">66</span></a><span class="sd">            Sigma of the gaussian noise.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-67"><a href="#Spectrum.add_gaussian_noise_drift-67"><span class="linenos">67</span></a><span class="sd">        coef:</span>
</span><span id="Spectrum.add_gaussian_noise_drift-68"><a href="#Spectrum.add_gaussian_noise_drift-68"><span class="linenos">68</span></a><span class="sd">            `float` in `[0, 1]`, drifting coefficient. If `coef == 0`,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-69"><a href="#Spectrum.add_gaussian_noise_drift-69"><span class="linenos">69</span></a><span class="sd">            the result is identical to `add_gaussian_noise()`.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-70"><a href="#Spectrum.add_gaussian_noise_drift-70"><span class="linenos">70</span></a><span class="sd">        rng_seed:</span>
</span><span id="Spectrum.add_gaussian_noise_drift-71"><a href="#Spectrum.add_gaussian_noise_drift-71"><span class="linenos">71</span></a><span class="sd">            `int` or rng state, optional. Seed for the random generator.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-72"><a href="#Spectrum.add_gaussian_noise_drift-72"><span class="linenos">72</span></a><span class="sd">            If a state is provided, it is updated in-place.</span>
</span><span id="Spectrum.add_gaussian_noise_drift-73"><a href="#Spectrum.add_gaussian_noise_drift-73"><span class="linenos">73</span></a>
</span><span id="Spectrum.add_gaussian_noise_drift-74"><a href="#Spectrum.add_gaussian_noise_drift-74"><span class="linenos">74</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.add_gaussian_noise_drift-75"><a href="#Spectrum.add_gaussian_noise_drift-75"><span class="linenos">75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.add_gaussian_noise_drift-76"><a href="#Spectrum.add_gaussian_noise_drift-76"><span class="linenos">76</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_add_gaussian_noise_drift</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-77"><a href="#Spectrum.add_gaussian_noise_drift-77"><span class="linenos">77</span></a>                                                  <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-78"><a href="#Spectrum.add_gaussian_noise_drift-78"><span class="linenos">78</span></a>                                                  <span class="n">coef</span><span class="o">=</span><span class="n">coef</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise_drift-79"><a href="#Spectrum.add_gaussian_noise_drift-79"><span class="linenos">79</span></a>                                                  <span class="n">rng_seed</span><span class="o">=</span><span class="n">rng_seed</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add cumulative gaussian noise to the spectrum.</p>

<p>Exponential-moving-average-like gaussian noise is added
to each sample. The goal is to mimic the low-frequency noise
(or random substructures in spectra).
The additive noise is
$$a_i = coef*\sum_{j=0}^{i-1}g_j + g_i,$$</p>

<p>where
$$g_i = \mathcal{N}(0, 1+\frac{coef}{\sqrt 2}).$$</p>

<p>This way drifting is possible while keeping the
$$\sigma(\Delta(a)) \approx 1.$$</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>sigma:</strong>  Sigma of the gaussian noise.</li>
<li><strong>coef:</strong>  <code>float</code> in <code>[0, 1]</code>, drifting coefficient. If <code>coef == 0</code>,
the result is identical to <code><a href="#Spectrum.add_gaussian_noise">add_gaussian_noise()</a></code>.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional. Seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.moving_median" class="classattr">
                                        <input id="Spectrum.moving_median-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">moving_median</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.moving_median-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.moving_median"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.moving_median-20"><a href="#Spectrum.moving_median-20"><span class="linenos">20</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.moving_median-21"><a href="#Spectrum.moving_median-21"><span class="linenos">21</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.moving_median-22"><a href="#Spectrum.moving_median-22"><span class="linenos">22</span></a><span class="k">def</span><span class="w"> </span><span class="nf">moving_median</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.moving_median-23"><a href="#Spectrum.moving_median-23"><span class="linenos">23</span></a>                  <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.moving_median-24"><a href="#Spectrum.moving_median-24"><span class="linenos">24</span></a>                  <span class="n">window_size</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.moving_median-25"><a href="#Spectrum.moving_median-25"><span class="linenos">25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_median-26"><a href="#Spectrum.moving_median-26"><span class="linenos">26</span></a><span class="sd">    Moving median filter.</span>
</span><span id="Spectrum.moving_median-27"><a href="#Spectrum.moving_median-27"><span class="linenos">27</span></a>
</span><span id="Spectrum.moving_median-28"><a href="#Spectrum.moving_median-28"><span class="linenos">28</span></a><span class="sd">    The resultant spectrum is moving minimum of the input.</span>
</span><span id="Spectrum.moving_median-29"><a href="#Spectrum.moving_median-29"><span class="linenos">29</span></a>
</span><span id="Spectrum.moving_median-30"><a href="#Spectrum.moving_median-30"><span class="linenos">30</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.moving_median-31"><a href="#Spectrum.moving_median-31"><span class="linenos">31</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.moving_median-32"><a href="#Spectrum.moving_median-32"><span class="linenos">32</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.moving_median-33"><a href="#Spectrum.moving_median-33"><span class="linenos">33</span></a><span class="sd">        window_size:</span>
</span><span id="Spectrum.moving_median-34"><a href="#Spectrum.moving_median-34"><span class="linenos">34</span></a><span class="sd">            `int`, optional, default is `10`.</span>
</span><span id="Spectrum.moving_median-35"><a href="#Spectrum.moving_median-35"><span class="linenos">35</span></a>
</span><span id="Spectrum.moving_median-36"><a href="#Spectrum.moving_median-36"><span class="linenos">36</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.moving_median-37"><a href="#Spectrum.moving_median-37"><span class="linenos">37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_median-38"><a href="#Spectrum.moving_median-38"><span class="linenos">38</span></a>
</span><span id="Spectrum.moving_median-39"><a href="#Spectrum.moving_median-39"><span class="linenos">39</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">_moving_median</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Moving median filter.</p>

<p>The resultant spectrum is moving minimum of the input.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.subtract_moving_median" class="classattr">
                                        <input id="Spectrum.subtract_moving_median-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">subtract_moving_median</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.subtract_moving_median-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.subtract_moving_median"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.subtract_moving_median-42"><a href="#Spectrum.subtract_moving_median-42"><span class="linenos">42</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.subtract_moving_median-43"><a href="#Spectrum.subtract_moving_median-43"><span class="linenos">43</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.subtract_moving_median-44"><a href="#Spectrum.subtract_moving_median-44"><span class="linenos">44</span></a><span class="k">def</span><span class="w"> </span><span class="nf">subtract_moving_median</span><span class="p">(</span>
</span><span id="Spectrum.subtract_moving_median-45"><a href="#Spectrum.subtract_moving_median-45"><span class="linenos">45</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_moving_median-46"><a href="#Spectrum.subtract_moving_median-46"><span class="linenos">46</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.subtract_moving_median-47"><a href="#Spectrum.subtract_moving_median-47"><span class="linenos">47</span></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Spectrum.subtract_moving_median-48"><a href="#Spectrum.subtract_moving_median-48"><span class="linenos">48</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.subtract_moving_median-49"><a href="#Spectrum.subtract_moving_median-49"><span class="linenos">49</span></a><span class="sd">    Subtract moving median filter.</span>
</span><span id="Spectrum.subtract_moving_median-50"><a href="#Spectrum.subtract_moving_median-50"><span class="linenos">50</span></a>
</span><span id="Spectrum.subtract_moving_median-51"><a href="#Spectrum.subtract_moving_median-51"><span class="linenos">51</span></a><span class="sd">    The resultant spectrum is moving minimum of the input subtracted from the input.</span>
</span><span id="Spectrum.subtract_moving_median-52"><a href="#Spectrum.subtract_moving_median-52"><span class="linenos">52</span></a>
</span><span id="Spectrum.subtract_moving_median-53"><a href="#Spectrum.subtract_moving_median-53"><span class="linenos">53</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.subtract_moving_median-54"><a href="#Spectrum.subtract_moving_median-54"><span class="linenos">54</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.subtract_moving_median-55"><a href="#Spectrum.subtract_moving_median-55"><span class="linenos">55</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.subtract_moving_median-56"><a href="#Spectrum.subtract_moving_median-56"><span class="linenos">56</span></a><span class="sd">        window_size:</span>
</span><span id="Spectrum.subtract_moving_median-57"><a href="#Spectrum.subtract_moving_median-57"><span class="linenos">57</span></a><span class="sd">            `int`, optional, default is `10`.</span>
</span><span id="Spectrum.subtract_moving_median-58"><a href="#Spectrum.subtract_moving_median-58"><span class="linenos">58</span></a>
</span><span id="Spectrum.subtract_moving_median-59"><a href="#Spectrum.subtract_moving_median-59"><span class="linenos">59</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.subtract_moving_median-60"><a href="#Spectrum.subtract_moving_median-60"><span class="linenos">60</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.subtract_moving_median-61"><a href="#Spectrum.subtract_moving_median-61"><span class="linenos">61</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">_moving_median</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Subtract moving median filter.</p>

<p>The resultant spectrum is moving minimum of the input subtracted from the input.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.spike_indices" class="classattr">
                                        <input id="Spectrum.spike_indices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">spike_indices</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Spectrum.spike_indices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.spike_indices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.spike_indices-12"><a href="#Spectrum.spike_indices-12"><span class="linenos">12</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.spike_indices-13"><a href="#Spectrum.spike_indices-13"><span class="linenos">13</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.spike_indices-14"><a href="#Spectrum.spike_indices-14"><span class="linenos">14</span></a><span class="k">def</span><span class="w"> </span><span class="nf">spike_indices</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="n">n_sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
</span><span id="Spectrum.spike_indices-15"><a href="#Spectrum.spike_indices-15"><span class="linenos">15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.spike_indices-16"><a href="#Spectrum.spike_indices-16"><span class="linenos">16</span></a><span class="sd">    Find spikes in spectrum</span>
</span><span id="Spectrum.spike_indices-17"><a href="#Spectrum.spike_indices-17"><span class="linenos">17</span></a>
</span><span id="Spectrum.spike_indices-18"><a href="#Spectrum.spike_indices-18"><span class="linenos">18</span></a><span class="sd">    Single-bin spikes are located using left and right successive</span>
</span><span id="Spectrum.spike_indices-19"><a href="#Spectrum.spike_indices-19"><span class="linenos">19</span></a><span class="sd">    differences. The threshold is based on the standart deviation</span>
</span><span id="Spectrum.spike_indices-20"><a href="#Spectrum.spike_indices-20"><span class="linenos">20</span></a><span class="sd">    of the metric which makes this algorithm less optimal.</span>
</span><span id="Spectrum.spike_indices-21"><a href="#Spectrum.spike_indices-21"><span class="linenos">21</span></a>
</span><span id="Spectrum.spike_indices-22"><a href="#Spectrum.spike_indices-22"><span class="linenos">22</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.spike_indices-23"><a href="#Spectrum.spike_indices-23"><span class="linenos">23</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.spike_indices-24"><a href="#Spectrum.spike_indices-24"><span class="linenos">24</span></a><span class="sd">        n_sigma: Threshold value should be `n_sigma` times the standart</span>
</span><span id="Spectrum.spike_indices-25"><a href="#Spectrum.spike_indices-25"><span class="linenos">25</span></a><span class="sd">          deviation of the metric.</span>
</span><span id="Spectrum.spike_indices-26"><a href="#Spectrum.spike_indices-26"><span class="linenos">26</span></a>
</span><span id="Spectrum.spike_indices-27"><a href="#Spectrum.spike_indices-27"><span class="linenos">27</span></a><span class="sd">    Returns: List of spike indices</span>
</span><span id="Spectrum.spike_indices-28"><a href="#Spectrum.spike_indices-28"><span class="linenos">28</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.spike_indices-29"><a href="#Spectrum.spike_indices-29"><span class="linenos">29</span></a>    <span class="n">yi</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.spike_indices-30"><a href="#Spectrum.spike_indices-30"><span class="linenos">30</span></a>    <span class="n">yi_1</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Spectrum.spike_indices-31"><a href="#Spectrum.spike_indices-31"><span class="linenos">31</span></a>    <span class="n">yi1</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</span><span id="Spectrum.spike_indices-32"><a href="#Spectrum.spike_indices-32"><span class="linenos">32</span></a>    <span class="n">y_merit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">yi</span><span class="o">-</span><span class="n">yi_1</span><span class="o">-</span><span class="n">yi1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yi1</span><span class="o">-</span><span class="n">yi_1</span><span class="p">)</span>
</span><span id="Spectrum.spike_indices-33"><a href="#Spectrum.spike_indices-33"><span class="linenos">33</span></a>    <span class="n">spike_idx</span> <span class="o">=</span> <span class="n">y_merit</span> <span class="o">&gt;</span> <span class="n">n_sigma</span> <span class="o">*</span> <span class="n">y_merit</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</span><span id="Spectrum.spike_indices-34"><a href="#Spectrum.spike_indices-34"><span class="linenos">34</span></a>    <span class="n">spike_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="kc">False</span><span class="p">],</span> <span class="n">spike_idx</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]))</span>
</span><span id="Spectrum.spike_indices-35"><a href="#Spectrum.spike_indices-35"><span class="linenos">35</span></a>    <span class="k">return</span> <span class="n">spike_idx</span>
</span></pre></div>


            <div class="docstring"><p>Find spikes in spectrum</p>

<p>Single-bin spikes are located using left and right successive
differences. The threshold is based on the standart deviation
of the metric which makes this algorithm less optimal.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  Threshold value should be <code>n_sigma</code> times the standart
deviation of the metric.</li>
</ul>

<p>Returns: List of spike indices</p>
</div>


                            </div>
                            <div id="Spectrum.drop_spikes" class="classattr">
                                        <input id="Spectrum.drop_spikes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">drop_spikes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.drop_spikes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.drop_spikes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.drop_spikes-38"><a href="#Spectrum.drop_spikes-38"><span class="linenos">38</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.drop_spikes-39"><a href="#Spectrum.drop_spikes-39"><span class="linenos">39</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.drop_spikes-40"><a href="#Spectrum.drop_spikes-40"><span class="linenos">40</span></a><span class="k">def</span><span class="w"> </span><span class="nf">drop_spikes</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.drop_spikes-41"><a href="#Spectrum.drop_spikes-41"><span class="linenos">41</span></a>                <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.drop_spikes-42"><a href="#Spectrum.drop_spikes-42"><span class="linenos">42</span></a>                <span class="n">n_sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.drop_spikes-43"><a href="#Spectrum.drop_spikes-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.drop_spikes-44"><a href="#Spectrum.drop_spikes-44"><span class="linenos">44</span></a><span class="sd">    Removes single-bin spikes.</span>
</span><span id="Spectrum.drop_spikes-45"><a href="#Spectrum.drop_spikes-45"><span class="linenos">45</span></a>
</span><span id="Spectrum.drop_spikes-46"><a href="#Spectrum.drop_spikes-46"><span class="linenos">46</span></a><span class="sd">    Remove x, y pairs recognised as spikes using left and right</span>
</span><span id="Spectrum.drop_spikes-47"><a href="#Spectrum.drop_spikes-47"><span class="linenos">47</span></a><span class="sd">    successive differences and standard-deviation-based threshold.</span>
</span><span id="Spectrum.drop_spikes-48"><a href="#Spectrum.drop_spikes-48"><span class="linenos">48</span></a>
</span><span id="Spectrum.drop_spikes-49"><a href="#Spectrum.drop_spikes-49"><span class="linenos">49</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.drop_spikes-50"><a href="#Spectrum.drop_spikes-50"><span class="linenos">50</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.drop_spikes-51"><a href="#Spectrum.drop_spikes-51"><span class="linenos">51</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.drop_spikes-52"><a href="#Spectrum.drop_spikes-52"><span class="linenos">52</span></a><span class="sd">        n_sigma: optional, default is `10`.</span>
</span><span id="Spectrum.drop_spikes-53"><a href="#Spectrum.drop_spikes-53"><span class="linenos">53</span></a><span class="sd">            Threshold is `n_sigma` times the standard deviation.</span>
</span><span id="Spectrum.drop_spikes-54"><a href="#Spectrum.drop_spikes-54"><span class="linenos">54</span></a>
</span><span id="Spectrum.drop_spikes-55"><a href="#Spectrum.drop_spikes-55"><span class="linenos">55</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.drop_spikes-56"><a href="#Spectrum.drop_spikes-56"><span class="linenos">56</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.drop_spikes-57"><a href="#Spectrum.drop_spikes-57"><span class="linenos">57</span></a>    <span class="n">use_idx</span> <span class="o">=</span> <span class="o">~</span><span class="n">spike_indices</span><span class="p">(</span><span class="n">old_spe</span><span class="p">,</span> <span class="n">n_sigma</span><span class="o">=</span><span class="n">n_sigma</span><span class="p">)</span>
</span><span id="Spectrum.drop_spikes-58"><a href="#Spectrum.drop_spikes-58"><span class="linenos">58</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">use_idx</span><span class="p">]</span>
</span><span id="Spectrum.drop_spikes-59"><a href="#Spectrum.drop_spikes-59"><span class="linenos">59</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">use_idx</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Removes single-bin spikes.</p>

<p>Remove x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.recover_spikes" class="classattr">
                                        <input id="Spectrum.recover_spikes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">recover_spikes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.recover_spikes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.recover_spikes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.recover_spikes-62"><a href="#Spectrum.recover_spikes-62"><span class="linenos">62</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.recover_spikes-63"><a href="#Spectrum.recover_spikes-63"><span class="linenos">63</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.recover_spikes-64"><a href="#Spectrum.recover_spikes-64"><span class="linenos">64</span></a><span class="k">def</span><span class="w"> </span><span class="nf">recover_spikes</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.recover_spikes-65"><a href="#Spectrum.recover_spikes-65"><span class="linenos">65</span></a>                   <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.recover_spikes-66"><a href="#Spectrum.recover_spikes-66"><span class="linenos">66</span></a>                   <span class="n">n_sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.recover_spikes-67"><a href="#Spectrum.recover_spikes-67"><span class="linenos">67</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.recover_spikes-68"><a href="#Spectrum.recover_spikes-68"><span class="linenos">68</span></a><span class="sd">    Recover single-bin spikes.</span>
</span><span id="Spectrum.recover_spikes-69"><a href="#Spectrum.recover_spikes-69"><span class="linenos">69</span></a>
</span><span id="Spectrum.recover_spikes-70"><a href="#Spectrum.recover_spikes-70"><span class="linenos">70</span></a><span class="sd">    Recover x, y pairs recognised as spikes using left and right</span>
</span><span id="Spectrum.recover_spikes-71"><a href="#Spectrum.recover_spikes-71"><span class="linenos">71</span></a><span class="sd">    successive differences and standard-deviation-based threshold</span>
</span><span id="Spectrum.recover_spikes-72"><a href="#Spectrum.recover_spikes-72"><span class="linenos">72</span></a><span class="sd">    and linear interpolation.</span>
</span><span id="Spectrum.recover_spikes-73"><a href="#Spectrum.recover_spikes-73"><span class="linenos">73</span></a>
</span><span id="Spectrum.recover_spikes-74"><a href="#Spectrum.recover_spikes-74"><span class="linenos">74</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.recover_spikes-75"><a href="#Spectrum.recover_spikes-75"><span class="linenos">75</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.recover_spikes-76"><a href="#Spectrum.recover_spikes-76"><span class="linenos">76</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.recover_spikes-77"><a href="#Spectrum.recover_spikes-77"><span class="linenos">77</span></a><span class="sd">        n_sigma: optional, default is `10`.</span>
</span><span id="Spectrum.recover_spikes-78"><a href="#Spectrum.recover_spikes-78"><span class="linenos">78</span></a><span class="sd">            Threshold is `n_sigma` times the standard deviation.</span>
</span><span id="Spectrum.recover_spikes-79"><a href="#Spectrum.recover_spikes-79"><span class="linenos">79</span></a>
</span><span id="Spectrum.recover_spikes-80"><a href="#Spectrum.recover_spikes-80"><span class="linenos">80</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.recover_spikes-81"><a href="#Spectrum.recover_spikes-81"><span class="linenos">81</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.recover_spikes-82"><a href="#Spectrum.recover_spikes-82"><span class="linenos">82</span></a>    <span class="n">use_idx</span> <span class="o">=</span> <span class="o">~</span><span class="n">spike_indices</span><span class="p">(</span><span class="n">old_spe</span><span class="p">,</span> <span class="n">n_sigma</span><span class="o">=</span><span class="n">n_sigma</span><span class="p">)</span>
</span><span id="Spectrum.recover_spikes-83"><a href="#Spectrum.recover_spikes-83"><span class="linenos">83</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">use_idx</span><span class="p">],</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">use_idx</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Recover single-bin spikes.</p>

<p>Recover x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold
and linear interpolation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.get_spikes" class="classattr">
                                        <input id="Spectrum.get_spikes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">get_spikes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.get_spikes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.get_spikes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.get_spikes-86"><a href="#Spectrum.get_spikes-86"><span class="linenos"> 86</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.get_spikes-87"><a href="#Spectrum.get_spikes-87"><span class="linenos"> 87</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.get_spikes-88"><a href="#Spectrum.get_spikes-88"><span class="linenos"> 88</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_spikes</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.get_spikes-89"><a href="#Spectrum.get_spikes-89"><span class="linenos"> 89</span></a>               <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.get_spikes-90"><a href="#Spectrum.get_spikes-90"><span class="linenos"> 90</span></a>               <span class="n">n_sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.get_spikes-91"><a href="#Spectrum.get_spikes-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.get_spikes-92"><a href="#Spectrum.get_spikes-92"><span class="linenos"> 92</span></a><span class="sd">    Get single-bin spikes only.</span>
</span><span id="Spectrum.get_spikes-93"><a href="#Spectrum.get_spikes-93"><span class="linenos"> 93</span></a>
</span><span id="Spectrum.get_spikes-94"><a href="#Spectrum.get_spikes-94"><span class="linenos"> 94</span></a><span class="sd">    Get x, y pairs recognised as spikes using left and right</span>
</span><span id="Spectrum.get_spikes-95"><a href="#Spectrum.get_spikes-95"><span class="linenos"> 95</span></a><span class="sd">    successive differences and standard-deviation-based threshold</span>
</span><span id="Spectrum.get_spikes-96"><a href="#Spectrum.get_spikes-96"><span class="linenos"> 96</span></a><span class="sd">    and linear interpolation.</span>
</span><span id="Spectrum.get_spikes-97"><a href="#Spectrum.get_spikes-97"><span class="linenos"> 97</span></a>
</span><span id="Spectrum.get_spikes-98"><a href="#Spectrum.get_spikes-98"><span class="linenos"> 98</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.get_spikes-99"><a href="#Spectrum.get_spikes-99"><span class="linenos"> 99</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.get_spikes-100"><a href="#Spectrum.get_spikes-100"><span class="linenos">100</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.get_spikes-101"><a href="#Spectrum.get_spikes-101"><span class="linenos">101</span></a><span class="sd">        n_sigma: optional, default is `10`.</span>
</span><span id="Spectrum.get_spikes-102"><a href="#Spectrum.get_spikes-102"><span class="linenos">102</span></a><span class="sd">            Threshold is `n_sigma` times the standard deviation.</span>
</span><span id="Spectrum.get_spikes-103"><a href="#Spectrum.get_spikes-103"><span class="linenos">103</span></a>
</span><span id="Spectrum.get_spikes-104"><a href="#Spectrum.get_spikes-104"><span class="linenos">104</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.get_spikes-105"><a href="#Spectrum.get_spikes-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.get_spikes-106"><a href="#Spectrum.get_spikes-106"><span class="linenos">106</span></a>    <span class="n">spike_idx</span> <span class="o">=</span> <span class="n">spike_indices</span><span class="p">(</span><span class="n">old_spe</span><span class="p">,</span> <span class="n">n_sigma</span><span class="o">=</span><span class="n">n_sigma</span><span class="p">)</span>
</span><span id="Spectrum.get_spikes-107"><a href="#Spectrum.get_spikes-107"><span class="linenos">107</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">spike_idx</span><span class="p">]</span>
</span><span id="Spectrum.get_spikes-108"><a href="#Spectrum.get_spikes-108"><span class="linenos">108</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">spike_idx</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get single-bin spikes only.</p>

<p>Get x, y pairs recognised as spikes using left and right
successive differences and standard-deviation-based threshold
and linear interpolation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>n_sigma:</strong>  optional, default is <code>10</code>.
Threshold is <code>n_sigma</code> times the standard deviation.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.convolve" class="classattr">
                                        <input id="Spectrum.convolve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">convolve</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">lineshape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]]]],</span> <span class="nb">float</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="o">~</span><span class="n">_ScalarT</span><span class="p">]],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span> <span class="s1">&#39;voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;pvoigt&#39;</span><span class="p">,</span> <span class="s1">&#39;moffat&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson4&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson7&#39;</span><span class="p">]]</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.convolve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.convolve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.convolve-16"><a href="#Spectrum.convolve-16"><span class="linenos">16</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.convolve-17"><a href="#Spectrum.convolve-17"><span class="linenos">17</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.convolve-18"><a href="#Spectrum.convolve-18"><span class="linenos">18</span></a><span class="k">def</span><span class="w"> </span><span class="nf">convolve</span><span class="p">(</span>
</span><span id="Spectrum.convolve-19"><a href="#Spectrum.convolve-19"><span class="linenos">19</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.convolve-20"><a href="#Spectrum.convolve-20"><span class="linenos">20</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.convolve-21"><a href="#Spectrum.convolve-21"><span class="linenos">21</span></a>        <span class="n">lineshape</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]],</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.convolve-22"><a href="#Spectrum.convolve-22"><span class="linenos">22</span></a>                         <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
</span><span id="Spectrum.convolve-23"><a href="#Spectrum.convolve-23"><span class="linenos">23</span></a>                         <span class="n">Literal</span><span class="p">[</span>
</span><span id="Spectrum.convolve-24"><a href="#Spectrum.convolve-24"><span class="linenos">24</span></a>                              <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;lorentzian&#39;</span><span class="p">,</span>
</span><span id="Spectrum.convolve-25"><a href="#Spectrum.convolve-25"><span class="linenos">25</span></a>                              <span class="s1">&#39;voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;pvoigt&#39;</span><span class="p">,</span> <span class="s1">&#39;moffat&#39;</span><span class="p">,</span>
</span><span id="Spectrum.convolve-26"><a href="#Spectrum.convolve-26"><span class="linenos">26</span></a>                              <span class="s1">&#39;pearson4&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson7&#39;</span>
</span><span id="Spectrum.convolve-27"><a href="#Spectrum.convolve-27"><span class="linenos">27</span></a>                              <span class="p">]],</span>
</span><span id="Spectrum.convolve-28"><a href="#Spectrum.convolve-28"><span class="linenos">28</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum.convolve-29"><a href="#Spectrum.convolve-29"><span class="linenos">29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.convolve-30"><a href="#Spectrum.convolve-30"><span class="linenos">30</span></a><span class="sd">    Convole spectrum with arbitrary lineshape.</span>
</span><span id="Spectrum.convolve-31"><a href="#Spectrum.convolve-31"><span class="linenos">31</span></a>
</span><span id="Spectrum.convolve-32"><a href="#Spectrum.convolve-32"><span class="linenos">32</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.convolve-33"><a href="#Spectrum.convolve-33"><span class="linenos">33</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.convolve-34"><a href="#Spectrum.convolve-34"><span class="linenos">34</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.convolve-35"><a href="#Spectrum.convolve-35"><span class="linenos">35</span></a><span class="sd">        lineshape:callable, `str` or `np.ndarray`.</span>
</span><span id="Spectrum.convolve-36"><a href="#Spectrum.convolve-36"><span class="linenos">36</span></a><span class="sd">             If callable: should have a single positional argument `x`, e.g.</span>
</span><span id="Spectrum.convolve-37"><a href="#Spectrum.convolve-37"><span class="linenos">37</span></a><span class="sd">            `lambda x: np.exp((x/5)**2)`.</span>
</span><span id="Spectrum.convolve-38"><a href="#Spectrum.convolve-38"><span class="linenos">38</span></a><span class="sd">            If predefined peak profile: can be `gaussian`, `lorentzian`, `voigt`,</span>
</span><span id="Spectrum.convolve-39"><a href="#Spectrum.convolve-39"><span class="linenos">39</span></a><span class="sd">            `pvoigt`, `moffat` or `pearson4`.</span>
</span><span id="Spectrum.convolve-40"><a href="#Spectrum.convolve-40"><span class="linenos">40</span></a><span class="sd">            If `np.ndarray`: lineshape in samples.</span>
</span><span id="Spectrum.convolve-41"><a href="#Spectrum.convolve-41"><span class="linenos">41</span></a><span class="sd">        **kwargs:</span>
</span><span id="Spectrum.convolve-42"><a href="#Spectrum.convolve-42"><span class="linenos">42</span></a><span class="sd">            Additional kwargs will be passed to lineshape function.</span>
</span><span id="Spectrum.convolve-43"><a href="#Spectrum.convolve-43"><span class="linenos">43</span></a>
</span><span id="Spectrum.convolve-44"><a href="#Spectrum.convolve-44"><span class="linenos">44</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.convolve-45"><a href="#Spectrum.convolve-45"><span class="linenos">45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.convolve-46"><a href="#Spectrum.convolve-46"><span class="linenos">46</span></a>
</span><span id="Spectrum.convolve-47"><a href="#Spectrum.convolve-47"><span class="linenos">47</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lineshape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="Spectrum.convolve-48"><a href="#Spectrum.convolve-48"><span class="linenos">48</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">lineshape</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
</span><span id="Spectrum.convolve-49"><a href="#Spectrum.convolve-49"><span class="linenos">49</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.convolve-50"><a href="#Spectrum.convolve-50"><span class="linenos">50</span></a>        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">lineshape</span><span class="p">):</span>
</span><span id="Spectrum.convolve-51"><a href="#Spectrum.convolve-51"><span class="linenos">51</span></a>            <span class="n">shape_fun</span> <span class="o">=</span> <span class="n">lineshape</span>
</span><span id="Spectrum.convolve-52"><a href="#Spectrum.convolve-52"><span class="linenos">52</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.convolve-53"><a href="#Spectrum.convolve-53"><span class="linenos">53</span></a>            <span class="n">shape_fun</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">lmfit</span><span class="o">.</span><span class="n">lineshapes</span><span class="p">,</span> <span class="n">lineshape</span><span class="p">)</span>
</span><span id="Spectrum.convolve-54"><a href="#Spectrum.convolve-54"><span class="linenos">54</span></a>
</span><span id="Spectrum.convolve-55"><a href="#Spectrum.convolve-55"><span class="linenos">55</span></a>        <span class="n">leny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.convolve-56"><a href="#Spectrum.convolve-56"><span class="linenos">56</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">leny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">leny</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="Spectrum.convolve-57"><a href="#Spectrum.convolve-57"><span class="linenos">57</span></a>        <span class="n">shape_val</span> <span class="o">=</span> <span class="n">shape_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.convolve-58"><a href="#Spectrum.convolve-58"><span class="linenos">58</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">shape_val</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convole spectrum with arbitrary lineshape.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>lineshape:</strong> callable, <code>str</code> or <code>np.ndarray</code>.
 If callable: should have a single positional argument <code><a href="#Spectrum.x">x</a></code>, e.g.
<code>lambda x: np.exp((x/5)**2)</code>.
If predefined peak profile: can be <code>gaussian</code>, <code>lorentzian</code>, <code>voigt</code>,
<code>pvoigt</code>, <code>moffat</code> or <code>pearson4</code>.
If <code>np.ndarray</code>: lineshape in samples.</li>
<li><strong>**kwargs:</strong>  Additional kwargs will be passed to lineshape function.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.trim_axes" class="classattr">
                                        <input id="Spectrum.trim_axes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">trim_axes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;x-axis&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="n">boundaries</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.trim_axes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.trim_axes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.trim_axes-12"><a href="#Spectrum.trim_axes-12"><span class="linenos">12</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.trim_axes-13"><a href="#Spectrum.trim_axes-13"><span class="linenos">13</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.trim_axes-14"><a href="#Spectrum.trim_axes-14"><span class="linenos">14</span></a><span class="k">def</span><span class="w"> </span><span class="nf">trim_axes</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.trim_axes-15"><a href="#Spectrum.trim_axes-15"><span class="linenos">15</span></a>              <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.trim_axes-16"><a href="#Spectrum.trim_axes-16"><span class="linenos">16</span></a>              <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;x-axis&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">],</span>
</span><span id="Spectrum.trim_axes-17"><a href="#Spectrum.trim_axes-17"><span class="linenos">17</span></a>              <span class="n">boundaries</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
</span><span id="Spectrum.trim_axes-18"><a href="#Spectrum.trim_axes-18"><span class="linenos">18</span></a>              <span class="p">):</span>
</span><span id="Spectrum.trim_axes-19"><a href="#Spectrum.trim_axes-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.trim_axes-20"><a href="#Spectrum.trim_axes-20"><span class="linenos">20</span></a><span class="sd">    Trim axes of the spectrum.</span>
</span><span id="Spectrum.trim_axes-21"><a href="#Spectrum.trim_axes-21"><span class="linenos">21</span></a>
</span><span id="Spectrum.trim_axes-22"><a href="#Spectrum.trim_axes-22"><span class="linenos">22</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.trim_axes-23"><a href="#Spectrum.trim_axes-23"><span class="linenos">23</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.trim_axes-24"><a href="#Spectrum.trim_axes-24"><span class="linenos">24</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.trim_axes-25"><a href="#Spectrum.trim_axes-25"><span class="linenos">25</span></a><span class="sd">        method: &#39;x-axis&#39; or &#39;bins&#39;</span>
</span><span id="Spectrum.trim_axes-26"><a href="#Spectrum.trim_axes-26"><span class="linenos">26</span></a><span class="sd">            If &#39;x-axis&#39; boundaries will be interpreted as x-axis values.</span>
</span><span id="Spectrum.trim_axes-27"><a href="#Spectrum.trim_axes-27"><span class="linenos">27</span></a><span class="sd">            If &#39;bins&#39; boundaries will be interpreted as indices.</span>
</span><span id="Spectrum.trim_axes-28"><a href="#Spectrum.trim_axes-28"><span class="linenos">28</span></a><span class="sd">        boundaries: lower and upper boundary for the trimming.</span>
</span><span id="Spectrum.trim_axes-29"><a href="#Spectrum.trim_axes-29"><span class="linenos">29</span></a>
</span><span id="Spectrum.trim_axes-30"><a href="#Spectrum.trim_axes-30"><span class="linenos">30</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.trim_axes-31"><a href="#Spectrum.trim_axes-31"><span class="linenos">31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.trim_axes-32"><a href="#Spectrum.trim_axes-32"><span class="linenos">32</span></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span>
</span><span id="Spectrum.trim_axes-33"><a href="#Spectrum.trim_axes-33"><span class="linenos">33</span></a>        <span class="n">lb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Spectrum.trim_axes-34"><a href="#Spectrum.trim_axes-34"><span class="linenos">34</span></a>        <span class="n">rb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Spectrum.trim_axes-35"><a href="#Spectrum.trim_axes-35"><span class="linenos">35</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;x-axis&#39;</span><span class="p">:</span>
</span><span id="Spectrum.trim_axes-36"><a href="#Spectrum.trim_axes-36"><span class="linenos">36</span></a>        <span class="n">lb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</span><span id="Spectrum.trim_axes-37"><a href="#Spectrum.trim_axes-37"><span class="linenos">37</span></a>        <span class="n">rb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="Spectrum.trim_axes-38"><a href="#Spectrum.trim_axes-38"><span class="linenos">38</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">lb</span><span class="p">:</span><span class="n">rb</span><span class="p">]</span>
</span><span id="Spectrum.trim_axes-39"><a href="#Spectrum.trim_axes-39"><span class="linenos">39</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">lb</span><span class="p">:</span><span class="n">rb</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Trim axes of the spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>method:</strong>  'x-axis' or 'bins'
If 'x-axis' boundaries will be interpreted as x-axis values.
If 'bins' boundaries will be interpreted as indices.</li>
<li><strong>boundaries:</strong>  lower and upper boundary for the trimming.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.moving_average" class="classattr">
                                        <input id="Spectrum.moving_average-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">moving_average</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.moving_average-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.moving_average"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.moving_average-11"><a href="#Spectrum.moving_average-11"><span class="linenos">11</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.moving_average-12"><a href="#Spectrum.moving_average-12"><span class="linenos">12</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.moving_average-13"><a href="#Spectrum.moving_average-13"><span class="linenos">13</span></a><span class="k">def</span><span class="w"> </span><span class="nf">moving_average</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.moving_average-14"><a href="#Spectrum.moving_average-14"><span class="linenos">14</span></a>                   <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.moving_average-15"><a href="#Spectrum.moving_average-15"><span class="linenos">15</span></a>                   <span class="n">window_size</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.moving_average-16"><a href="#Spectrum.moving_average-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_average-17"><a href="#Spectrum.moving_average-17"><span class="linenos">17</span></a><span class="sd">    Moving average filter.</span>
</span><span id="Spectrum.moving_average-18"><a href="#Spectrum.moving_average-18"><span class="linenos">18</span></a>
</span><span id="Spectrum.moving_average-19"><a href="#Spectrum.moving_average-19"><span class="linenos">19</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.moving_average-20"><a href="#Spectrum.moving_average-20"><span class="linenos">20</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.moving_average-21"><a href="#Spectrum.moving_average-21"><span class="linenos">21</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.moving_average-22"><a href="#Spectrum.moving_average-22"><span class="linenos">22</span></a><span class="sd">        window_size:</span>
</span><span id="Spectrum.moving_average-23"><a href="#Spectrum.moving_average-23"><span class="linenos">23</span></a><span class="sd">            `int`, optional, default is `10`.</span>
</span><span id="Spectrum.moving_average-24"><a href="#Spectrum.moving_average-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.moving_average-25"><a href="#Spectrum.moving_average-25"><span class="linenos">25</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.moving_average-26"><a href="#Spectrum.moving_average-26"><span class="linenos">26</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_average-27"><a href="#Spectrum.moving_average-27"><span class="linenos">27</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">))])</span>
</span><span id="Spectrum.moving_average-28"><a href="#Spectrum.moving_average-28"><span class="linenos">28</span></a>         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">))]</span>
</span><span id="Spectrum.moving_average-29"><a href="#Spectrum.moving_average-29"><span class="linenos">29</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Moving average filter.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.moving_average_convolve" class="classattr">
                                        <input id="Spectrum.moving_average_convolve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">moving_average_convolve</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">window_size</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.moving_average_convolve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.moving_average_convolve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.moving_average_convolve-32"><a href="#Spectrum.moving_average_convolve-32"><span class="linenos">32</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.moving_average_convolve-33"><a href="#Spectrum.moving_average_convolve-33"><span class="linenos">33</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.moving_average_convolve-34"><a href="#Spectrum.moving_average_convolve-34"><span class="linenos">34</span></a><span class="k">def</span><span class="w"> </span><span class="nf">moving_average_convolve</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.moving_average_convolve-35"><a href="#Spectrum.moving_average_convolve-35"><span class="linenos">35</span></a>                            <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.moving_average_convolve-36"><a href="#Spectrum.moving_average_convolve-36"><span class="linenos">36</span></a>                            <span class="n">window_size</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
</span><span id="Spectrum.moving_average_convolve-37"><a href="#Spectrum.moving_average_convolve-37"><span class="linenos">37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_average_convolve-38"><a href="#Spectrum.moving_average_convolve-38"><span class="linenos">38</span></a><span class="sd">    Moving average filter.</span>
</span><span id="Spectrum.moving_average_convolve-39"><a href="#Spectrum.moving_average_convolve-39"><span class="linenos">39</span></a>
</span><span id="Spectrum.moving_average_convolve-40"><a href="#Spectrum.moving_average_convolve-40"><span class="linenos">40</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.moving_average_convolve-41"><a href="#Spectrum.moving_average_convolve-41"><span class="linenos">41</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.moving_average_convolve-42"><a href="#Spectrum.moving_average_convolve-42"><span class="linenos">42</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.moving_average_convolve-43"><a href="#Spectrum.moving_average_convolve-43"><span class="linenos">43</span></a><span class="sd">        window_size:</span>
</span><span id="Spectrum.moving_average_convolve-44"><a href="#Spectrum.moving_average_convolve-44"><span class="linenos">44</span></a><span class="sd">            `int`, optional, default is `10`.</span>
</span><span id="Spectrum.moving_average_convolve-45"><a href="#Spectrum.moving_average_convolve-45"><span class="linenos">45</span></a>
</span><span id="Spectrum.moving_average_convolve-46"><a href="#Spectrum.moving_average_convolve-46"><span class="linenos">46</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.moving_average_convolve-47"><a href="#Spectrum.moving_average_convolve-47"><span class="linenos">47</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.moving_average_convolve-48"><a href="#Spectrum.moving_average_convolve-48"><span class="linenos">48</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span><span class="o">/</span><span class="n">window_size</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Moving average filter.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>window_size:</strong>  <code>int</code>, optional, default is <code>10</code>.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.smoothing_RC1" class="classattr">
                                        <input id="Spectrum.smoothing_RC1-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">smoothing_RC1</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;savgol&#39;</span><span class="p">,</span> <span class="s1">&#39;sg&#39;</span><span class="p">,</span> <span class="s1">&#39;wiener&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;gauss&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;lowess&#39;</span><span class="p">,</span> <span class="s1">&#39;boxcar&#39;</span><span class="p">]</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.smoothing_RC1-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.smoothing_RC1"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.smoothing_RC1-16"><a href="#Spectrum.smoothing_RC1-16"><span class="linenos">16</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.smoothing_RC1-17"><a href="#Spectrum.smoothing_RC1-17"><span class="linenos">17</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.smoothing_RC1-18"><a href="#Spectrum.smoothing_RC1-18"><span class="linenos">18</span></a><span class="k">def</span><span class="w"> </span><span class="nf">smoothing_RC1</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-19"><a href="#Spectrum.smoothing_RC1-19"><span class="linenos">19</span></a>                  <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-20"><a href="#Spectrum.smoothing_RC1-20"><span class="linenos">20</span></a>                  <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;savgol&#39;</span><span class="p">,</span> <span class="s1">&#39;sg&#39;</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-21"><a href="#Spectrum.smoothing_RC1-21"><span class="linenos">21</span></a>                                  <span class="s1">&#39;wiener&#39;</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-22"><a href="#Spectrum.smoothing_RC1-22"><span class="linenos">22</span></a>                                  <span class="s1">&#39;median&#39;</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-23"><a href="#Spectrum.smoothing_RC1-23"><span class="linenos">23</span></a>                                  <span class="s1">&#39;gauss&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-24"><a href="#Spectrum.smoothing_RC1-24"><span class="linenos">24</span></a>                                  <span class="s1">&#39;lowess&#39;</span><span class="p">,</span>
</span><span id="Spectrum.smoothing_RC1-25"><a href="#Spectrum.smoothing_RC1-25"><span class="linenos">25</span></a>                                  <span class="s1">&#39;boxcar&#39;</span><span class="p">],</span>
</span><span id="Spectrum.smoothing_RC1-26"><a href="#Spectrum.smoothing_RC1-26"><span class="linenos">26</span></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum.smoothing_RC1-27"><a href="#Spectrum.smoothing_RC1-27"><span class="linenos">27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.smoothing_RC1-28"><a href="#Spectrum.smoothing_RC1-28"><span class="linenos">28</span></a><span class="sd">    Smooth the spectrum.</span>
</span><span id="Spectrum.smoothing_RC1-29"><a href="#Spectrum.smoothing_RC1-29"><span class="linenos">29</span></a>
</span><span id="Spectrum.smoothing_RC1-30"><a href="#Spectrum.smoothing_RC1-30"><span class="linenos">30</span></a><span class="sd">    The spectrum will be smoothed using the specified filter.</span>
</span><span id="Spectrum.smoothing_RC1-31"><a href="#Spectrum.smoothing_RC1-31"><span class="linenos">31</span></a><span class="sd">    This method is inherited from ramanchada1 for compatibility reasons.</span>
</span><span id="Spectrum.smoothing_RC1-32"><a href="#Spectrum.smoothing_RC1-32"><span class="linenos">32</span></a>
</span><span id="Spectrum.smoothing_RC1-33"><a href="#Spectrum.smoothing_RC1-33"><span class="linenos">33</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.smoothing_RC1-34"><a href="#Spectrum.smoothing_RC1-34"><span class="linenos">34</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.smoothing_RC1-35"><a href="#Spectrum.smoothing_RC1-35"><span class="linenos">35</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.smoothing_RC1-36"><a href="#Spectrum.smoothing_RC1-36"><span class="linenos">36</span></a><span class="sd">        method: method to be used</span>
</span><span id="Spectrum.smoothing_RC1-37"><a href="#Spectrum.smoothing_RC1-37"><span class="linenos">37</span></a><span class="sd">        **kwargs: keyword arguments to be passed to the selected method</span>
</span><span id="Spectrum.smoothing_RC1-38"><a href="#Spectrum.smoothing_RC1-38"><span class="linenos">38</span></a>
</span><span id="Spectrum.smoothing_RC1-39"><a href="#Spectrum.smoothing_RC1-39"><span class="linenos">39</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.smoothing_RC1-40"><a href="#Spectrum.smoothing_RC1-40"><span class="linenos">40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.smoothing_RC1-41"><a href="#Spectrum.smoothing_RC1-41"><span class="linenos">41</span></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;savgol&#39;</span> <span class="ow">or</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;sg&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-42"><a href="#Spectrum.smoothing_RC1-42"><span class="linenos">42</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># window_length, polyorder</span>
</span><span id="Spectrum.smoothing_RC1-43"><a href="#Spectrum.smoothing_RC1-43"><span class="linenos">43</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wiener&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-44"><a href="#Spectrum.smoothing_RC1-44"><span class="linenos">44</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-45"><a href="#Spectrum.smoothing_RC1-45"><span class="linenos">45</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;gaussian&#39;</span> <span class="ow">or</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;gauss&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-46"><a href="#Spectrum.smoothing_RC1-46"><span class="linenos">46</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># sigma</span>
</span><span id="Spectrum.smoothing_RC1-47"><a href="#Spectrum.smoothing_RC1-47"><span class="linenos">47</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;median&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-48"><a href="#Spectrum.smoothing_RC1-48"><span class="linenos">48</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">medfilt</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-49"><a href="#Spectrum.smoothing_RC1-49"><span class="linenos">49</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;lowess&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-50"><a href="#Spectrum.smoothing_RC1-50"><span class="linenos">50</span></a>        <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-51"><a href="#Spectrum.smoothing_RC1-51"><span class="linenos">51</span></a>        <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-52"><a href="#Spectrum.smoothing_RC1-52"><span class="linenos">52</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="Spectrum.smoothing_RC1-53"><a href="#Spectrum.smoothing_RC1-53"><span class="linenos">53</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">kw</span><span class="p">[</span><span class="s1">&#39;span&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)),</span> <span class="n">return_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-54"><a href="#Spectrum.smoothing_RC1-54"><span class="linenos">54</span></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;boxcar&#39;</span><span class="p">:</span>
</span><span id="Spectrum.smoothing_RC1-55"><a href="#Spectrum.smoothing_RC1-55"><span class="linenos">55</span></a>        <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">box_pts</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-56"><a href="#Spectrum.smoothing_RC1-56"><span class="linenos">56</span></a>        <span class="n">kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-57"><a href="#Spectrum.smoothing_RC1-57"><span class="linenos">57</span></a>        <span class="n">box</span> <span class="o">=</span> <span class="n">boxcar</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">sym</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.smoothing_RC1-58"><a href="#Spectrum.smoothing_RC1-58"><span class="linenos">58</span></a>        <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Smooth the spectrum.</p>

<p>The spectrum will be smoothed using the specified filter.
This method is inherited from ramanchada1 for compatibility reasons.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>method:</strong>  method to be used</li>
<li><strong>**kwargs:</strong>  keyword arguments to be passed to the selected method</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.dropna" class="classattr">
                                        <input id="Spectrum.dropna-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">dropna</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.dropna-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.dropna"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.dropna-10"><a href="#Spectrum.dropna-10"><span class="linenos">10</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.dropna-11"><a href="#Spectrum.dropna-11"><span class="linenos">11</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.dropna-12"><a href="#Spectrum.dropna-12"><span class="linenos">12</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dropna</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.dropna-13"><a href="#Spectrum.dropna-13"><span class="linenos">13</span></a>           <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">):</span>
</span><span id="Spectrum.dropna-14"><a href="#Spectrum.dropna-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.dropna-15"><a href="#Spectrum.dropna-15"><span class="linenos">15</span></a><span class="sd">    Remove non finite numbers on both axes</span>
</span><span id="Spectrum.dropna-16"><a href="#Spectrum.dropna-16"><span class="linenos">16</span></a>
</span><span id="Spectrum.dropna-17"><a href="#Spectrum.dropna-17"><span class="linenos">17</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.dropna-18"><a href="#Spectrum.dropna-18"><span class="linenos">18</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.dropna-19"><a href="#Spectrum.dropna-19"><span class="linenos">19</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.dropna-20"><a href="#Spectrum.dropna-20"><span class="linenos">20</span></a>
</span><span id="Spectrum.dropna-21"><a href="#Spectrum.dropna-21"><span class="linenos">21</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.dropna-22"><a href="#Spectrum.dropna-22"><span class="linenos">22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.dropna-23"><a href="#Spectrum.dropna-23"><span class="linenos">23</span></a>
</span><span id="Spectrum.dropna-24"><a href="#Spectrum.dropna-24"><span class="linenos">24</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">x</span>
</span><span id="Spectrum.dropna-25"><a href="#Spectrum.dropna-25"><span class="linenos">25</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.dropna-26"><a href="#Spectrum.dropna-26"><span class="linenos">26</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.dropna-27"><a href="#Spectrum.dropna-27"><span class="linenos">27</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.dropna-28"><a href="#Spectrum.dropna-28"><span class="linenos">28</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.dropna-29"><a href="#Spectrum.dropna-29"><span class="linenos">29</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.dropna-30"><a href="#Spectrum.dropna-30"><span class="linenos">30</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.dropna-31"><a href="#Spectrum.dropna-31"><span class="linenos">31</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.dropna-32"><a href="#Spectrum.dropna-32"><span class="linenos">32</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Spectrum.dropna-33"><a href="#Spectrum.dropna-33"><span class="linenos">33</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>Remove non finite numbers on both axes</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.resample_NUDFT" class="classattr">
                                        <input id="Spectrum.resample_NUDFT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">resample_NUDFT</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>,</span><span class="param">	<span class="n">xnew_bins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;barthann&#39;</span><span class="p">,</span> <span class="s1">&#39;bartlett&#39;</span><span class="p">,</span> <span class="s1">&#39;blackman&#39;</span><span class="p">,</span> <span class="s1">&#39;blackmanharris&#39;</span><span class="p">,</span> <span class="s1">&#39;bohman&#39;</span><span class="p">,</span> <span class="s1">&#39;boxcar&#39;</span><span class="p">,</span> <span class="s1">&#39;chebwin&#39;</span><span class="p">,</span> <span class="s1">&#39;cosine&#39;</span><span class="p">,</span> <span class="s1">&#39;dpss&#39;</span><span class="p">,</span> <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;general_cosine&#39;</span><span class="p">,</span> <span class="s1">&#39;general_gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;general_hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;nuttall&#39;</span><span class="p">,</span> <span class="s1">&#39;parzen&#39;</span><span class="p">,</span> <span class="s1">&#39;taylor&#39;</span><span class="p">,</span> <span class="s1">&#39;triang&#39;</span><span class="p">,</span> <span class="s1">&#39;tukey&#39;</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.resample_NUDFT-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.resample_NUDFT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.resample_NUDFT-16"><a href="#Spectrum.resample_NUDFT-16"><span class="linenos">16</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.resample_NUDFT-17"><a href="#Spectrum.resample_NUDFT-17"><span class="linenos">17</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.resample_NUDFT-18"><a href="#Spectrum.resample_NUDFT-18"><span class="linenos">18</span></a><span class="k">def</span><span class="w"> </span><span class="nf">resample_NUDFT</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-19"><a href="#Spectrum.resample_NUDFT-19"><span class="linenos">19</span></a>                   <span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span>
</span><span id="Spectrum.resample_NUDFT-20"><a href="#Spectrum.resample_NUDFT-20"><span class="linenos">20</span></a>                   <span class="n">xnew_bins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-21"><a href="#Spectrum.resample_NUDFT-21"><span class="linenos">21</span></a>                   <span class="n">window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-22"><a href="#Spectrum.resample_NUDFT-22"><span class="linenos">22</span></a>                                          <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># e.g. (&#39;gaussian&#39;, sigma)</span>
</span><span id="Spectrum.resample_NUDFT-23"><a href="#Spectrum.resample_NUDFT-23"><span class="linenos">23</span></a>                                          <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;barthann&#39;</span><span class="p">,</span> <span class="s1">&#39;bartlett&#39;</span><span class="p">,</span> <span class="s1">&#39;blackman&#39;</span><span class="p">,</span> <span class="s1">&#39;blackmanharris&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-24"><a href="#Spectrum.resample_NUDFT-24"><span class="linenos">24</span></a>                                                  <span class="s1">&#39;bohman&#39;</span><span class="p">,</span> <span class="s1">&#39;boxcar&#39;</span><span class="p">,</span> <span class="s1">&#39;chebwin&#39;</span><span class="p">,</span> <span class="s1">&#39;cosine&#39;</span><span class="p">,</span> <span class="s1">&#39;dpss&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-25"><a href="#Spectrum.resample_NUDFT-25"><span class="linenos">25</span></a>                                                  <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;flattop&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;general_cosine&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-26"><a href="#Spectrum.resample_NUDFT-26"><span class="linenos">26</span></a>                                                  <span class="s1">&#39;general_gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;general_hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;hann&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-27"><a href="#Spectrum.resample_NUDFT-27"><span class="linenos">27</span></a>                                                  <span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;nuttall&#39;</span><span class="p">,</span> <span class="s1">&#39;parzen&#39;</span><span class="p">,</span> <span class="s1">&#39;taylor&#39;</span><span class="p">,</span> <span class="s1">&#39;triang&#39;</span><span class="p">,</span> <span class="s1">&#39;tukey&#39;</span><span class="p">]</span>
</span><span id="Spectrum.resample_NUDFT-28"><a href="#Spectrum.resample_NUDFT-28"><span class="linenos">28</span></a>                                          <span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT-29"><a href="#Spectrum.resample_NUDFT-29"><span class="linenos">29</span></a>                   <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Spectrum.resample_NUDFT-30"><a href="#Spectrum.resample_NUDFT-30"><span class="linenos">30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_NUDFT-31"><a href="#Spectrum.resample_NUDFT-31"><span class="linenos">31</span></a><span class="sd">    Resample the spectrum using Non-uniform discrete fourier transform.</span>
</span><span id="Spectrum.resample_NUDFT-32"><a href="#Spectrum.resample_NUDFT-32"><span class="linenos">32</span></a>
</span><span id="Spectrum.resample_NUDFT-33"><a href="#Spectrum.resample_NUDFT-33"><span class="linenos">33</span></a><span class="sd">    The x-axis of the result will be uniform. The corresponding y-values</span>
</span><span id="Spectrum.resample_NUDFT-34"><a href="#Spectrum.resample_NUDFT-34"><span class="linenos">34</span></a><span class="sd">    will be calculated with NUDFT and inverse FFT.</span>
</span><span id="Spectrum.resample_NUDFT-35"><a href="#Spectrum.resample_NUDFT-35"><span class="linenos">35</span></a>
</span><span id="Spectrum.resample_NUDFT-36"><a href="#Spectrum.resample_NUDFT-36"><span class="linenos">36</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.resample_NUDFT-37"><a href="#Spectrum.resample_NUDFT-37"><span class="linenos">37</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.resample_NUDFT-38"><a href="#Spectrum.resample_NUDFT-38"><span class="linenos">38</span></a><span class="sd">        x_range: optional. Defaults to (0, 4000).</span>
</span><span id="Spectrum.resample_NUDFT-39"><a href="#Spectrum.resample_NUDFT-39"><span class="linenos">39</span></a><span class="sd">            The x_range of the new spectrum.</span>
</span><span id="Spectrum.resample_NUDFT-40"><a href="#Spectrum.resample_NUDFT-40"><span class="linenos">40</span></a><span class="sd">        xnew_bins: optional. Defaults to 100.</span>
</span><span id="Spectrum.resample_NUDFT-41"><a href="#Spectrum.resample_NUDFT-41"><span class="linenos">41</span></a><span class="sd">            Number of bins of the new spectrum</span>
</span><span id="Spectrum.resample_NUDFT-42"><a href="#Spectrum.resample_NUDFT-42"><span class="linenos">42</span></a><span class="sd">        window: optional, Defaults to None.</span>
</span><span id="Spectrum.resample_NUDFT-43"><a href="#Spectrum.resample_NUDFT-43"><span class="linenos">43</span></a><span class="sd">            The window to be used for lowpass filter. If None &#39;blackmanharris&#39; is used.</span>
</span><span id="Spectrum.resample_NUDFT-44"><a href="#Spectrum.resample_NUDFT-44"><span class="linenos">44</span></a><span class="sd">            If no low-pass filter is required, one can use `window=lambda x: [1]*len(x)`.</span>
</span><span id="Spectrum.resample_NUDFT-45"><a href="#Spectrum.resample_NUDFT-45"><span class="linenos">45</span></a><span class="sd">        cumulative: optional. Defaults to False.</span>
</span><span id="Spectrum.resample_NUDFT-46"><a href="#Spectrum.resample_NUDFT-46"><span class="linenos">46</span></a><span class="sd">            If True, the resultant spectrum will be cumulative and normalized</span>
</span><span id="Spectrum.resample_NUDFT-47"><a href="#Spectrum.resample_NUDFT-47"><span class="linenos">47</span></a><span class="sd">            (in analogy with CDF).</span>
</span><span id="Spectrum.resample_NUDFT-48"><a href="#Spectrum.resample_NUDFT-48"><span class="linenos">48</span></a>
</span><span id="Spectrum.resample_NUDFT-49"><a href="#Spectrum.resample_NUDFT-49"><span class="linenos">49</span></a><span class="sd">    Returns:</span>
</span><span id="Spectrum.resample_NUDFT-50"><a href="#Spectrum.resample_NUDFT-50"><span class="linenos">50</span></a><span class="sd">        (x_values, y_values)</span>
</span><span id="Spectrum.resample_NUDFT-51"><a href="#Spectrum.resample_NUDFT-51"><span class="linenos">51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_NUDFT-52"><a href="#Spectrum.resample_NUDFT-52"><span class="linenos">52</span></a>
</span><span id="Spectrum.resample_NUDFT-53"><a href="#Spectrum.resample_NUDFT-53"><span class="linenos">53</span></a>    <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xnew_bins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-54"><a href="#Spectrum.resample_NUDFT-54"><span class="linenos">54</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span>
</span><span id="Spectrum.resample_NUDFT-55"><a href="#Spectrum.resample_NUDFT-55"><span class="linenos">55</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.resample_NUDFT-56"><a href="#Spectrum.resample_NUDFT-56"><span class="linenos">56</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-57"><a href="#Spectrum.resample_NUDFT-57"><span class="linenos">57</span></a>    <span class="n">x_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_range</span><span class="p">))</span>
</span><span id="Spectrum.resample_NUDFT-58"><a href="#Spectrum.resample_NUDFT-58"><span class="linenos">58</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="Spectrum.resample_NUDFT-59"><a href="#Spectrum.resample_NUDFT-59"><span class="linenos">59</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="Spectrum.resample_NUDFT-60"><a href="#Spectrum.resample_NUDFT-60"><span class="linenos">60</span></a>
</span><span id="Spectrum.resample_NUDFT-61"><a href="#Spectrum.resample_NUDFT-61"><span class="linenos">61</span></a>    <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span>
</span><span id="Spectrum.resample_NUDFT-62"><a href="#Spectrum.resample_NUDFT-62"><span class="linenos">62</span></a>    <span class="n">x</span> <span class="o">-=</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Spectrum.resample_NUDFT-63"><a href="#Spectrum.resample_NUDFT-63"><span class="linenos">63</span></a>
</span><span id="Spectrum.resample_NUDFT-64"><a href="#Spectrum.resample_NUDFT-64"><span class="linenos">64</span></a>    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xnew_bins</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-65"><a href="#Spectrum.resample_NUDFT-65"><span class="linenos">65</span></a>
</span><span id="Spectrum.resample_NUDFT-66"><a href="#Spectrum.resample_NUDFT-66"><span class="linenos">66</span></a>    <span class="n">Y_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">yi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">wi</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">yi</span><span class="p">,</span> <span class="n">wi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-67"><a href="#Spectrum.resample_NUDFT-67"><span class="linenos">67</span></a>
</span><span id="Spectrum.resample_NUDFT-68"><a href="#Spectrum.resample_NUDFT-68"><span class="linenos">68</span></a>    <span class="k">if</span> <span class="n">window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.resample_NUDFT-69"><a href="#Spectrum.resample_NUDFT-69"><span class="linenos">69</span></a>        <span class="n">window</span> <span class="o">=</span> <span class="s1">&#39;blackmanharris&#39;</span>
</span><span id="Spectrum.resample_NUDFT-70"><a href="#Spectrum.resample_NUDFT-70"><span class="linenos">70</span></a>
</span><span id="Spectrum.resample_NUDFT-71"><a href="#Spectrum.resample_NUDFT-71"><span class="linenos">71</span></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
</span><span id="Spectrum.resample_NUDFT-72"><a href="#Spectrum.resample_NUDFT-72"><span class="linenos">72</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">window</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_new</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))[</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_new</span><span class="p">):]</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.resample_NUDFT-73"><a href="#Spectrum.resample_NUDFT-73"><span class="linenos">73</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.resample_NUDFT-74"><a href="#Spectrum.resample_NUDFT-74"><span class="linenos">74</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_new</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_new</span><span class="p">):]</span>
</span><span id="Spectrum.resample_NUDFT-75"><a href="#Spectrum.resample_NUDFT-75"><span class="linenos">75</span></a>    <span class="n">Y_new</span> <span class="o">*=</span> <span class="n">h</span>
</span><span id="Spectrum.resample_NUDFT-76"><a href="#Spectrum.resample_NUDFT-76"><span class="linenos">76</span></a>
</span><span id="Spectrum.resample_NUDFT-77"><a href="#Spectrum.resample_NUDFT-77"><span class="linenos">77</span></a>    <span class="n">y_new</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">Y_new</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">xnew_bins</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-78"><a href="#Spectrum.resample_NUDFT-78"><span class="linenos">78</span></a>    <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
</span><span id="Spectrum.resample_NUDFT-79"><a href="#Spectrum.resample_NUDFT-79"><span class="linenos">79</span></a>        <span class="n">y_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_new</span><span class="p">)</span>
</span><span id="Spectrum.resample_NUDFT-80"><a href="#Spectrum.resample_NUDFT-80"><span class="linenos">80</span></a>        <span class="n">y_new</span> <span class="o">/=</span> <span class="n">y_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.resample_NUDFT-81"><a href="#Spectrum.resample_NUDFT-81"><span class="linenos">81</span></a>    <span class="k">return</span> <span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span>
</span></pre></div>


            <div class="docstring"><p>Resample the spectrum using Non-uniform discrete fourier transform.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with NUDFT and inverse FFT.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>window:</strong>  optional, Defaults to None.
The window to be used for lowpass filter. If None 'blackmanharris' is used.
If no low-pass filter is required, one can use <code>window=lambda x: [1]*len(x)</code>.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>(x_values, y_values)</p>
</blockquote>
</div>


                            </div>
                            <div id="Spectrum.resample_NUDFT_filter" class="classattr">
                                        <input id="Spectrum.resample_NUDFT_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">resample_NUDFT_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>,</span><span class="param">	<span class="n">xnew_bins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">window</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.resample_NUDFT_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.resample_NUDFT_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.resample_NUDFT_filter-84"><a href="#Spectrum.resample_NUDFT_filter-84"><span class="linenos"> 84</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.resample_NUDFT_filter-85"><a href="#Spectrum.resample_NUDFT_filter-85"><span class="linenos"> 85</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.resample_NUDFT_filter-86"><a href="#Spectrum.resample_NUDFT_filter-86"><span class="linenos"> 86</span></a><span class="k">def</span><span class="w"> </span><span class="nf">resample_NUDFT_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-87"><a href="#Spectrum.resample_NUDFT_filter-87"><span class="linenos"> 87</span></a>                          <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-88"><a href="#Spectrum.resample_NUDFT_filter-88"><span class="linenos"> 88</span></a>                          <span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span>
</span><span id="Spectrum.resample_NUDFT_filter-89"><a href="#Spectrum.resample_NUDFT_filter-89"><span class="linenos"> 89</span></a>                          <span class="n">xnew_bins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-90"><a href="#Spectrum.resample_NUDFT_filter-90"><span class="linenos"> 90</span></a>                          <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-91"><a href="#Spectrum.resample_NUDFT_filter-91"><span class="linenos"> 91</span></a>                          <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Spectrum.resample_NUDFT_filter-92"><a href="#Spectrum.resample_NUDFT_filter-92"><span class="linenos"> 92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_NUDFT_filter-93"><a href="#Spectrum.resample_NUDFT_filter-93"><span class="linenos"> 93</span></a><span class="sd">    Resample the spectrum using Non-uniform discrete fourier transform.</span>
</span><span id="Spectrum.resample_NUDFT_filter-94"><a href="#Spectrum.resample_NUDFT_filter-94"><span class="linenos"> 94</span></a>
</span><span id="Spectrum.resample_NUDFT_filter-95"><a href="#Spectrum.resample_NUDFT_filter-95"><span class="linenos"> 95</span></a><span class="sd">    The x-axis of the result will be uniform. The corresponding y-values</span>
</span><span id="Spectrum.resample_NUDFT_filter-96"><a href="#Spectrum.resample_NUDFT_filter-96"><span class="linenos"> 96</span></a><span class="sd">    will be calculated with NUDFT and inverse FFT.</span>
</span><span id="Spectrum.resample_NUDFT_filter-97"><a href="#Spectrum.resample_NUDFT_filter-97"><span class="linenos"> 97</span></a>
</span><span id="Spectrum.resample_NUDFT_filter-98"><a href="#Spectrum.resample_NUDFT_filter-98"><span class="linenos"> 98</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.resample_NUDFT_filter-99"><a href="#Spectrum.resample_NUDFT_filter-99"><span class="linenos"> 99</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.resample_NUDFT_filter-100"><a href="#Spectrum.resample_NUDFT_filter-100"><span class="linenos">100</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.resample_NUDFT_filter-101"><a href="#Spectrum.resample_NUDFT_filter-101"><span class="linenos">101</span></a><span class="sd">        x_range: optional. Defaults to (0, 4000).</span>
</span><span id="Spectrum.resample_NUDFT_filter-102"><a href="#Spectrum.resample_NUDFT_filter-102"><span class="linenos">102</span></a><span class="sd">            The x_range of the new spectrum.</span>
</span><span id="Spectrum.resample_NUDFT_filter-103"><a href="#Spectrum.resample_NUDFT_filter-103"><span class="linenos">103</span></a><span class="sd">        xnew_bins: optional. Defaults to 100.</span>
</span><span id="Spectrum.resample_NUDFT_filter-104"><a href="#Spectrum.resample_NUDFT_filter-104"><span class="linenos">104</span></a><span class="sd">            Number of bins of the new spectrum</span>
</span><span id="Spectrum.resample_NUDFT_filter-105"><a href="#Spectrum.resample_NUDFT_filter-105"><span class="linenos">105</span></a><span class="sd">        window: optional, Defaults to None.</span>
</span><span id="Spectrum.resample_NUDFT_filter-106"><a href="#Spectrum.resample_NUDFT_filter-106"><span class="linenos">106</span></a><span class="sd">            The window to be used for lowpass filter. If None &#39;blackmanharris&#39; is used.</span>
</span><span id="Spectrum.resample_NUDFT_filter-107"><a href="#Spectrum.resample_NUDFT_filter-107"><span class="linenos">107</span></a><span class="sd">            If no low-pass filter is required, one can use `window=lambda x: [1]*len(x)`.</span>
</span><span id="Spectrum.resample_NUDFT_filter-108"><a href="#Spectrum.resample_NUDFT_filter-108"><span class="linenos">108</span></a><span class="sd">        cumulative: optional. Defaults to False.</span>
</span><span id="Spectrum.resample_NUDFT_filter-109"><a href="#Spectrum.resample_NUDFT_filter-109"><span class="linenos">109</span></a><span class="sd">            If True, the resultant spectrum will be cumulative and normalized</span>
</span><span id="Spectrum.resample_NUDFT_filter-110"><a href="#Spectrum.resample_NUDFT_filter-110"><span class="linenos">110</span></a><span class="sd">            (in analogy with CDF).</span>
</span><span id="Spectrum.resample_NUDFT_filter-111"><a href="#Spectrum.resample_NUDFT_filter-111"><span class="linenos">111</span></a>
</span><span id="Spectrum.resample_NUDFT_filter-112"><a href="#Spectrum.resample_NUDFT_filter-112"><span class="linenos">112</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.resample_NUDFT_filter-113"><a href="#Spectrum.resample_NUDFT_filter-113"><span class="linenos">113</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_NUDFT_filter-114"><a href="#Spectrum.resample_NUDFT_filter-114"><span class="linenos">114</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">resample_NUDFT</span><span class="p">(</span><span class="n">old_spe</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-115"><a href="#Spectrum.resample_NUDFT_filter-115"><span class="linenos">115</span></a>                                          <span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-116"><a href="#Spectrum.resample_NUDFT_filter-116"><span class="linenos">116</span></a>                                          <span class="n">xnew_bins</span><span class="o">=</span><span class="n">xnew_bins</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-117"><a href="#Spectrum.resample_NUDFT_filter-117"><span class="linenos">117</span></a>                                          <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
</span><span id="Spectrum.resample_NUDFT_filter-118"><a href="#Spectrum.resample_NUDFT_filter-118"><span class="linenos">118</span></a>                                          <span class="n">cumulative</span><span class="o">=</span><span class="n">cumulative</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Resample the spectrum using Non-uniform discrete fourier transform.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with NUDFT and inverse FFT.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>window:</strong>  optional, Defaults to None.
The window to be used for lowpass filter. If None 'blackmanharris' is used.
If no low-pass filter is required, one can use <code>window=lambda x: [1]*len(x)</code>.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.resample_spline" class="classattr">
                                        <input id="Spectrum.resample_spline-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">resample_spline</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>,</span><span class="param">	<span class="n">xnew_bins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">spline</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pchip&#39;</span><span class="p">,</span> <span class="s1">&#39;akima&#39;</span><span class="p">,</span> <span class="s1">&#39;makima&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic_spline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pchip&#39;</span>,</span><span class="param">	<span class="n">interp_kw_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.resample_spline-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.resample_spline"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.resample_spline-121"><a href="#Spectrum.resample_spline-121"><span class="linenos">121</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.resample_spline-122"><a href="#Spectrum.resample_spline-122"><span class="linenos">122</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.resample_spline-123"><a href="#Spectrum.resample_spline-123"><span class="linenos">123</span></a><span class="k">def</span><span class="w"> </span><span class="nf">resample_spline</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline-124"><a href="#Spectrum.resample_spline-124"><span class="linenos">124</span></a>                    <span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span>
</span><span id="Spectrum.resample_spline-125"><a href="#Spectrum.resample_spline-125"><span class="linenos">125</span></a>                    <span class="n">xnew_bins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline-126"><a href="#Spectrum.resample_spline-126"><span class="linenos">126</span></a>                    <span class="n">spline</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pchip&#39;</span><span class="p">,</span> <span class="s1">&#39;akima&#39;</span><span class="p">,</span> <span class="s1">&#39;makima&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic_spline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pchip&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline-127"><a href="#Spectrum.resample_spline-127"><span class="linenos">127</span></a>                    <span class="n">interp_kw_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline-128"><a href="#Spectrum.resample_spline-128"><span class="linenos">128</span></a>                    <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Spectrum.resample_spline-129"><a href="#Spectrum.resample_spline-129"><span class="linenos">129</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_spline-130"><a href="#Spectrum.resample_spline-130"><span class="linenos">130</span></a><span class="sd">    Resample the spectrum using spline interpolation.</span>
</span><span id="Spectrum.resample_spline-131"><a href="#Spectrum.resample_spline-131"><span class="linenos">131</span></a>
</span><span id="Spectrum.resample_spline-132"><a href="#Spectrum.resample_spline-132"><span class="linenos">132</span></a><span class="sd">    The x-axis of the result will be uniform. The corresponding y-values</span>
</span><span id="Spectrum.resample_spline-133"><a href="#Spectrum.resample_spline-133"><span class="linenos">133</span></a><span class="sd">    will be calculated with spline interpolation.</span>
</span><span id="Spectrum.resample_spline-134"><a href="#Spectrum.resample_spline-134"><span class="linenos">134</span></a>
</span><span id="Spectrum.resample_spline-135"><a href="#Spectrum.resample_spline-135"><span class="linenos">135</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.resample_spline-136"><a href="#Spectrum.resample_spline-136"><span class="linenos">136</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.resample_spline-137"><a href="#Spectrum.resample_spline-137"><span class="linenos">137</span></a><span class="sd">        x_range: optional. Defaults to (0, 4000).</span>
</span><span id="Spectrum.resample_spline-138"><a href="#Spectrum.resample_spline-138"><span class="linenos">138</span></a><span class="sd">            The x_range of the new spectrum.</span>
</span><span id="Spectrum.resample_spline-139"><a href="#Spectrum.resample_spline-139"><span class="linenos">139</span></a><span class="sd">        xnew_bins: optional. Defaults to 100.</span>
</span><span id="Spectrum.resample_spline-140"><a href="#Spectrum.resample_spline-140"><span class="linenos">140</span></a><span class="sd">            Number of bins of the new spectrum</span>
</span><span id="Spectrum.resample_spline-141"><a href="#Spectrum.resample_spline-141"><span class="linenos">141</span></a><span class="sd">        spline: optional, Defaults to &#39;pchip&#39;.</span>
</span><span id="Spectrum.resample_spline-142"><a href="#Spectrum.resample_spline-142"><span class="linenos">142</span></a><span class="sd">            Name of the spline funcion to be used.</span>
</span><span id="Spectrum.resample_spline-143"><a href="#Spectrum.resample_spline-143"><span class="linenos">143</span></a><span class="sd">        cumulative: optional. Defaults to False.</span>
</span><span id="Spectrum.resample_spline-144"><a href="#Spectrum.resample_spline-144"><span class="linenos">144</span></a><span class="sd">            If True, the resultant spectrum will be cumulative and normalized</span>
</span><span id="Spectrum.resample_spline-145"><a href="#Spectrum.resample_spline-145"><span class="linenos">145</span></a><span class="sd">            (in analogy with CDF).</span>
</span><span id="Spectrum.resample_spline-146"><a href="#Spectrum.resample_spline-146"><span class="linenos">146</span></a>
</span><span id="Spectrum.resample_spline-147"><a href="#Spectrum.resample_spline-147"><span class="linenos">147</span></a><span class="sd">    Returns:</span>
</span><span id="Spectrum.resample_spline-148"><a href="#Spectrum.resample_spline-148"><span class="linenos">148</span></a><span class="sd">        (x_values, y_values)</span>
</span><span id="Spectrum.resample_spline-149"><a href="#Spectrum.resample_spline-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_spline-150"><a href="#Spectrum.resample_spline-150"><span class="linenos">150</span></a>
</span><span id="Spectrum.resample_spline-151"><a href="#Spectrum.resample_spline-151"><span class="linenos">151</span></a>    <span class="n">kw_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Spectrum.resample_spline-152"><a href="#Spectrum.resample_spline-152"><span class="linenos">152</span></a>    <span class="k">if</span> <span class="n">spline</span> <span class="o">==</span> <span class="s1">&#39;pchip&#39;</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-153"><a href="#Spectrum.resample_spline-153"><span class="linenos">153</span></a>        <span class="n">spline_fn</span> <span class="o">=</span> <span class="n">PchipInterpolator</span>
</span><span id="Spectrum.resample_spline-154"><a href="#Spectrum.resample_spline-154"><span class="linenos">154</span></a>        <span class="n">kw_args</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Spectrum.resample_spline-155"><a href="#Spectrum.resample_spline-155"><span class="linenos">155</span></a>    <span class="k">elif</span> <span class="n">spline</span> <span class="o">==</span> <span class="s1">&#39;akima&#39;</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-156"><a href="#Spectrum.resample_spline-156"><span class="linenos">156</span></a>        <span class="n">spline_fn</span> <span class="o">=</span> <span class="n">Akima1DInterpolator</span>
</span><span id="Spectrum.resample_spline-157"><a href="#Spectrum.resample_spline-157"><span class="linenos">157</span></a>    <span class="k">elif</span> <span class="n">spline</span> <span class="o">==</span> <span class="s1">&#39;makima&#39;</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-158"><a href="#Spectrum.resample_spline-158"><span class="linenos">158</span></a>        <span class="n">spline_fn</span> <span class="o">=</span> <span class="n">Akima1DInterpolator</span>
</span><span id="Spectrum.resample_spline-159"><a href="#Spectrum.resample_spline-159"><span class="linenos">159</span></a>        <span class="n">kw_args</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;makima&#39;</span>
</span><span id="Spectrum.resample_spline-160"><a href="#Spectrum.resample_spline-160"><span class="linenos">160</span></a>    <span class="k">elif</span> <span class="n">spline</span> <span class="o">==</span> <span class="s1">&#39;cubic_spline&#39;</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-161"><a href="#Spectrum.resample_spline-161"><span class="linenos">161</span></a>        <span class="n">spline_fn</span> <span class="o">=</span> <span class="n">CubicSpline</span>
</span><span id="Spectrum.resample_spline-162"><a href="#Spectrum.resample_spline-162"><span class="linenos">162</span></a>        <span class="n">kw_args</span><span class="p">[</span><span class="s1">&#39;bc_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;natural&#39;</span>
</span><span id="Spectrum.resample_spline-163"><a href="#Spectrum.resample_spline-163"><span class="linenos">163</span></a>        <span class="n">kw_args</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Spectrum.resample_spline-164"><a href="#Spectrum.resample_spline-164"><span class="linenos">164</span></a>
</span><span id="Spectrum.resample_spline-165"><a href="#Spectrum.resample_spline-165"><span class="linenos">165</span></a>    <span class="k">if</span> <span class="n">interp_kw_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-166"><a href="#Spectrum.resample_spline-166"><span class="linenos">166</span></a>        <span class="n">kw_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">interp_kw_args</span><span class="p">)</span>
</span><span id="Spectrum.resample_spline-167"><a href="#Spectrum.resample_spline-167"><span class="linenos">167</span></a>
</span><span id="Spectrum.resample_spline-168"><a href="#Spectrum.resample_spline-168"><span class="linenos">168</span></a>    <span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xnew_bins</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.resample_spline-169"><a href="#Spectrum.resample_spline-169"><span class="linenos">169</span></a>    <span class="n">y_new</span> <span class="o">=</span> <span class="n">spline_fn</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)(</span><span class="n">x_new</span><span class="p">)</span>
</span><span id="Spectrum.resample_spline-170"><a href="#Spectrum.resample_spline-170"><span class="linenos">170</span></a>
</span><span id="Spectrum.resample_spline-171"><a href="#Spectrum.resample_spline-171"><span class="linenos">171</span></a>    <span class="n">y_new</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y_new</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.resample_spline-172"><a href="#Spectrum.resample_spline-172"><span class="linenos">172</span></a>    <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
</span><span id="Spectrum.resample_spline-173"><a href="#Spectrum.resample_spline-173"><span class="linenos">173</span></a>        <span class="n">y_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_new</span><span class="p">)</span>
</span><span id="Spectrum.resample_spline-174"><a href="#Spectrum.resample_spline-174"><span class="linenos">174</span></a>        <span class="n">y_new</span> <span class="o">/=</span> <span class="n">y_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.resample_spline-175"><a href="#Spectrum.resample_spline-175"><span class="linenos">175</span></a>
</span><span id="Spectrum.resample_spline-176"><a href="#Spectrum.resample_spline-176"><span class="linenos">176</span></a>    <span class="k">return</span> <span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span>
</span></pre></div>


            <div class="docstring"><p>Resample the spectrum using spline interpolation.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with spline interpolation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>spline:</strong>  optional, Defaults to 'pchip'.
Name of the spline funcion to be used.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>(x_values, y_values)</p>
</blockquote>
</div>


                            </div>
                            <div id="Spectrum.resample_spline_filter" class="classattr">
                                        <input id="Spectrum.resample_spline_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">resample_spline_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>,</span><span class="param">	<span class="n">xnew_bins</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">spline</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pchip&#39;</span><span class="p">,</span> <span class="s1">&#39;akima&#39;</span><span class="p">,</span> <span class="s1">&#39;makima&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic_spline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pchip&#39;</span>,</span><span class="param">	<span class="n">interp_kw_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.resample_spline_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.resample_spline_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.resample_spline_filter-179"><a href="#Spectrum.resample_spline_filter-179"><span class="linenos">179</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.resample_spline_filter-180"><a href="#Spectrum.resample_spline_filter-180"><span class="linenos">180</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.resample_spline_filter-181"><a href="#Spectrum.resample_spline_filter-181"><span class="linenos">181</span></a><span class="k">def</span><span class="w"> </span><span class="nf">resample_spline_filter</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-182"><a href="#Spectrum.resample_spline_filter-182"><span class="linenos">182</span></a>                           <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-183"><a href="#Spectrum.resample_spline_filter-183"><span class="linenos">183</span></a>                           <span class="n">x_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span>
</span><span id="Spectrum.resample_spline_filter-184"><a href="#Spectrum.resample_spline_filter-184"><span class="linenos">184</span></a>                           <span class="n">xnew_bins</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-185"><a href="#Spectrum.resample_spline_filter-185"><span class="linenos">185</span></a>                           <span class="n">spline</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pchip&#39;</span><span class="p">,</span> <span class="s1">&#39;akima&#39;</span><span class="p">,</span> <span class="s1">&#39;makima&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic_spline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pchip&#39;</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-186"><a href="#Spectrum.resample_spline_filter-186"><span class="linenos">186</span></a>                           <span class="n">interp_kw_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-187"><a href="#Spectrum.resample_spline_filter-187"><span class="linenos">187</span></a>                           <span class="n">cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Spectrum.resample_spline_filter-188"><a href="#Spectrum.resample_spline_filter-188"><span class="linenos">188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_spline_filter-189"><a href="#Spectrum.resample_spline_filter-189"><span class="linenos">189</span></a><span class="sd">    Resample the spectrum using spline interpolation.</span>
</span><span id="Spectrum.resample_spline_filter-190"><a href="#Spectrum.resample_spline_filter-190"><span class="linenos">190</span></a>
</span><span id="Spectrum.resample_spline_filter-191"><a href="#Spectrum.resample_spline_filter-191"><span class="linenos">191</span></a><span class="sd">    The x-axis of the result will be uniform. The corresponding y-values</span>
</span><span id="Spectrum.resample_spline_filter-192"><a href="#Spectrum.resample_spline_filter-192"><span class="linenos">192</span></a><span class="sd">    will be calculated with spline interpolation.</span>
</span><span id="Spectrum.resample_spline_filter-193"><a href="#Spectrum.resample_spline_filter-193"><span class="linenos">193</span></a>
</span><span id="Spectrum.resample_spline_filter-194"><a href="#Spectrum.resample_spline_filter-194"><span class="linenos">194</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.resample_spline_filter-195"><a href="#Spectrum.resample_spline_filter-195"><span class="linenos">195</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.resample_spline_filter-196"><a href="#Spectrum.resample_spline_filter-196"><span class="linenos">196</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.resample_spline_filter-197"><a href="#Spectrum.resample_spline_filter-197"><span class="linenos">197</span></a><span class="sd">        x_range: optional. Defaults to (0, 4000).</span>
</span><span id="Spectrum.resample_spline_filter-198"><a href="#Spectrum.resample_spline_filter-198"><span class="linenos">198</span></a><span class="sd">            The x_range of the new spectrum.</span>
</span><span id="Spectrum.resample_spline_filter-199"><a href="#Spectrum.resample_spline_filter-199"><span class="linenos">199</span></a><span class="sd">        xnew_bins: optional. Defaults to 100.</span>
</span><span id="Spectrum.resample_spline_filter-200"><a href="#Spectrum.resample_spline_filter-200"><span class="linenos">200</span></a><span class="sd">            Number of bins of the new spectrum</span>
</span><span id="Spectrum.resample_spline_filter-201"><a href="#Spectrum.resample_spline_filter-201"><span class="linenos">201</span></a><span class="sd">        spline: optional, Defaults to &#39;pchip&#39;.</span>
</span><span id="Spectrum.resample_spline_filter-202"><a href="#Spectrum.resample_spline_filter-202"><span class="linenos">202</span></a><span class="sd">            Name of the spline funcion to be used.</span>
</span><span id="Spectrum.resample_spline_filter-203"><a href="#Spectrum.resample_spline_filter-203"><span class="linenos">203</span></a><span class="sd">        cumulative: optional. Defaults to False.</span>
</span><span id="Spectrum.resample_spline_filter-204"><a href="#Spectrum.resample_spline_filter-204"><span class="linenos">204</span></a><span class="sd">            If True, the resultant spectrum will be cumulative and normalized</span>
</span><span id="Spectrum.resample_spline_filter-205"><a href="#Spectrum.resample_spline_filter-205"><span class="linenos">205</span></a><span class="sd">            (in analogy with CDF).</span>
</span><span id="Spectrum.resample_spline_filter-206"><a href="#Spectrum.resample_spline_filter-206"><span class="linenos">206</span></a>
</span><span id="Spectrum.resample_spline_filter-207"><a href="#Spectrum.resample_spline_filter-207"><span class="linenos">207</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.resample_spline_filter-208"><a href="#Spectrum.resample_spline_filter-208"><span class="linenos">208</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.resample_spline_filter-209"><a href="#Spectrum.resample_spline_filter-209"><span class="linenos">209</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">resample_spline</span><span class="p">(</span><span class="n">old_spe</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-210"><a href="#Spectrum.resample_spline_filter-210"><span class="linenos">210</span></a>                                           <span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-211"><a href="#Spectrum.resample_spline_filter-211"><span class="linenos">211</span></a>                                           <span class="n">xnew_bins</span><span class="o">=</span><span class="n">xnew_bins</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-212"><a href="#Spectrum.resample_spline_filter-212"><span class="linenos">212</span></a>                                           <span class="n">spline</span><span class="o">=</span><span class="n">spline</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-213"><a href="#Spectrum.resample_spline_filter-213"><span class="linenos">213</span></a>                                           <span class="n">interp_kw_args</span><span class="o">=</span><span class="n">interp_kw_args</span><span class="p">,</span>
</span><span id="Spectrum.resample_spline_filter-214"><a href="#Spectrum.resample_spline_filter-214"><span class="linenos">214</span></a>                                           <span class="n">cumulative</span><span class="o">=</span><span class="n">cumulative</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Resample the spectrum using spline interpolation.</p>

<p>The x-axis of the result will be uniform. The corresponding y-values
will be calculated with spline interpolation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>x_range:</strong>  optional. Defaults to (0, 4000).
The x_range of the new spectrum.</li>
<li><strong>xnew_bins:</strong>  optional. Defaults to 100.
Number of bins of the new spectrum</li>
<li><strong>spline:</strong>  optional, Defaults to 'pchip'.
Name of the spline funcion to be used.</li>
<li><strong>cumulative:</strong>  optional. Defaults to False.
If True, the resultant spectrum will be cumulative and normalized
(in analogy with CDF).</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.add_gaussian_noise" class="classattr">
                                        <input id="Spectrum.add_gaussian_noise-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">add_gaussian_noise</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">sigma</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>,</span><span class="param">	<span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.add_gaussian_noise-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.add_gaussian_noise"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.add_gaussian_noise-29"><a href="#Spectrum.add_gaussian_noise-29"><span class="linenos">29</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.add_gaussian_noise-30"><a href="#Spectrum.add_gaussian_noise-30"><span class="linenos">30</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.add_gaussian_noise-31"><a href="#Spectrum.add_gaussian_noise-31"><span class="linenos">31</span></a><span class="k">def</span><span class="w"> </span><span class="nf">add_gaussian_noise</span><span class="p">(</span>
</span><span id="Spectrum.add_gaussian_noise-32"><a href="#Spectrum.add_gaussian_noise-32"><span class="linenos">32</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise-33"><a href="#Spectrum.add_gaussian_noise-33"><span class="linenos">33</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise-34"><a href="#Spectrum.add_gaussian_noise-34"><span class="linenos">34</span></a>        <span class="n">sigma</span><span class="p">:</span> <span class="n">PositiveFloat</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise-35"><a href="#Spectrum.add_gaussian_noise-35"><span class="linenos">35</span></a>        <span class="c1"># validation for rng_seed is removed because</span>
</span><span id="Spectrum.add_gaussian_noise-36"><a href="#Spectrum.add_gaussian_noise-36"><span class="linenos">36</span></a>        <span class="c1"># it makes in-place modification impossible</span>
</span><span id="Spectrum.add_gaussian_noise-37"><a href="#Spectrum.add_gaussian_noise-37"><span class="linenos">37</span></a>        <span class="n">rng_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Spectrum.add_gaussian_noise-38"><a href="#Spectrum.add_gaussian_noise-38"><span class="linenos">38</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.add_gaussian_noise-39"><a href="#Spectrum.add_gaussian_noise-39"><span class="linenos">39</span></a><span class="sd">    Add gaussian noise to the spectrum.</span>
</span><span id="Spectrum.add_gaussian_noise-40"><a href="#Spectrum.add_gaussian_noise-40"><span class="linenos">40</span></a>
</span><span id="Spectrum.add_gaussian_noise-41"><a href="#Spectrum.add_gaussian_noise-41"><span class="linenos">41</span></a><span class="sd">    Random number i.i.d. $N(0, \sigma)$ is added to every sample</span>
</span><span id="Spectrum.add_gaussian_noise-42"><a href="#Spectrum.add_gaussian_noise-42"><span class="linenos">42</span></a>
</span><span id="Spectrum.add_gaussian_noise-43"><a href="#Spectrum.add_gaussian_noise-43"><span class="linenos">43</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.add_gaussian_noise-44"><a href="#Spectrum.add_gaussian_noise-44"><span class="linenos">44</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.add_gaussian_noise-45"><a href="#Spectrum.add_gaussian_noise-45"><span class="linenos">45</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.add_gaussian_noise-46"><a href="#Spectrum.add_gaussian_noise-46"><span class="linenos">46</span></a><span class="sd">        sigma:</span>
</span><span id="Spectrum.add_gaussian_noise-47"><a href="#Spectrum.add_gaussian_noise-47"><span class="linenos">47</span></a><span class="sd">            Sigma of the gaussian noise.</span>
</span><span id="Spectrum.add_gaussian_noise-48"><a href="#Spectrum.add_gaussian_noise-48"><span class="linenos">48</span></a><span class="sd">        rng_seed:</span>
</span><span id="Spectrum.add_gaussian_noise-49"><a href="#Spectrum.add_gaussian_noise-49"><span class="linenos">49</span></a><span class="sd">            `int` or rng state, optional, seed for the random generator.</span>
</span><span id="Spectrum.add_gaussian_noise-50"><a href="#Spectrum.add_gaussian_noise-50"><span class="linenos">50</span></a><span class="sd">            If a state is provided, it is updated in-place.</span>
</span><span id="Spectrum.add_gaussian_noise-51"><a href="#Spectrum.add_gaussian_noise-51"><span class="linenos">51</span></a>
</span><span id="Spectrum.add_gaussian_noise-52"><a href="#Spectrum.add_gaussian_noise-52"><span class="linenos">52</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.add_gaussian_noise-53"><a href="#Spectrum.add_gaussian_noise-53"><span class="linenos">53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.add_gaussian_noise-54"><a href="#Spectrum.add_gaussian_noise-54"><span class="linenos">54</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">generate_add_gaussian_noise</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise-55"><a href="#Spectrum.add_gaussian_noise-55"><span class="linenos">55</span></a>                                            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="Spectrum.add_gaussian_noise-56"><a href="#Spectrum.add_gaussian_noise-56"><span class="linenos">56</span></a>                                            <span class="n">rng_seed</span><span class="o">=</span><span class="n">rng_seed</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add gaussian noise to the spectrum.</p>

<p>Random number i.i.d. $N(0, \sigma)$ is added to every sample</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>sigma:</strong>  Sigma of the gaussian noise.</li>
<li><strong>rng_seed:</strong>  <code>int</code> or rng state, optional, seed for the random generator.
If a state is provided, it is updated in-place.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.derivative_sharpening" class="classattr">
                                        <input id="Spectrum.derivative_sharpening-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">derivative_sharpening</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">filter_fraction</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span>,</span><span class="param">	<span class="n">sig_width</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>,</span><span class="param">	<span class="n">der2_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">der4_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.derivative_sharpening-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.derivative_sharpening"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.derivative_sharpening-14"><a href="#Spectrum.derivative_sharpening-14"><span class="linenos">14</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.derivative_sharpening-15"><a href="#Spectrum.derivative_sharpening-15"><span class="linenos">15</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.derivative_sharpening-16"><a href="#Spectrum.derivative_sharpening-16"><span class="linenos">16</span></a><span class="k">def</span><span class="w"> </span><span class="nf">derivative_sharpening</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.derivative_sharpening-17"><a href="#Spectrum.derivative_sharpening-17"><span class="linenos">17</span></a>                          <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.derivative_sharpening-18"><a href="#Spectrum.derivative_sharpening-18"><span class="linenos">18</span></a>                          <span class="n">filter_fraction</span><span class="p">:</span> <span class="n">confloat</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">.6</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.derivative_sharpening-19"><a href="#Spectrum.derivative_sharpening-19"><span class="linenos">19</span></a>                          <span class="n">sig_width</span><span class="p">:</span> <span class="n">confloat</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">.25</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.derivative_sharpening-20"><a href="#Spectrum.derivative_sharpening-20"><span class="linenos">20</span></a>                          <span class="n">der2_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Spectrum.derivative_sharpening-21"><a href="#Spectrum.derivative_sharpening-21"><span class="linenos">21</span></a>                          <span class="n">der4_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">.1</span>
</span><span id="Spectrum.derivative_sharpening-22"><a href="#Spectrum.derivative_sharpening-22"><span class="linenos">22</span></a>                          <span class="p">):</span>
</span><span id="Spectrum.derivative_sharpening-23"><a href="#Spectrum.derivative_sharpening-23"><span class="linenos">23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.derivative_sharpening-24"><a href="#Spectrum.derivative_sharpening-24"><span class="linenos">24</span></a><span class="sd">    Derivative-based sharpening.</span>
</span><span id="Spectrum.derivative_sharpening-25"><a href="#Spectrum.derivative_sharpening-25"><span class="linenos">25</span></a>
</span><span id="Spectrum.derivative_sharpening-26"><a href="#Spectrum.derivative_sharpening-26"><span class="linenos">26</span></a><span class="sd">    Sharpen the spectrum subtracting second derivative and add fourth derivative.</span>
</span><span id="Spectrum.derivative_sharpening-27"><a href="#Spectrum.derivative_sharpening-27"><span class="linenos">27</span></a>
</span><span id="Spectrum.derivative_sharpening-28"><a href="#Spectrum.derivative_sharpening-28"><span class="linenos">28</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.derivative_sharpening-29"><a href="#Spectrum.derivative_sharpening-29"><span class="linenos">29</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.derivative_sharpening-30"><a href="#Spectrum.derivative_sharpening-30"><span class="linenos">30</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.derivative_sharpening-31"><a href="#Spectrum.derivative_sharpening-31"><span class="linenos">31</span></a><span class="sd">        filter_fraction `float` in (0; 1]: Default is 0.6</span>
</span><span id="Spectrum.derivative_sharpening-32"><a href="#Spectrum.derivative_sharpening-32"><span class="linenos">32</span></a><span class="sd">            Depth of filtration</span>
</span><span id="Spectrum.derivative_sharpening-33"><a href="#Spectrum.derivative_sharpening-33"><span class="linenos">33</span></a><span class="sd">        signal_width: The width of features to be enhanced in sample count</span>
</span><span id="Spectrum.derivative_sharpening-34"><a href="#Spectrum.derivative_sharpening-34"><span class="linenos">34</span></a><span class="sd">        der2_factor: Second derivative scaling factor</span>
</span><span id="Spectrum.derivative_sharpening-35"><a href="#Spectrum.derivative_sharpening-35"><span class="linenos">35</span></a><span class="sd">        der4_factor: Fourth derivative scaling factor</span>
</span><span id="Spectrum.derivative_sharpening-36"><a href="#Spectrum.derivative_sharpening-36"><span class="linenos">36</span></a>
</span><span id="Spectrum.derivative_sharpening-37"><a href="#Spectrum.derivative_sharpening-37"><span class="linenos">37</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.derivative_sharpening-38"><a href="#Spectrum.derivative_sharpening-38"><span class="linenos">38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.derivative_sharpening-39"><a href="#Spectrum.derivative_sharpening-39"><span class="linenos">39</span></a>    <span class="n">leny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Spectrum.derivative_sharpening-40"><a href="#Spectrum.derivative_sharpening-40"><span class="linenos">40</span></a>    <span class="n">Y</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">leny</span><span class="p">)</span>
</span><span id="Spectrum.derivative_sharpening-41"><a href="#Spectrum.derivative_sharpening-41"><span class="linenos">41</span></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">*</span><span class="n">filter_fraction</span><span class="p">))</span>
</span><span id="Spectrum.derivative_sharpening-42"><a href="#Spectrum.derivative_sharpening-42"><span class="linenos">42</span></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="o">//</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Spectrum.derivative_sharpening-43"><a href="#Spectrum.derivative_sharpening-43"><span class="linenos">43</span></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))))</span>
</span><span id="Spectrum.derivative_sharpening-44"><a href="#Spectrum.derivative_sharpening-44"><span class="linenos">44</span></a>    <span class="n">der</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
</span><span id="Spectrum.derivative_sharpening-45"><a href="#Spectrum.derivative_sharpening-45"><span class="linenos">45</span></a>    <span class="n">der</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">der</span><span class="o">/</span><span class="n">der</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.derivative_sharpening-46"><a href="#Spectrum.derivative_sharpening-46"><span class="linenos">46</span></a>    <span class="n">Y</span> <span class="o">*=</span> <span class="n">h</span>
</span><span id="Spectrum.derivative_sharpening-47"><a href="#Spectrum.derivative_sharpening-47"><span class="linenos">47</span></a>    <span class="n">Y2</span> <span class="o">=</span> <span class="n">Y</span><span class="o">*</span><span class="n">der</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Spectrum.derivative_sharpening-48"><a href="#Spectrum.derivative_sharpening-48"><span class="linenos">48</span></a>    <span class="n">Y4</span> <span class="o">=</span> <span class="n">Y2</span><span class="o">*</span><span class="n">der</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Spectrum.derivative_sharpening-49"><a href="#Spectrum.derivative_sharpening-49"><span class="linenos">49</span></a>    <span class="n">y0</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">leny</span><span class="p">)</span>
</span><span id="Spectrum.derivative_sharpening-50"><a href="#Spectrum.derivative_sharpening-50"><span class="linenos">50</span></a>    <span class="n">y2</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">Y2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">leny</span><span class="p">)</span>
</span><span id="Spectrum.derivative_sharpening-51"><a href="#Spectrum.derivative_sharpening-51"><span class="linenos">51</span></a>    <span class="n">y4</span> <span class="o">=</span> <span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">Y4</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">leny</span><span class="p">)</span>
</span><span id="Spectrum.derivative_sharpening-52"><a href="#Spectrum.derivative_sharpening-52"><span class="linenos">52</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">y2</span><span class="o">/</span><span class="n">sig_width</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">der2_factor</span> <span class="o">+</span> <span class="n">y4</span><span class="o">/</span><span class="n">sig_width</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">der4_factor</span>
</span></pre></div>


            <div class="docstring"><p>Derivative-based sharpening.</p>

<p>Sharpen the spectrum subtracting second derivative and add fourth derivative.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>filter_fraction <code>float</code> in (0; 1]:</strong>  Default is 0.6
Depth of filtration</li>
<li><strong>signal_width:</strong>  The width of features to be enhanced in sample count</li>
<li><strong>der2_factor:</strong>  Second derivative scaling factor</li>
<li><strong>der4_factor:</strong>  Fourth derivative scaling factor</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.hht_sharpening" class="classattr">
                                        <input id="Spectrum.hht_sharpening-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">hht_sharpening</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">movmin</span><span class="o">=</span><span class="mi">100</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.hht_sharpening-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.hht_sharpening"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.hht_sharpening-55"><a href="#Spectrum.hht_sharpening-55"><span class="linenos">55</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.hht_sharpening-56"><a href="#Spectrum.hht_sharpening-56"><span class="linenos">56</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.hht_sharpening-57"><a href="#Spectrum.hht_sharpening-57"><span class="linenos">57</span></a><span class="k">def</span><span class="w"> </span><span class="nf">hht_sharpening</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.hht_sharpening-58"><a href="#Spectrum.hht_sharpening-58"><span class="linenos">58</span></a>                   <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.hht_sharpening-59"><a href="#Spectrum.hht_sharpening-59"><span class="linenos">59</span></a>                   <span class="n">movmin</span><span class="o">=</span><span class="mi">100</span>
</span><span id="Spectrum.hht_sharpening-60"><a href="#Spectrum.hht_sharpening-60"><span class="linenos">60</span></a>                   <span class="p">):</span>
</span><span id="Spectrum.hht_sharpening-61"><a href="#Spectrum.hht_sharpening-61"><span class="linenos">61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.hht_sharpening-62"><a href="#Spectrum.hht_sharpening-62"><span class="linenos">62</span></a><span class="sd">    Hilbert-Huang based sharpening.</span>
</span><span id="Spectrum.hht_sharpening-63"><a href="#Spectrum.hht_sharpening-63"><span class="linenos">63</span></a>
</span><span id="Spectrum.hht_sharpening-64"><a href="#Spectrum.hht_sharpening-64"><span class="linenos">64</span></a><span class="sd">    In order to reduce the overshooting, moving minimum is subtracted from the result</span>
</span><span id="Spectrum.hht_sharpening-65"><a href="#Spectrum.hht_sharpening-65"><span class="linenos">65</span></a>
</span><span id="Spectrum.hht_sharpening-66"><a href="#Spectrum.hht_sharpening-66"><span class="linenos">66</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.hht_sharpening-67"><a href="#Spectrum.hht_sharpening-67"><span class="linenos">67</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.hht_sharpening-68"><a href="#Spectrum.hht_sharpening-68"><span class="linenos">68</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.hht_sharpening-69"><a href="#Spectrum.hht_sharpening-69"><span class="linenos">69</span></a><span class="sd">        movmin: optional. Default is 100</span>
</span><span id="Spectrum.hht_sharpening-70"><a href="#Spectrum.hht_sharpening-70"><span class="linenos">70</span></a><span class="sd">            Window size for moving minimum</span>
</span><span id="Spectrum.hht_sharpening-71"><a href="#Spectrum.hht_sharpening-71"><span class="linenos">71</span></a>
</span><span id="Spectrum.hht_sharpening-72"><a href="#Spectrum.hht_sharpening-72"><span class="linenos">72</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.hht_sharpening-73"><a href="#Spectrum.hht_sharpening-73"><span class="linenos">73</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.hht_sharpening-74"><a href="#Spectrum.hht_sharpening-74"><span class="linenos">74</span></a>    <span class="n">imfs</span> <span class="o">=</span> <span class="n">emd</span><span class="o">.</span><span class="n">sift</span><span class="o">.</span><span class="n">sift</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Spectrum.hht_sharpening-75"><a href="#Spectrum.hht_sharpening-75"><span class="linenos">75</span></a>    <span class="n">freq_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.hht_sharpening-76"><a href="#Spectrum.hht_sharpening-76"><span class="linenos">76</span></a>    <span class="k">for</span> <span class="n">ansig</span> <span class="ow">in</span> <span class="n">signal</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="n">imfs</span><span class="p">):</span>
</span><span id="Spectrum.hht_sharpening-77"><a href="#Spectrum.hht_sharpening-77"><span class="linenos">77</span></a>        <span class="n">freq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">emd</span><span class="o">.</span><span class="n">spectra</span><span class="o">.</span><span class="n">freq_from_phase</span><span class="p">(</span>
</span><span id="Spectrum.hht_sharpening-78"><a href="#Spectrum.hht_sharpening-78"><span class="linenos">78</span></a>            <span class="n">emd</span><span class="o">.</span><span class="n">spectra</span><span class="o">.</span><span class="n">phase_from_complex_signal</span><span class="p">(</span><span class="n">ansig</span><span class="p">,</span> <span class="n">ret_phase</span><span class="o">=</span><span class="s1">&#39;unwrapped&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Spectrum.hht_sharpening-79"><a href="#Spectrum.hht_sharpening-79"><span class="linenos">79</span></a>    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">freq_list</span><span class="p">)</span>
</span><span id="Spectrum.hht_sharpening-80"><a href="#Spectrum.hht_sharpening-80"><span class="linenos">80</span></a>    <span class="n">freq</span><span class="p">[</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.hht_sharpening-81"><a href="#Spectrum.hht_sharpening-81"><span class="linenos">81</span></a>    <span class="n">freq</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">freq</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.hht_sharpening-82"><a href="#Spectrum.hht_sharpening-82"><span class="linenos">82</span></a>    <span class="n">imfsall</span> <span class="o">=</span> <span class="n">imfs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="Spectrum.hht_sharpening-83"><a href="#Spectrum.hht_sharpening-83"><span class="linenos">83</span></a>    <span class="n">imfsall</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">imfsall</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.hht_sharpening-84"><a href="#Spectrum.hht_sharpening-84"><span class="linenos">84</span></a>    <span class="n">imfsall</span><span class="p">[</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mf">.3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Spectrum.hht_sharpening-85"><a href="#Spectrum.hht_sharpening-85"><span class="linenos">85</span></a>    <span class="n">imfsall</span> <span class="o">*=</span> <span class="n">freq</span><span class="o">**</span><span class="mf">.5</span>
</span><span id="Spectrum.hht_sharpening-86"><a href="#Spectrum.hht_sharpening-86"><span class="linenos">86</span></a>    <span class="n">ynew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">imfsall</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Spectrum.hht_sharpening-87"><a href="#Spectrum.hht_sharpening-87"><span class="linenos">87</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">ynew</span>
</span><span id="Spectrum.hht_sharpening-88"><a href="#Spectrum.hht_sharpening-88"><span class="linenos">88</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">new_spe</span><span class="o">.</span><span class="n">subtract_moving_minimum</span><span class="p">(</span><span class="n">movmin</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">y</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.hht_sharpening-89"><a href="#Spectrum.hht_sharpening-89"><span class="linenos">89</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Hilbert-Huang based sharpening.</p>

<p>In order to reduce the overshooting, moving minimum is subtracted from the result</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>movmin:</strong>  optional. Default is 100
Window size for moving minimum</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.hht_sharpening_chain" class="classattr">
                                        <input id="Spectrum.hht_sharpening_chain-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">hht_sharpening_chain</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">movmin</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.hht_sharpening_chain-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.hht_sharpening_chain"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.hht_sharpening_chain-92"><a href="#Spectrum.hht_sharpening_chain-92"><span class="linenos"> 92</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.hht_sharpening_chain-93"><a href="#Spectrum.hht_sharpening_chain-93"><span class="linenos"> 93</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.hht_sharpening_chain-94"><a href="#Spectrum.hht_sharpening_chain-94"><span class="linenos"> 94</span></a><span class="k">def</span><span class="w"> </span><span class="nf">hht_sharpening_chain</span><span class="p">(</span><span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.hht_sharpening_chain-95"><a href="#Spectrum.hht_sharpening_chain-95"><span class="linenos"> 95</span></a>                         <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.hht_sharpening_chain-96"><a href="#Spectrum.hht_sharpening_chain-96"><span class="linenos"> 96</span></a>                         <span class="n">movmin</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
</span><span id="Spectrum.hht_sharpening_chain-97"><a href="#Spectrum.hht_sharpening_chain-97"><span class="linenos"> 97</span></a>                         <span class="p">):</span>
</span><span id="Spectrum.hht_sharpening_chain-98"><a href="#Spectrum.hht_sharpening_chain-98"><span class="linenos"> 98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.hht_sharpening_chain-99"><a href="#Spectrum.hht_sharpening_chain-99"><span class="linenos"> 99</span></a><span class="sd">    Hilbert-Huang based chain sharpening.</span>
</span><span id="Spectrum.hht_sharpening_chain-100"><a href="#Spectrum.hht_sharpening_chain-100"><span class="linenos">100</span></a>
</span><span id="Spectrum.hht_sharpening_chain-101"><a href="#Spectrum.hht_sharpening_chain-101"><span class="linenos">101</span></a><span class="sd">    Sequence of Hilbert-Huang sharpening procedures are performed.</span>
</span><span id="Spectrum.hht_sharpening_chain-102"><a href="#Spectrum.hht_sharpening_chain-102"><span class="linenos">102</span></a>
</span><span id="Spectrum.hht_sharpening_chain-103"><a href="#Spectrum.hht_sharpening_chain-103"><span class="linenos">103</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.hht_sharpening_chain-104"><a href="#Spectrum.hht_sharpening_chain-104"><span class="linenos">104</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.hht_sharpening_chain-105"><a href="#Spectrum.hht_sharpening_chain-105"><span class="linenos">105</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.hht_sharpening_chain-106"><a href="#Spectrum.hht_sharpening_chain-106"><span class="linenos">106</span></a><span class="sd">        movmin: List[int], optional. Default is [150, 50]</span>
</span><span id="Spectrum.hht_sharpening_chain-107"><a href="#Spectrum.hht_sharpening_chain-107"><span class="linenos">107</span></a><span class="sd">            The numer of values in the list defines how many iterations</span>
</span><span id="Spectrum.hht_sharpening_chain-108"><a href="#Spectrum.hht_sharpening_chain-108"><span class="linenos">108</span></a><span class="sd">            of HHT_sharpening will be performed and the values define</span>
</span><span id="Spectrum.hht_sharpening_chain-109"><a href="#Spectrum.hht_sharpening_chain-109"><span class="linenos">109</span></a><span class="sd">            the moving minimum window sizes for the corresponding operations.</span>
</span><span id="Spectrum.hht_sharpening_chain-110"><a href="#Spectrum.hht_sharpening_chain-110"><span class="linenos">110</span></a>
</span><span id="Spectrum.hht_sharpening_chain-111"><a href="#Spectrum.hht_sharpening_chain-111"><span class="linenos">111</span></a><span class="sd">    Returns: modified Spectrum</span>
</span><span id="Spectrum.hht_sharpening_chain-112"><a href="#Spectrum.hht_sharpening_chain-112"><span class="linenos">112</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.hht_sharpening_chain-113"><a href="#Spectrum.hht_sharpening_chain-113"><span class="linenos">113</span></a>    <span class="n">spe</span> <span class="o">=</span> <span class="n">old_spe</span>
</span><span id="Spectrum.hht_sharpening_chain-114"><a href="#Spectrum.hht_sharpening_chain-114"><span class="linenos">114</span></a>    <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">movmin</span><span class="p">:</span>
</span><span id="Spectrum.hht_sharpening_chain-115"><a href="#Spectrum.hht_sharpening_chain-115"><span class="linenos">115</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">hht_sharpening</span><span class="p">(</span><span class="n">movmin</span><span class="o">=</span><span class="n">mm</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.hht_sharpening_chain-116"><a href="#Spectrum.hht_sharpening_chain-116"><span class="linenos">116</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>Hilbert-Huang based chain sharpening.</p>

<p>Sequence of Hilbert-Huang sharpening procedures are performed.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>movmin:</strong>  List[int], optional. Default is [150, 50]
The numer of values in the list defines how many iterations
of HHT_sharpening will be performed and the values define
the moving minimum window sizes for the corresponding operations.</li>
</ul>

<p>Returns: modified Spectrum</p>
</div>


                            </div>
                            <div id="Spectrum.fit_peak_multimodel" class="classattr">
                                        <input id="Spectrum.fit_peak_multimodel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">fit_peak_multimodel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">profile</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewed Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Lorentzian&#39;</span><span class="p">,</span> <span class="s1">&#39;Moffat&#39;</span><span class="p">,</span> <span class="s1">&#39;Voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewed Voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;PseudoVoigt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson4&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson7&#39;</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewed Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Lorentzian&#39;</span><span class="p">,</span> <span class="s1">&#39;Moffat&#39;</span><span class="p">,</span> <span class="s1">&#39;Voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;Skewed Voigt&#39;</span><span class="p">,</span> <span class="s1">&#39;PseudoVoigt&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson4&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson7&#39;</span><span class="p">]]]</span>,</span><span class="param">	<span class="n">candidates</span><span class="p">:</span> <span class="n"><a href="../misc/types/peak_candidates.html#ListPeakCandidateMultiModel">ramanchada2.misc.types.peak_candidates.ListPeakCandidateMultiModel</a></span>,</span><span class="param">	<span class="n">no_fit</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">should_break</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>,</span><span class="param">	<span class="n">kwargs_fit</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="n">vary_baseline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">bound_centers_to_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="../misc/types/fit_peaks_result.html#FitPeaksResult">ramanchada2.misc.types.fit_peaks_result.FitPeaksResult</a></span>:</span></span>

                <label class="view-source-button" for="Spectrum.fit_peak_multimodel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.fit_peak_multimodel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.fit_peak_multimodel-105"><a href="#Spectrum.fit_peak_multimodel-105"><span class="linenos">105</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.fit_peak_multimodel-106"><a href="#Spectrum.fit_peak_multimodel-106"><span class="linenos">106</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.fit_peak_multimodel-107"><a href="#Spectrum.fit_peak_multimodel-107"><span class="linenos">107</span></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_peak_multimodel</span><span class="p">(</span><span class="n">spe</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_multimodel-108"><a href="#Spectrum.fit_peak_multimodel-108"><span class="linenos">108</span></a>                        <span class="n">profile</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">available_models_type</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">available_models_type</span><span class="p">]],</span>
</span><span id="Spectrum.fit_peak_multimodel-109"><a href="#Spectrum.fit_peak_multimodel-109"><span class="linenos">109</span></a>                        <span class="n">candidates</span><span class="p">:</span> <span class="n">ListPeakCandidateMultiModel</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_multimodel-110"><a href="#Spectrum.fit_peak_multimodel-110"><span class="linenos">110</span></a>                        <span class="n">no_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_multimodel-111"><a href="#Spectrum.fit_peak_multimodel-111"><span class="linenos">111</span></a>                        <span class="n">should_break</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
</span><span id="Spectrum.fit_peak_multimodel-112"><a href="#Spectrum.fit_peak_multimodel-112"><span class="linenos">112</span></a>                        <span class="n">kwargs_fit</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.fit_peak_multimodel-113"><a href="#Spectrum.fit_peak_multimodel-113"><span class="linenos">113</span></a>                        <span class="n">vary_baseline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_multimodel-114"><a href="#Spectrum.fit_peak_multimodel-114"><span class="linenos">114</span></a>                        <span class="n">bound_centers_to_group</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Spectrum.fit_peak_multimodel-115"><a href="#Spectrum.fit_peak_multimodel-115"><span class="linenos">115</span></a>                        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FitPeaksResult</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-116"><a href="#Spectrum.fit_peak_multimodel-116"><span class="linenos">116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peak_multimodel-117"><a href="#Spectrum.fit_peak_multimodel-117"><span class="linenos">117</span></a><span class="sd">    Fit a model based on candidates to the spectrum.</span>
</span><span id="Spectrum.fit_peak_multimodel-118"><a href="#Spectrum.fit_peak_multimodel-118"><span class="linenos">118</span></a>
</span><span id="Spectrum.fit_peak_multimodel-119"><a href="#Spectrum.fit_peak_multimodel-119"><span class="linenos">119</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.fit_peak_multimodel-120"><a href="#Spectrum.fit_peak_multimodel-120"><span class="linenos">120</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.fit_peak_multimodel-121"><a href="#Spectrum.fit_peak_multimodel-121"><span class="linenos">121</span></a><span class="sd">        profile: str or List[str]</span>
</span><span id="Spectrum.fit_peak_multimodel-122"><a href="#Spectrum.fit_peak_multimodel-122"><span class="linenos">122</span></a><span class="sd">            possible values are: [&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">available_models</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&quot;&quot;]</span>
</span><span id="Spectrum.fit_peak_multimodel-123"><a href="#Spectrum.fit_peak_multimodel-123"><span class="linenos">123</span></a><span class="s2">        candidates: as provided from find_peak_multipeak</span>
</span><span id="Spectrum.fit_peak_multimodel-124"><a href="#Spectrum.fit_peak_multimodel-124"><span class="linenos">124</span></a><span class="s2">        no_fit: optional. Defaults to False.</span>
</span><span id="Spectrum.fit_peak_multimodel-125"><a href="#Spectrum.fit_peak_multimodel-125"><span class="linenos">125</span></a><span class="s2">            If true, do not perform a fit. Result will be the inital guess,</span>
</span><span id="Spectrum.fit_peak_multimodel-126"><a href="#Spectrum.fit_peak_multimodel-126"><span class="linenos">126</span></a><span class="s2">            based on the data from peak candidates.</span>
</span><span id="Spectrum.fit_peak_multimodel-127"><a href="#Spectrum.fit_peak_multimodel-127"><span class="linenos">127</span></a><span class="s2">        should_break: optional. Defaults to [False].</span>
</span><span id="Spectrum.fit_peak_multimodel-128"><a href="#Spectrum.fit_peak_multimodel-128"><span class="linenos">128</span></a><span class="s2">            Use mutability of the python list type to be able to externaly</span>
</span><span id="Spectrum.fit_peak_multimodel-129"><a href="#Spectrum.fit_peak_multimodel-129"><span class="linenos">129</span></a><span class="s2">            break the minimization procedure.</span>
</span><span id="Spectrum.fit_peak_multimodel-130"><a href="#Spectrum.fit_peak_multimodel-130"><span class="linenos">130</span></a><span class="s2">        kwargs_fit: optional</span>
</span><span id="Spectrum.fit_peak_multimodel-131"><a href="#Spectrum.fit_peak_multimodel-131"><span class="linenos">131</span></a><span class="s2">            kwargs for fit function</span>
</span><span id="Spectrum.fit_peak_multimodel-132"><a href="#Spectrum.fit_peak_multimodel-132"><span class="linenos">132</span></a><span class="s2">        vary_baseline: optional. Defaults to False.</span>
</span><span id="Spectrum.fit_peak_multimodel-133"><a href="#Spectrum.fit_peak_multimodel-133"><span class="linenos">133</span></a><span class="s2">            If False baseline will not be a free parameter and its amplitude</span>
</span><span id="Spectrum.fit_peak_multimodel-134"><a href="#Spectrum.fit_peak_multimodel-134"><span class="linenos">134</span></a><span class="s2">            will be taken from the peak candidates.</span>
</span><span id="Spectrum.fit_peak_multimodel-135"><a href="#Spectrum.fit_peak_multimodel-135"><span class="linenos">135</span></a><span class="s2">        bound_centers_to_group: optional. Defaults to False.</span>
</span><span id="Spectrum.fit_peak_multimodel-136"><a href="#Spectrum.fit_peak_multimodel-136"><span class="linenos">136</span></a><span class="s2">            Perform a bounded fit. Request all peak centers to be within the group</span>
</span><span id="Spectrum.fit_peak_multimodel-137"><a href="#Spectrum.fit_peak_multimodel-137"><span class="linenos">137</span></a><span class="s2">            interval.</span>
</span><span id="Spectrum.fit_peak_multimodel-138"><a href="#Spectrum.fit_peak_multimodel-138"><span class="linenos">138</span></a>
</span><span id="Spectrum.fit_peak_multimodel-139"><a href="#Spectrum.fit_peak_multimodel-139"><span class="linenos">139</span></a><span class="s2">    Returns:</span>
</span><span id="Spectrum.fit_peak_multimodel-140"><a href="#Spectrum.fit_peak_multimodel-140"><span class="linenos">140</span></a><span class="s2">        FitPeaksResult: groups of fitted peaks</span>
</span><span id="Spectrum.fit_peak_multimodel-141"><a href="#Spectrum.fit_peak_multimodel-141"><span class="linenos">141</span></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peak_multimodel-142"><a href="#Spectrum.fit_peak_multimodel-142"><span class="linenos">142</span></a>
</span><span id="Spectrum.fit_peak_multimodel-143"><a href="#Spectrum.fit_peak_multimodel-143"><span class="linenos">143</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iter_cb</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">resid</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
</span><span id="Spectrum.fit_peak_multimodel-144"><a href="#Spectrum.fit_peak_multimodel-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="n">should_break</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Spectrum.fit_peak_multimodel-145"><a href="#Spectrum.fit_peak_multimodel-145"><span class="linenos">145</span></a>    <span class="k">if</span> <span class="n">no_fit</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-146"><a href="#Spectrum.fit_peak_multimodel-146"><span class="linenos">146</span></a>        <span class="n">kwargs_fit</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">kwargs_fit</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-147"><a href="#Spectrum.fit_peak_multimodel-147"><span class="linenos">147</span></a>        <span class="n">kwargs_fit</span><span class="p">[</span><span class="s1">&#39;max_nfev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Spectrum.fit_peak_multimodel-148"><a href="#Spectrum.fit_peak_multimodel-148"><span class="linenos">148</span></a>    <span class="n">fit_res</span> <span class="o">=</span> <span class="n">FitPeaksResult</span><span class="p">()</span>
</span><span id="Spectrum.fit_peak_multimodel-149"><a href="#Spectrum.fit_peak_multimodel-149"><span class="linenos">149</span></a>    <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">candidates</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-150"><a href="#Spectrum.fit_peak_multimodel-150"><span class="linenos">150</span></a>        <span class="n">mod</span><span class="p">,</span> <span class="n">par</span> <span class="o">=</span> <span class="n">build_multipeak_model_params</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-151"><a href="#Spectrum.fit_peak_multimodel-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">bound_centers_to_group</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-152"><a href="#Spectrum.fit_peak_multimodel-152"><span class="linenos">152</span></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">par</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-153"><a href="#Spectrum.fit_peak_multimodel-153"><span class="linenos">153</span></a>                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_center&#39;</span><span class="p">):</span>
</span><span id="Spectrum.fit_peak_multimodel-154"><a href="#Spectrum.fit_peak_multimodel-154"><span class="linenos">154</span></a>                    <span class="n">par</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Spectrum.fit_peak_multimodel-155"><a href="#Spectrum.fit_peak_multimodel-155"><span class="linenos">155</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">group</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Spectrum.fit_peak_multimodel-156"><a href="#Spectrum.fit_peak_multimodel-156"><span class="linenos">156</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.fit_peak_multimodel-157"><a href="#Spectrum.fit_peak_multimodel-157"><span class="linenos">157</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Spectrum.fit_peak_multimodel-158"><a href="#Spectrum.fit_peak_multimodel-158"><span class="linenos">158</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">peaks</span><span class="p">)):</span>
</span><span id="Spectrum.fit_peak_multimodel-159"><a href="#Spectrum.fit_peak_multimodel-159"><span class="linenos">159</span></a>            <span class="n">par</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;p</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-160"><a href="#Spectrum.fit_peak_multimodel-160"><span class="linenos">160</span></a>        <span class="n">fr</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">iter_cb</span><span class="o">=</span><span class="n">iter_cb</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs_fit</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-161"><a href="#Spectrum.fit_peak_multimodel-161"><span class="linenos">161</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">peaks</span><span class="p">)):</span>
</span><span id="Spectrum.fit_peak_multimodel-162"><a href="#Spectrum.fit_peak_multimodel-162"><span class="linenos">162</span></a>            <span class="n">par</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;p</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-163"><a href="#Spectrum.fit_peak_multimodel-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="n">vary_baseline</span><span class="p">:</span>
</span><span id="Spectrum.fit_peak_multimodel-164"><a href="#Spectrum.fit_peak_multimodel-164"><span class="linenos">164</span></a>            <span class="n">par</span><span class="p">[</span><span class="s1">&#39;bl_slope&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-165"><a href="#Spectrum.fit_peak_multimodel-165"><span class="linenos">165</span></a>            <span class="n">par</span><span class="p">[</span><span class="s1">&#39;bl_intercept&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-166"><a href="#Spectrum.fit_peak_multimodel-166"><span class="linenos">166</span></a>        <span class="n">fr</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">iter_cb</span><span class="o">=</span><span class="n">iter_cb</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_fit</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-167"><a href="#Spectrum.fit_peak_multimodel-167"><span class="linenos">167</span></a>        <span class="n">fit_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fr</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_multimodel-168"><a href="#Spectrum.fit_peak_multimodel-168"><span class="linenos">168</span></a>    <span class="k">return</span> <span class="n">fit_res</span>
</span></pre></div>


    

                            </div>
                            <div id="Spectrum.fit_peaks_filter" class="classattr">
                                        <input id="Spectrum.fit_peaks_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">fit_peaks_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="n">should_break</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>,</span><span class="param">	<span class="n">kwargs_fit</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.fit_peaks_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.fit_peaks_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.fit_peaks_filter-171"><a href="#Spectrum.fit_peaks_filter-171"><span class="linenos">171</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.fit_peaks_filter-172"><a href="#Spectrum.fit_peaks_filter-172"><span class="linenos">172</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.fit_peaks_filter-173"><a href="#Spectrum.fit_peaks_filter-173"><span class="linenos">173</span></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_peaks_filter</span><span class="p">(</span>
</span><span id="Spectrum.fit_peaks_filter-174"><a href="#Spectrum.fit_peaks_filter-174"><span class="linenos">174</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-175"><a href="#Spectrum.fit_peaks_filter-175"><span class="linenos">175</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-176"><a href="#Spectrum.fit_peaks_filter-176"><span class="linenos">176</span></a>        <span class="n">should_break</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
</span><span id="Spectrum.fit_peaks_filter-177"><a href="#Spectrum.fit_peaks_filter-177"><span class="linenos">177</span></a>        <span class="n">kwargs_fit</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.fit_peaks_filter-178"><a href="#Spectrum.fit_peaks_filter-178"><span class="linenos">178</span></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-179"><a href="#Spectrum.fit_peaks_filter-179"><span class="linenos">179</span></a>        <span class="p">):</span>
</span><span id="Spectrum.fit_peaks_filter-180"><a href="#Spectrum.fit_peaks_filter-180"><span class="linenos">180</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peaks_filter-181"><a href="#Spectrum.fit_peaks_filter-181"><span class="linenos">181</span></a><span class="sd">    Same as `fit_peak_multipeak` but the result is stored as metadata in the returned spectrum.</span>
</span><span id="Spectrum.fit_peaks_filter-182"><a href="#Spectrum.fit_peaks_filter-182"><span class="linenos">182</span></a>
</span><span id="Spectrum.fit_peaks_filter-183"><a href="#Spectrum.fit_peaks_filter-183"><span class="linenos">183</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.fit_peaks_filter-184"><a href="#Spectrum.fit_peaks_filter-184"><span class="linenos">184</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.fit_peaks_filter-185"><a href="#Spectrum.fit_peaks_filter-185"><span class="linenos">185</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.fit_peaks_filter-186"><a href="#Spectrum.fit_peaks_filter-186"><span class="linenos">186</span></a><span class="sd">        should_break: same as in fit_peaks_multipeak</span>
</span><span id="Spectrum.fit_peaks_filter-187"><a href="#Spectrum.fit_peaks_filter-187"><span class="linenos">187</span></a><span class="sd">        *args, **kwargs: same as `fit_peaks_multipeak`</span>
</span><span id="Spectrum.fit_peaks_filter-188"><a href="#Spectrum.fit_peaks_filter-188"><span class="linenos">188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peaks_filter-189"><a href="#Spectrum.fit_peaks_filter-189"><span class="linenos">189</span></a>    <span class="n">cand_groups</span> <span class="o">=</span> <span class="n">ListPeakCandidateMultiModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">old_spe</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</span><span id="Spectrum.fit_peaks_filter-190"><a href="#Spectrum.fit_peaks_filter-190"><span class="linenos">190</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">fit_peak_multimodel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.fit_peaks_filter-191"><a href="#Spectrum.fit_peaks_filter-191"><span class="linenos">191</span></a>                                                 <span class="n">candidates</span><span class="o">=</span><span class="n">cand_groups</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-192"><a href="#Spectrum.fit_peaks_filter-192"><span class="linenos">192</span></a>                                                 <span class="n">should_break</span><span class="o">=</span><span class="n">should_break</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-193"><a href="#Spectrum.fit_peaks_filter-193"><span class="linenos">193</span></a>                                                 <span class="n">kwargs_fit</span><span class="o">=</span><span class="n">kwargs_fit</span><span class="p">,</span>
</span><span id="Spectrum.fit_peaks_filter-194"><a href="#Spectrum.fit_peaks_filter-194"><span class="linenos">194</span></a>                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">dumps</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Same as <code>fit_peak_multipeak</code> but the result is stored as metadata in the returned spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong>should_break:</strong>  same as in fit_peaks_multipeak</li>
<li><strong><em>args, *</em>kwargs:</strong>  same as <code>fit_peaks_multipeak</code></li>
</ul>
</div>


                            </div>
                            <div id="Spectrum.bayesian_gaussian_mixture" class="classattr">
                                        <input id="Spectrum.bayesian_gaussian_mixture-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">bayesian_gaussian_mixture</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">n_samples</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">5000</span>,</span><span class="param">	<span class="n">n_components</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">50</span>,</span><span class="param">	<span class="n">max_iter</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">moving_minimum_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">trim_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">sklearn</span><span class="o">.</span><span class="n">mixture</span><span class="o">.</span><span class="n">_bayesian_mixture</span><span class="o">.</span><span class="n">BayesianGaussianMixture</span>:</span></span>

                <label class="view-source-button" for="Spectrum.bayesian_gaussian_mixture-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.bayesian_gaussian_mixture"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.bayesian_gaussian_mixture-12"><a href="#Spectrum.bayesian_gaussian_mixture-12"><span class="linenos">12</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-13"><a href="#Spectrum.bayesian_gaussian_mixture-13"><span class="linenos">13</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-14"><a href="#Spectrum.bayesian_gaussian_mixture-14"><span class="linenos">14</span></a><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_gaussian_mixture</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-15"><a href="#Spectrum.bayesian_gaussian_mixture-15"><span class="linenos">15</span></a>                              <span class="n">n_samples</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-16"><a href="#Spectrum.bayesian_gaussian_mixture-16"><span class="linenos">16</span></a>                              <span class="n">n_components</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-17"><a href="#Spectrum.bayesian_gaussian_mixture-17"><span class="linenos">17</span></a>                              <span class="n">max_iter</span><span class="p">:</span> <span class="n">PositiveInt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-18"><a href="#Spectrum.bayesian_gaussian_mixture-18"><span class="linenos">18</span></a>                              <span class="n">moving_minimum_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-19"><a href="#Spectrum.bayesian_gaussian_mixture-19"><span class="linenos">19</span></a>                              <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-20"><a href="#Spectrum.bayesian_gaussian_mixture-20"><span class="linenos">20</span></a>                              <span class="n">trim_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-21"><a href="#Spectrum.bayesian_gaussian_mixture-21"><span class="linenos">21</span></a>                              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BayesianGaussianMixture</span><span class="p">:</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-22"><a href="#Spectrum.bayesian_gaussian_mixture-22"><span class="linenos">22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-23"><a href="#Spectrum.bayesian_gaussian_mixture-23"><span class="linenos">23</span></a><span class="sd">    Decompose the spectrum to Bayesian Gaussian Mixture</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-24"><a href="#Spectrum.bayesian_gaussian_mixture-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.bayesian_gaussian_mixture-25"><a href="#Spectrum.bayesian_gaussian_mixture-25"><span class="linenos">25</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-26"><a href="#Spectrum.bayesian_gaussian_mixture-26"><span class="linenos">26</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-27"><a href="#Spectrum.bayesian_gaussian_mixture-27"><span class="linenos">27</span></a><span class="sd">        n_samples: optional. Defaults to 5000.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-28"><a href="#Spectrum.bayesian_gaussian_mixture-28"><span class="linenos">28</span></a><span class="sd">            Resampled dataset size</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-29"><a href="#Spectrum.bayesian_gaussian_mixture-29"><span class="linenos">29</span></a><span class="sd">        n_components: optional. Defaults to 50.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-30"><a href="#Spectrum.bayesian_gaussian_mixture-30"><span class="linenos">30</span></a><span class="sd">            Number of expected gaussian components</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-31"><a href="#Spectrum.bayesian_gaussian_mixture-31"><span class="linenos">31</span></a><span class="sd">        max_iter: optional. Defaults to 100.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-32"><a href="#Spectrum.bayesian_gaussian_mixture-32"><span class="linenos">32</span></a><span class="sd">            Maximal number of iterations.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-33"><a href="#Spectrum.bayesian_gaussian_mixture-33"><span class="linenos">33</span></a><span class="sd">        moving_minimum_window: optional. Defaults to None.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-34"><a href="#Spectrum.bayesian_gaussian_mixture-34"><span class="linenos">34</span></a><span class="sd">            If None no moving minimum is subtracted, otherwise as specified.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-35"><a href="#Spectrum.bayesian_gaussian_mixture-35"><span class="linenos">35</span></a><span class="sd">        random_state: optional. Defaults to None.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-36"><a href="#Spectrum.bayesian_gaussian_mixture-36"><span class="linenos">36</span></a><span class="sd">            Random generator seed to be used.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-37"><a href="#Spectrum.bayesian_gaussian_mixture-37"><span class="linenos">37</span></a><span class="sd">        trim_range: optional. Defaults to None:</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-38"><a href="#Spectrum.bayesian_gaussian_mixture-38"><span class="linenos">38</span></a><span class="sd">            If None ignore trimming, otherwise trim range is in x-axis values.</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-39"><a href="#Spectrum.bayesian_gaussian_mixture-39"><span class="linenos">39</span></a>
</span><span id="Spectrum.bayesian_gaussian_mixture-40"><a href="#Spectrum.bayesian_gaussian_mixture-40"><span class="linenos">40</span></a><span class="sd">    Returns:</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-41"><a href="#Spectrum.bayesian_gaussian_mixture-41"><span class="linenos">41</span></a><span class="sd">        BayesianGaussianMixture: Fitted Bayesian Gaussian Mixture</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-42"><a href="#Spectrum.bayesian_gaussian_mixture-42"><span class="linenos">42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-43"><a href="#Spectrum.bayesian_gaussian_mixture-43"><span class="linenos">43</span></a>    <span class="k">if</span> <span class="n">moving_minimum_window</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-44"><a href="#Spectrum.bayesian_gaussian_mixture-44"><span class="linenos">44</span></a>        <span class="n">spe</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">subtract_moving_minimum</span><span class="p">(</span><span class="n">moving_minimum_window</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-45"><a href="#Spectrum.bayesian_gaussian_mixture-45"><span class="linenos">45</span></a>    <span class="n">samp</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">gen_samples</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">trim_range</span><span class="o">=</span><span class="n">trim_range</span><span class="p">)</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-46"><a href="#Spectrum.bayesian_gaussian_mixture-46"><span class="linenos">46</span></a>    <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">samp</span><span class="p">]</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-47"><a href="#Spectrum.bayesian_gaussian_mixture-47"><span class="linenos">47</span></a>    <span class="n">bgm</span> <span class="o">=</span> <span class="n">BayesianGaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-48"><a href="#Spectrum.bayesian_gaussian_mixture-48"><span class="linenos">48</span></a>                                  <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-49"><a href="#Spectrum.bayesian_gaussian_mixture-49"><span class="linenos">49</span></a>                                  <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-50"><a href="#Spectrum.bayesian_gaussian_mixture-50"><span class="linenos">50</span></a>                                  <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Spectrum.bayesian_gaussian_mixture-51"><a href="#Spectrum.bayesian_gaussian_mixture-51"><span class="linenos">51</span></a>    <span class="k">return</span> <span class="n">bgm</span>
</span></pre></div>


            <div class="docstring"><p>Decompose the spectrum to Bayesian Gaussian Mixture</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>n_samples:</strong>  optional. Defaults to 5000.
Resampled dataset size</li>
<li><strong>n_components:</strong>  optional. Defaults to 50.
Number of expected gaussian components</li>
<li><strong>max_iter:</strong>  optional. Defaults to 100.
Maximal number of iterations.</li>
<li><strong>moving_minimum_window:</strong>  optional. Defaults to None.
If None no moving minimum is subtracted, otherwise as specified.</li>
<li><strong>random_state:</strong>  optional. Defaults to None.
Random generator seed to be used.</li>
<li><strong>trim_range:</strong>  optional. Defaults to None:
If None ignore trimming, otherwise trim range is in x-axis values.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>BayesianGaussianMixture: Fitted Bayesian Gaussian Mixture</p>
</blockquote>
</div>


                            </div>
                            <div id="Spectrum.fit_peak_positions" class="classattr">
                                        <input id="Spectrum.fit_peak_positions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">fit_peak_positions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">mov_min</span><span class="o">=</span><span class="mi">40</span>,</span><span class="param">	<span class="n">center_err_threshold</span><span class="o">=</span><span class="mf">0.5</span>,</span><span class="param">	<span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="n">fit_peaks_kw</span><span class="o">=</span><span class="p">{}</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Spectrum.fit_peak_positions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.fit_peak_positions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.fit_peak_positions-14"><a href="#Spectrum.fit_peak_positions-14"><span class="linenos">14</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.fit_peak_positions-15"><a href="#Spectrum.fit_peak_positions-15"><span class="linenos">15</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.fit_peak_positions-16"><a href="#Spectrum.fit_peak_positions-16"><span class="linenos">16</span></a><span class="k">def</span><span class="w"> </span><span class="nf">fit_peak_positions</span><span class="p">(</span><span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_positions-17"><a href="#Spectrum.fit_peak_positions-17"><span class="linenos">17</span></a>                       <span class="n">mov_min</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_positions-18"><a href="#Spectrum.fit_peak_positions-18"><span class="linenos">18</span></a>                       <span class="n">center_err_threshold</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
</span><span id="Spectrum.fit_peak_positions-19"><a href="#Spectrum.fit_peak_positions-19"><span class="linenos">19</span></a>                       <span class="n">find_peaks_kw</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.fit_peak_positions-20"><a href="#Spectrum.fit_peak_positions-20"><span class="linenos">20</span></a>                       <span class="n">fit_peaks_kw</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.fit_peak_positions-21"><a href="#Spectrum.fit_peak_positions-21"><span class="linenos">21</span></a>                       <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="Spectrum.fit_peak_positions-22"><a href="#Spectrum.fit_peak_positions-22"><span class="linenos">22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peak_positions-23"><a href="#Spectrum.fit_peak_positions-23"><span class="linenos">23</span></a><span class="sd">    Calculate peak positions and amplitudes.</span>
</span><span id="Spectrum.fit_peak_positions-24"><a href="#Spectrum.fit_peak_positions-24"><span class="linenos">24</span></a>
</span><span id="Spectrum.fit_peak_positions-25"><a href="#Spectrum.fit_peak_positions-25"><span class="linenos">25</span></a><span class="sd">    Sequence of multiple processings:</span>
</span><span id="Spectrum.fit_peak_positions-26"><a href="#Spectrum.fit_peak_positions-26"><span class="linenos">26</span></a><span class="sd">    - `subtract_moving_minimum`</span>
</span><span id="Spectrum.fit_peak_positions-27"><a href="#Spectrum.fit_peak_positions-27"><span class="linenos">27</span></a><span class="sd">    - `find_peak_multipeak`</span>
</span><span id="Spectrum.fit_peak_positions-28"><a href="#Spectrum.fit_peak_positions-28"><span class="linenos">28</span></a><span class="sd">    - filter peaks with x-location better than threshold</span>
</span><span id="Spectrum.fit_peak_positions-29"><a href="#Spectrum.fit_peak_positions-29"><span class="linenos">29</span></a>
</span><span id="Spectrum.fit_peak_positions-30"><a href="#Spectrum.fit_peak_positions-30"><span class="linenos">30</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.fit_peak_positions-31"><a href="#Spectrum.fit_peak_positions-31"><span class="linenos">31</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.fit_peak_positions-32"><a href="#Spectrum.fit_peak_positions-32"><span class="linenos">32</span></a><span class="sd">        mov_min: optional. Defaults to 40</span>
</span><span id="Spectrum.fit_peak_positions-33"><a href="#Spectrum.fit_peak_positions-33"><span class="linenos">33</span></a><span class="sd">            subtract moving_minimum with the specified window.</span>
</span><span id="Spectrum.fit_peak_positions-34"><a href="#Spectrum.fit_peak_positions-34"><span class="linenos">34</span></a><span class="sd">        center_err_threshold: optional. Defaults to 0.5.</span>
</span><span id="Spectrum.fit_peak_positions-35"><a href="#Spectrum.fit_peak_positions-35"><span class="linenos">35</span></a><span class="sd">            threshold for centroid standard deviation. Only peaks</span>
</span><span id="Spectrum.fit_peak_positions-36"><a href="#Spectrum.fit_peak_positions-36"><span class="linenos">36</span></a><span class="sd">            with better uncertainty will be returned.</span>
</span><span id="Spectrum.fit_peak_positions-37"><a href="#Spectrum.fit_peak_positions-37"><span class="linenos">37</span></a>
</span><span id="Spectrum.fit_peak_positions-38"><a href="#Spectrum.fit_peak_positions-38"><span class="linenos">38</span></a><span class="sd">        find_peaks_kw: optional</span>
</span><span id="Spectrum.fit_peak_positions-39"><a href="#Spectrum.fit_peak_positions-39"><span class="linenos">39</span></a><span class="sd">            keyword arguments to be used with find_peak_multipeak</span>
</span><span id="Spectrum.fit_peak_positions-40"><a href="#Spectrum.fit_peak_positions-40"><span class="linenos">40</span></a><span class="sd">        fit_peaks_kw: optional</span>
</span><span id="Spectrum.fit_peak_positions-41"><a href="#Spectrum.fit_peak_positions-41"><span class="linenos">41</span></a><span class="sd">            keyword arguments to be used with fit_peaks_multipeak</span>
</span><span id="Spectrum.fit_peak_positions-42"><a href="#Spectrum.fit_peak_positions-42"><span class="linenos">42</span></a>
</span><span id="Spectrum.fit_peak_positions-43"><a href="#Spectrum.fit_peak_positions-43"><span class="linenos">43</span></a><span class="sd">    Returns:</span>
</span><span id="Spectrum.fit_peak_positions-44"><a href="#Spectrum.fit_peak_positions-44"><span class="linenos">44</span></a><span class="sd">        Dict[float, float]: {positions: amplitudes}</span>
</span><span id="Spectrum.fit_peak_positions-45"><a href="#Spectrum.fit_peak_positions-45"><span class="linenos">45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.fit_peak_positions-46"><a href="#Spectrum.fit_peak_positions-46"><span class="linenos">46</span></a>    <span class="n">ss</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">subtract_moving_minimum</span><span class="p">(</span><span class="n">mov_min</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.fit_peak_positions-47"><a href="#Spectrum.fit_peak_positions-47"><span class="linenos">47</span></a>    <span class="n">find_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sharpening</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-48"><a href="#Spectrum.fit_peak_positions-48"><span class="linenos">48</span></a>    <span class="n">find_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">find_peaks_kw</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-49"><a href="#Spectrum.fit_peak_positions-49"><span class="linenos">49</span></a>    <span class="n">cand</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">find_peak_multipeak</span><span class="p">(</span><span class="o">**</span><span class="n">find_kw</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-50"><a href="#Spectrum.fit_peak_positions-50"><span class="linenos">50</span></a>
</span><span id="Spectrum.fit_peak_positions-51"><a href="#Spectrum.fit_peak_positions-51"><span class="linenos">51</span></a>    <span class="n">fit_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-52"><a href="#Spectrum.fit_peak_positions-52"><span class="linenos">52</span></a>    <span class="n">fit_kw</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">fit_peaks_kw</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-53"><a href="#Spectrum.fit_peak_positions-53"><span class="linenos">53</span></a>    <span class="n">fit_res</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">fit_peak_multimodel</span><span class="p">(</span><span class="n">candidates</span><span class="o">=</span><span class="n">cand</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_kw</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.fit_peak_positions-54"><a href="#Spectrum.fit_peak_positions-54"><span class="linenos">54</span></a>
</span><span id="Spectrum.fit_peak_positions-55"><a href="#Spectrum.fit_peak_positions-55"><span class="linenos">55</span></a>    <span class="n">pos</span><span class="p">,</span> <span class="n">amp</span> <span class="o">=</span> <span class="n">fit_res</span><span class="o">.</span><span class="n">center_amplitude</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">center_err_threshold</span><span class="p">)</span>
</span><span id="Spectrum.fit_peak_positions-56"><a href="#Spectrum.fit_peak_positions-56"><span class="linenos">56</span></a>
</span><span id="Spectrum.fit_peak_positions-57"><a href="#Spectrum.fit_peak_positions-57"><span class="linenos">57</span></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">amp</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Calculate peak positions and amplitudes.</p>

<p>Sequence of multiple processings:</p>

<ul>
<li><code><a href="#Spectrum.subtract_moving_minimum">subtract_moving_minimum</a></code></li>
<li><code><a href="#Spectrum.find_peak_multipeak">find_peak_multipeak</a></code></li>
<li>filter peaks with x-location better than threshold</li>
</ul>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>mov_min:</strong>  optional. Defaults to 40
subtract moving_minimum with the specified window.</li>
<li><strong>center_err_threshold:</strong>  optional. Defaults to 0.5.
threshold for centroid standard deviation. Only peaks
with better uncertainty will be returned.</li>
<li><strong>find_peaks_kw:</strong>  optional
keyword arguments to be used with find_peak_multipeak</li>
<li><strong>fit_peaks_kw:</strong>  optional
keyword arguments to be used with fit_peaks_multipeak</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dict[float, float]: {positions: amplitudes}</p>
</blockquote>
</div>


                            </div>
                            <div id="Spectrum.find_peak_multipeak" class="classattr">
                                        <input id="Spectrum.find_peak_multipeak-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_method">@add_spectrum_method</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">find_peak_multipeak</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="n">prominence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Ge</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">wlen</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Ge</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">width</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">hht_chain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Gt</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">bgm_kwargs</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="n">sharpening</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;topo&#39;</span><span class="p">,</span> <span class="s1">&#39;bayesian_gaussian_mixture&#39;</span><span class="p">,</span> <span class="s1">&#39;bgm&#39;</span><span class="p">,</span> <span class="s1">&#39;cwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;topo&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="../misc/types/peak_candidates.html#ListPeakCandidateMultiModel">ramanchada2.misc.types.peak_candidates.ListPeakCandidateMultiModel</a></span>:</span></span>

                <label class="view-source-button" for="Spectrum.find_peak_multipeak-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.find_peak_multipeak"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.find_peak_multipeak-41"><a href="#Spectrum.find_peak_multipeak-41"><span class="linenos"> 41</span></a><span class="nd">@add_spectrum_method</span>
</span><span id="Spectrum.find_peak_multipeak-42"><a href="#Spectrum.find_peak_multipeak-42"><span class="linenos"> 42</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-43"><a href="#Spectrum.find_peak_multipeak-43"><span class="linenos"> 43</span></a><span class="k">def</span><span class="w"> </span><span class="nf">find_peak_multipeak</span><span class="p">(</span>
</span><span id="Spectrum.find_peak_multipeak-44"><a href="#Spectrum.find_peak_multipeak-44"><span class="linenos"> 44</span></a>        <span class="n">spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-45"><a href="#Spectrum.find_peak_multipeak-45"><span class="linenos"> 45</span></a>        <span class="n">prominence</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NonNegativeFloat</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-46"><a href="#Spectrum.find_peak_multipeak-46"><span class="linenos"> 46</span></a>        <span class="n">wlen</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NonNegativeInt</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-47"><a href="#Spectrum.find_peak_multipeak-47"><span class="linenos"> 47</span></a>        <span class="n">width</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-48"><a href="#Spectrum.find_peak_multipeak-48"><span class="linenos"> 48</span></a>        <span class="n">hht_chain</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-49"><a href="#Spectrum.find_peak_multipeak-49"><span class="linenos"> 49</span></a>        <span class="n">bgm_kwargs</span><span class="o">=</span><span class="p">{},</span>
</span><span id="Spectrum.find_peak_multipeak-50"><a href="#Spectrum.find_peak_multipeak-50"><span class="linenos"> 50</span></a>        <span class="n">sharpening</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-51"><a href="#Spectrum.find_peak_multipeak-51"><span class="linenos"> 51</span></a>        <span class="n">strategy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;topo&#39;</span><span class="p">,</span> <span class="s1">&#39;bayesian_gaussian_mixture&#39;</span><span class="p">,</span> <span class="s1">&#39;bgm&#39;</span><span class="p">,</span> <span class="s1">&#39;cwt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;topo&#39;</span>
</span><span id="Spectrum.find_peak_multipeak-52"><a href="#Spectrum.find_peak_multipeak-52"><span class="linenos"> 52</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ListPeakCandidateMultiModel</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-53"><a href="#Spectrum.find_peak_multipeak-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.find_peak_multipeak-54"><a href="#Spectrum.find_peak_multipeak-54"><span class="linenos"> 54</span></a><span class="sd">    Find groups of peaks in spectrum.</span>
</span><span id="Spectrum.find_peak_multipeak-55"><a href="#Spectrum.find_peak_multipeak-55"><span class="linenos"> 55</span></a>
</span><span id="Spectrum.find_peak_multipeak-56"><a href="#Spectrum.find_peak_multipeak-56"><span class="linenos"> 56</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.find_peak_multipeak-57"><a href="#Spectrum.find_peak_multipeak-57"><span class="linenos"> 57</span></a><span class="sd">        spe: internal use only</span>
</span><span id="Spectrum.find_peak_multipeak-58"><a href="#Spectrum.find_peak_multipeak-58"><span class="linenos"> 58</span></a><span class="sd">        prominence: Optional. Defaults to None</span>
</span><span id="Spectrum.find_peak_multipeak-59"><a href="#Spectrum.find_peak_multipeak-59"><span class="linenos"> 59</span></a><span class="sd">            If None the prominence value will be `spe.y_nose`. Reasonable value for</span>
</span><span id="Spectrum.find_peak_multipeak-60"><a href="#Spectrum.find_peak_multipeak-60"><span class="linenos"> 60</span></a><span class="sd">            promience is `const * spe.y_noise_MAD`.</span>
</span><span id="Spectrum.find_peak_multipeak-61"><a href="#Spectrum.find_peak_multipeak-61"><span class="linenos"> 61</span></a><span class="sd">        wlen: optional. Defaults to None.</span>
</span><span id="Spectrum.find_peak_multipeak-62"><a href="#Spectrum.find_peak_multipeak-62"><span class="linenos"> 62</span></a><span class="sd">            wlen value used in `scipy.signal.find_peaks`. If wlen is None, 200 will be used.</span>
</span><span id="Spectrum.find_peak_multipeak-63"><a href="#Spectrum.find_peak_multipeak-63"><span class="linenos"> 63</span></a><span class="sd">        width: optional. Defaults to None.</span>
</span><span id="Spectrum.find_peak_multipeak-64"><a href="#Spectrum.find_peak_multipeak-64"><span class="linenos"> 64</span></a><span class="sd">            width value used in `scipy.signal.find_peaks`. If width is None, 2 will be used.</span>
</span><span id="Spectrum.find_peak_multipeak-65"><a href="#Spectrum.find_peak_multipeak-65"><span class="linenos"> 65</span></a><span class="sd">        hht_chain: optional. Defaults to None.</span>
</span><span id="Spectrum.find_peak_multipeak-66"><a href="#Spectrum.find_peak_multipeak-66"><span class="linenos"> 66</span></a><span class="sd">            List of hht_chain window sizes. If None, no hht sharpening is performed.</span>
</span><span id="Spectrum.find_peak_multipeak-67"><a href="#Spectrum.find_peak_multipeak-67"><span class="linenos"> 67</span></a><span class="sd">        bgm_kwargs: kwargs for bayesian_gaussian_mixture</span>
</span><span id="Spectrum.find_peak_multipeak-68"><a href="#Spectrum.find_peak_multipeak-68"><span class="linenos"> 68</span></a><span class="sd">        sharpening &#39;hht&#39; or None. Defaults to None.</span>
</span><span id="Spectrum.find_peak_multipeak-69"><a href="#Spectrum.find_peak_multipeak-69"><span class="linenos"> 69</span></a><span class="sd">            If &#39;hht&#39; hht sharpening will be performed before finding peaks.</span>
</span><span id="Spectrum.find_peak_multipeak-70"><a href="#Spectrum.find_peak_multipeak-70"><span class="linenos"> 70</span></a><span class="sd">        strategy: optional. Defauts to &#39;topo&#39;.</span>
</span><span id="Spectrum.find_peak_multipeak-71"><a href="#Spectrum.find_peak_multipeak-71"><span class="linenos"> 71</span></a><span class="sd">            Peakfinding method</span>
</span><span id="Spectrum.find_peak_multipeak-72"><a href="#Spectrum.find_peak_multipeak-72"><span class="linenos"> 72</span></a>
</span><span id="Spectrum.find_peak_multipeak-73"><a href="#Spectrum.find_peak_multipeak-73"><span class="linenos"> 73</span></a><span class="sd">    Returns:</span>
</span><span id="Spectrum.find_peak_multipeak-74"><a href="#Spectrum.find_peak_multipeak-74"><span class="linenos"> 74</span></a><span class="sd">        ListPeakCandidateMultiModel: Located peak groups</span>
</span><span id="Spectrum.find_peak_multipeak-75"><a href="#Spectrum.find_peak_multipeak-75"><span class="linenos"> 75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.find_peak_multipeak-76"><a href="#Spectrum.find_peak_multipeak-76"><span class="linenos"> 76</span></a>
</span><span id="Spectrum.find_peak_multipeak-77"><a href="#Spectrum.find_peak_multipeak-77"><span class="linenos"> 77</span></a>    <span class="k">if</span> <span class="n">prominence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-78"><a href="#Spectrum.find_peak_multipeak-78"><span class="linenos"> 78</span></a>        <span class="n">prominence</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y_noise</span>
</span><span id="Spectrum.find_peak_multipeak-79"><a href="#Spectrum.find_peak_multipeak-79"><span class="linenos"> 79</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">wlen</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-80"><a href="#Spectrum.find_peak_multipeak-80"><span class="linenos"> 80</span></a>        <span class="n">wlen</span> <span class="o">=</span> <span class="mi">200</span>
</span><span id="Spectrum.find_peak_multipeak-81"><a href="#Spectrum.find_peak_multipeak-81"><span class="linenos"> 81</span></a>    <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-82"><a href="#Spectrum.find_peak_multipeak-82"><span class="linenos"> 82</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Spectrum.find_peak_multipeak-83"><a href="#Spectrum.find_peak_multipeak-83"><span class="linenos"> 83</span></a>
</span><span id="Spectrum.find_peak_multipeak-84"><a href="#Spectrum.find_peak_multipeak-84"><span class="linenos"> 84</span></a>    <span class="k">if</span> <span class="n">sharpening</span> <span class="o">==</span> <span class="s1">&#39;hht&#39;</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-85"><a href="#Spectrum.find_peak_multipeak-85"><span class="linenos"> 85</span></a>        <span class="k">if</span> <span class="n">hht_chain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-86"><a href="#Spectrum.find_peak_multipeak-86"><span class="linenos"> 86</span></a>            <span class="n">hht_chain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-87"><a href="#Spectrum.find_peak_multipeak-87"><span class="linenos"> 87</span></a>        <span class="n">sharp_spe</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">hht_sharpening_chain</span><span class="p">(</span><span class="n">movmin</span><span class="o">=</span><span class="n">hht_chain</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.find_peak_multipeak-88"><a href="#Spectrum.find_peak_multipeak-88"><span class="linenos"> 88</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-89"><a href="#Spectrum.find_peak_multipeak-89"><span class="linenos"> 89</span></a>        <span class="n">sharp_spe</span> <span class="o">=</span> <span class="n">spe</span>
</span><span id="Spectrum.find_peak_multipeak-90"><a href="#Spectrum.find_peak_multipeak-90"><span class="linenos"> 90</span></a>
</span><span id="Spectrum.find_peak_multipeak-91"><a href="#Spectrum.find_peak_multipeak-91"><span class="linenos"> 91</span></a>    <span class="n">x_arr</span> <span class="o">=</span> <span class="n">sharp_spe</span><span class="o">.</span><span class="n">x</span>
</span><span id="Spectrum.find_peak_multipeak-92"><a href="#Spectrum.find_peak_multipeak-92"><span class="linenos"> 92</span></a>    <span class="n">y_arr</span> <span class="o">=</span> <span class="n">sharp_spe</span><span class="o">.</span><span class="n">y</span>
</span><span id="Spectrum.find_peak_multipeak-93"><a href="#Spectrum.find_peak_multipeak-93"><span class="linenos"> 93</span></a>
</span><span id="Spectrum.find_peak_multipeak-94"><a href="#Spectrum.find_peak_multipeak-94"><span class="linenos"> 94</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Spectrum.find_peak_multipeak-95"><a href="#Spectrum.find_peak_multipeak-95"><span class="linenos"> 95</span></a>        <span class="n">x1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-96"><a href="#Spectrum.find_peak_multipeak-96"><span class="linenos"> 96</span></a>        <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Spectrum.find_peak_multipeak-97"><a href="#Spectrum.find_peak_multipeak-97"><span class="linenos"> 97</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">x1</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-98"><a href="#Spectrum.find_peak_multipeak-98"><span class="linenos"> 98</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">x2</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-99"><a href="#Spectrum.find_peak_multipeak-99"><span class="linenos"> 99</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span>
</span><span id="Spectrum.find_peak_multipeak-100"><a href="#Spectrum.find_peak_multipeak-100"><span class="linenos">100</span></a>
</span><span id="Spectrum.find_peak_multipeak-101"><a href="#Spectrum.find_peak_multipeak-101"><span class="linenos">101</span></a>    <span class="n">boundaries</span> <span class="o">=</span> <span class="n">peak_boundaries</span><span class="p">(</span><span class="n">spe</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="n">prominence</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">wlen</span><span class="o">=</span><span class="n">wlen</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-102"><a href="#Spectrum.find_peak_multipeak-102"><span class="linenos">102</span></a>    <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[(</span><span class="n">li</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span> <span class="k">for</span> <span class="n">li</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">boundaries</span> <span class="k">if</span> <span class="p">(</span><span class="n">ri</span><span class="o">-</span><span class="n">li</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-103"><a href="#Spectrum.find_peak_multipeak-103"><span class="linenos">103</span></a>
</span><span id="Spectrum.find_peak_multipeak-104"><a href="#Spectrum.find_peak_multipeak-104"><span class="linenos">104</span></a>    <span class="n">peaks</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span><span class="n">y_arr</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-105"><a href="#Spectrum.find_peak_multipeak-105"><span class="linenos">105</span></a>                                     <span class="n">prominence</span><span class="o">=</span><span class="n">prominence</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-106"><a href="#Spectrum.find_peak_multipeak-106"><span class="linenos">106</span></a>                                     <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-107"><a href="#Spectrum.find_peak_multipeak-107"><span class="linenos">107</span></a>                                     <span class="n">wlen</span><span class="o">=</span><span class="n">wlen</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-108"><a href="#Spectrum.find_peak_multipeak-108"><span class="linenos">108</span></a>    <span class="n">peak_groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-109"><a href="#Spectrum.find_peak_multipeak-109"><span class="linenos">109</span></a>
</span><span id="Spectrum.find_peak_multipeak-110"><a href="#Spectrum.find_peak_multipeak-110"><span class="linenos">110</span></a>    <span class="k">if</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;bgm&#39;</span><span class="p">,</span> <span class="s1">&#39;bayesian_gaussian_mixture&#39;</span><span class="p">}:</span>
</span><span id="Spectrum.find_peak_multipeak-111"><a href="#Spectrum.find_peak_multipeak-111"><span class="linenos">111</span></a>        <span class="n">bgm</span> <span class="o">=</span> <span class="n">sharp_spe</span><span class="o">.</span><span class="n">bayesian_gaussian_mixture</span><span class="p">(</span><span class="o">**</span><span class="n">bgm_kwargs</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-112"><a href="#Spectrum.find_peak_multipeak-112"><span class="linenos">112</span></a>
</span><span id="Spectrum.find_peak_multipeak-113"><a href="#Spectrum.find_peak_multipeak-113"><span class="linenos">113</span></a>        <span class="n">bgm_peaks</span> <span class="o">=</span> <span class="p">[[</span><span class="n">mean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">weight</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-114"><a href="#Spectrum.find_peak_multipeak-114"><span class="linenos">114</span></a>                     <span class="k">for</span> <span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span>
</span><span id="Spectrum.find_peak_multipeak-115"><a href="#Spectrum.find_peak_multipeak-115"><span class="linenos">115</span></a>                     <span class="nb">zip</span><span class="p">(</span><span class="n">bgm</span><span class="o">.</span><span class="n">means_</span><span class="p">,</span> <span class="n">bgm</span><span class="o">.</span><span class="n">covariances_</span><span class="p">,</span> <span class="n">bgm</span><span class="o">.</span><span class="n">weights_</span><span class="p">)]</span>
</span><span id="Spectrum.find_peak_multipeak-116"><a href="#Spectrum.find_peak_multipeak-116"><span class="linenos">116</span></a>        <span class="n">bgm_peaks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">bgm_peaks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-117"><a href="#Spectrum.find_peak_multipeak-117"><span class="linenos">117</span></a>        <span class="n">integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_arr</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-118"><a href="#Spectrum.find_peak_multipeak-118"><span class="linenos">118</span></a>        <span class="n">n_peaks</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bgm</span><span class="o">.</span><span class="n">weights_</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-119"><a href="#Spectrum.find_peak_multipeak-119"><span class="linenos">119</span></a>        <span class="n">bgm_peaks</span> <span class="o">=</span> <span class="n">bgm_peaks</span><span class="p">[:</span><span class="n">n_peaks</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-120"><a href="#Spectrum.find_peak_multipeak-120"><span class="linenos">120</span></a>
</span><span id="Spectrum.find_peak_multipeak-121"><a href="#Spectrum.find_peak_multipeak-121"><span class="linenos">121</span></a>        <span class="n">peak_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-122"><a href="#Spectrum.find_peak_multipeak-122"><span class="linenos">122</span></a>        <span class="k">for</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">bgm_peaks</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-123"><a href="#Spectrum.find_peak_multipeak-123"><span class="linenos">123</span></a>            <span class="n">peak_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="n">weight</span><span class="o">*</span><span class="n">integral</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-124"><a href="#Spectrum.find_peak_multipeak-124"><span class="linenos">124</span></a>                                  <span class="n">position</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-125"><a href="#Spectrum.find_peak_multipeak-125"><span class="linenos">125</span></a>                                  <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-126"><a href="#Spectrum.find_peak_multipeak-126"><span class="linenos">126</span></a>                                  <span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-127"><a href="#Spectrum.find_peak_multipeak-127"><span class="linenos">127</span></a>        <span class="k">for</span> <span class="n">li</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-128"><a href="#Spectrum.find_peak_multipeak-128"><span class="linenos">128</span></a>            <span class="n">peak_group</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-129"><a href="#Spectrum.find_peak_multipeak-129"><span class="linenos">129</span></a>            <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peak_list</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-130"><a href="#Spectrum.find_peak_multipeak-130"><span class="linenos">130</span></a>                <span class="k">if</span> <span class="n">li</span> <span class="o">&lt;</span> <span class="n">peak</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ri</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-131"><a href="#Spectrum.find_peak_multipeak-131"><span class="linenos">131</span></a>                    <span class="n">peak_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-132"><a href="#Spectrum.find_peak_multipeak-132"><span class="linenos">132</span></a>                                           <span class="n">amplitude</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-133"><a href="#Spectrum.find_peak_multipeak-133"><span class="linenos">133</span></a>                                           <span class="n">sigma</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">])</span>
</span><span id="Spectrum.find_peak_multipeak-134"><a href="#Spectrum.find_peak_multipeak-134"><span class="linenos">134</span></a>                                      <span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-135"><a href="#Spectrum.find_peak_multipeak-135"><span class="linenos">135</span></a>            <span class="k">if</span> <span class="n">peak_group</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-136"><a href="#Spectrum.find_peak_multipeak-136"><span class="linenos">136</span></a>                <span class="n">peak_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="n">x_arr</span><span class="p">[</span><span class="n">li</span><span class="p">],</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">ri</span><span class="p">]),</span>
</span><span id="Spectrum.find_peak_multipeak-137"><a href="#Spectrum.find_peak_multipeak-137"><span class="linenos">137</span></a>                                        <span class="n">peaks</span><span class="o">=</span><span class="n">peak_group</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-138"><a href="#Spectrum.find_peak_multipeak-138"><span class="linenos">138</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;cwt&#39;</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-139"><a href="#Spectrum.find_peak_multipeak-139"><span class="linenos">139</span></a>        <span class="c1"># TODO: cwt_args tbd</span>
</span><span id="Spectrum.find_peak_multipeak-140"><a href="#Spectrum.find_peak_multipeak-140"><span class="linenos">140</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="n">find_peaks_cwt</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">bgm_kwargs</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-141"><a href="#Spectrum.find_peak_multipeak-141"><span class="linenos">141</span></a>        <span class="n">peak_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-142"><a href="#Spectrum.find_peak_multipeak-142"><span class="linenos">142</span></a>        <span class="k">for</span> <span class="n">peak_index</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-143"><a href="#Spectrum.find_peak_multipeak-143"><span class="linenos">143</span></a>            <span class="n">half_max</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">peak_index</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="Spectrum.find_peak_multipeak-144"><a href="#Spectrum.find_peak_multipeak-144"><span class="linenos">144</span></a>            <span class="n">left_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[:</span><span class="n">peak_index</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">half_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-145"><a href="#Spectrum.find_peak_multipeak-145"><span class="linenos">145</span></a>            <span class="n">right_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">peak_index</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">half_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">peak_index</span>
</span><span id="Spectrum.find_peak_multipeak-146"><a href="#Spectrum.find_peak_multipeak-146"><span class="linenos">146</span></a>            <span class="n">fwhm</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">right_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">left_index</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-147"><a href="#Spectrum.find_peak_multipeak-147"><span class="linenos">147</span></a>            <span class="c1"># rough sigma estimation based on fwhm</span>
</span><span id="Spectrum.find_peak_multipeak-148"><a href="#Spectrum.find_peak_multipeak-148"><span class="linenos">148</span></a>            <span class="n">sqrt2ln2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-149"><a href="#Spectrum.find_peak_multipeak-149"><span class="linenos">149</span></a>            <span class="c1"># print(spe.x[peak_index], spe.y[peak_index], fwhm / sqrt2ln2 )</span>
</span><span id="Spectrum.find_peak_multipeak-150"><a href="#Spectrum.find_peak_multipeak-150"><span class="linenos">150</span></a>            <span class="n">peak_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">peak_index</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-151"><a href="#Spectrum.find_peak_multipeak-151"><span class="linenos">151</span></a>                                  <span class="n">position</span><span class="o">=</span><span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">peak_index</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-152"><a href="#Spectrum.find_peak_multipeak-152"><span class="linenos">152</span></a>                                  <span class="n">sigma</span><span class="o">=</span><span class="n">fwhm</span> <span class="o">/</span> <span class="n">sqrt2ln2</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-153"><a href="#Spectrum.find_peak_multipeak-153"><span class="linenos">153</span></a>                                  <span class="n">fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-154"><a href="#Spectrum.find_peak_multipeak-154"><span class="linenos">154</span></a>        <span class="k">for</span> <span class="n">li</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-155"><a href="#Spectrum.find_peak_multipeak-155"><span class="linenos">155</span></a>            <span class="n">peak_group</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-156"><a href="#Spectrum.find_peak_multipeak-156"><span class="linenos">156</span></a>            <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">peak_list</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-157"><a href="#Spectrum.find_peak_multipeak-157"><span class="linenos">157</span></a>                <span class="k">if</span> <span class="n">li</span> <span class="o">&lt;</span> <span class="n">peak</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ri</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-158"><a href="#Spectrum.find_peak_multipeak-158"><span class="linenos">158</span></a>                    <span class="n">peak_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-159"><a href="#Spectrum.find_peak_multipeak-159"><span class="linenos">159</span></a>                                           <span class="n">amplitude</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;amplitude&#39;</span><span class="p">],</span>
</span><span id="Spectrum.find_peak_multipeak-160"><a href="#Spectrum.find_peak_multipeak-160"><span class="linenos">160</span></a>                                           <span class="n">sigma</span><span class="o">=</span><span class="n">peak</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]))</span>
</span><span id="Spectrum.find_peak_multipeak-161"><a href="#Spectrum.find_peak_multipeak-161"><span class="linenos">161</span></a>            <span class="k">if</span> <span class="n">peak_group</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-162"><a href="#Spectrum.find_peak_multipeak-162"><span class="linenos">162</span></a>                <span class="n">peak_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="n">x_arr</span><span class="p">[</span><span class="n">li</span><span class="p">],</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">ri</span><span class="p">]),</span>
</span><span id="Spectrum.find_peak_multipeak-163"><a href="#Spectrum.find_peak_multipeak-163"><span class="linenos">163</span></a>                                        <span class="n">peaks</span><span class="o">=</span><span class="n">peak_group</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-164"><a href="#Spectrum.find_peak_multipeak-164"><span class="linenos">164</span></a>    <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;topo&#39;</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-165"><a href="#Spectrum.find_peak_multipeak-165"><span class="linenos">165</span></a>        <span class="k">for</span> <span class="n">li</span><span class="p">,</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-166"><a href="#Spectrum.find_peak_multipeak-166"><span class="linenos">166</span></a>            <span class="n">peak_group</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Spectrum.find_peak_multipeak-167"><a href="#Spectrum.find_peak_multipeak-167"><span class="linenos">167</span></a>            <span class="n">x1</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">li</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-168"><a href="#Spectrum.find_peak_multipeak-168"><span class="linenos">168</span></a>            <span class="n">x2</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-169"><a href="#Spectrum.find_peak_multipeak-169"><span class="linenos">169</span></a>            <span class="n">y1</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">li</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-170"><a href="#Spectrum.find_peak_multipeak-170"><span class="linenos">170</span></a>            <span class="n">y2</span> <span class="o">=</span> <span class="n">spe</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-171"><a href="#Spectrum.find_peak_multipeak-171"><span class="linenos">171</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-172"><a href="#Spectrum.find_peak_multipeak-172"><span class="linenos">172</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="o">-</span><span class="n">slope</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">y1</span>
</span><span id="Spectrum.find_peak_multipeak-173"><a href="#Spectrum.find_peak_multipeak-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">peak_i</span><span class="p">,</span> <span class="n">peak_pos</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">peaks</span><span class="p">):</span>
</span><span id="Spectrum.find_peak_multipeak-174"><a href="#Spectrum.find_peak_multipeak-174"><span class="linenos">174</span></a>                <span class="k">if</span> <span class="n">li</span> <span class="o">&lt;</span> <span class="n">peak_pos</span> <span class="o">&lt;</span> <span class="n">ri</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-175"><a href="#Spectrum.find_peak_multipeak-175"><span class="linenos">175</span></a>                    <span class="n">pos_maximum</span> <span class="o">=</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">peak_pos</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-176"><a href="#Spectrum.find_peak_multipeak-176"><span class="linenos">176</span></a>                    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;prominences&#39;</span><span class="p">][</span><span class="n">peak_i</span><span class="p">]</span>
</span><span id="Spectrum.find_peak_multipeak-177"><a href="#Spectrum.find_peak_multipeak-177"><span class="linenos">177</span></a>                    <span class="n">lwhm</span> <span class="o">=</span> <span class="n">pos_maximum</span> <span class="o">-</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;left_ips&#39;</span><span class="p">][</span><span class="n">peak_i</span><span class="p">])</span>
</span><span id="Spectrum.find_peak_multipeak-178"><a href="#Spectrum.find_peak_multipeak-178"><span class="linenos">178</span></a>                    <span class="n">rwhm</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;right_ips&#39;</span><span class="p">][</span><span class="n">peak_i</span><span class="p">])</span> <span class="o">-</span> <span class="n">pos_maximum</span>
</span><span id="Spectrum.find_peak_multipeak-179"><a href="#Spectrum.find_peak_multipeak-179"><span class="linenos">179</span></a>                    <span class="n">fwhm</span> <span class="o">=</span> <span class="n">lwhm</span> <span class="o">+</span> <span class="n">rwhm</span>
</span><span id="Spectrum.find_peak_multipeak-180"><a href="#Spectrum.find_peak_multipeak-180"><span class="linenos">180</span></a>                    <span class="n">sigma</span> <span class="o">=</span> <span class="n">fwhm</span><span class="o">/</span><span class="mf">2.355</span>
</span><span id="Spectrum.find_peak_multipeak-181"><a href="#Spectrum.find_peak_multipeak-181"><span class="linenos">181</span></a>                    <span class="n">skew</span> <span class="o">=</span> <span class="p">(</span><span class="n">rwhm</span><span class="o">-</span><span class="n">lwhm</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rwhm</span><span class="o">+</span><span class="n">lwhm</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-182"><a href="#Spectrum.find_peak_multipeak-182"><span class="linenos">182</span></a>                    <span class="n">peak_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">pos_maximum</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-183"><a href="#Spectrum.find_peak_multipeak-183"><span class="linenos">183</span></a>                                           <span class="n">amplitude</span><span class="o">=</span><span class="n">amplitude</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-184"><a href="#Spectrum.find_peak_multipeak-184"><span class="linenos">184</span></a>                                           <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-185"><a href="#Spectrum.find_peak_multipeak-185"><span class="linenos">185</span></a>                                           <span class="n">skew</span><span class="o">=</span><span class="n">skew</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-186"><a href="#Spectrum.find_peak_multipeak-186"><span class="linenos">186</span></a>                                      <span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-187"><a href="#Spectrum.find_peak_multipeak-187"><span class="linenos">187</span></a>            <span class="k">if</span> <span class="n">peak_group</span><span class="p">:</span>
</span><span id="Spectrum.find_peak_multipeak-188"><a href="#Spectrum.find_peak_multipeak-188"><span class="linenos">188</span></a>                <span class="n">peak_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">base_intercept</span><span class="o">=</span><span class="n">intercept</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-189"><a href="#Spectrum.find_peak_multipeak-189"><span class="linenos">189</span></a>                                        <span class="n">base_slope</span><span class="o">=</span><span class="n">slope</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak-190"><a href="#Spectrum.find_peak_multipeak-190"><span class="linenos">190</span></a>                                        <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="n">x_arr</span><span class="p">[</span><span class="n">li</span><span class="p">],</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">ri</span><span class="p">]),</span>
</span><span id="Spectrum.find_peak_multipeak-191"><a href="#Spectrum.find_peak_multipeak-191"><span class="linenos">191</span></a>                                        <span class="n">peaks</span><span class="o">=</span><span class="n">peak_group</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak-192"><a href="#Spectrum.find_peak_multipeak-192"><span class="linenos">192</span></a>
</span><span id="Spectrum.find_peak_multipeak-193"><a href="#Spectrum.find_peak_multipeak-193"><span class="linenos">193</span></a>    <span class="n">candidates</span> <span class="o">=</span> <span class="n">ListPeakCandidateMultiModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">peak_groups</span><span class="p">)</span>
</span><span id="Spectrum.find_peak_multipeak-194"><a href="#Spectrum.find_peak_multipeak-194"><span class="linenos">194</span></a>    <span class="k">return</span> <span class="n">candidates</span>
</span></pre></div>


            <div class="docstring"><p>Find groups of peaks in spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>spe:</strong>  internal use only</li>
<li><strong>prominence:</strong>  Optional. Defaults to None
If None the prominence value will be <code>spe.y_nose</code>. Reasonable value for
promience is <code>const * spe.y_noise_MAD</code>.</li>
<li><strong>wlen:</strong>  optional. Defaults to None.
wlen value used in <code>scipy.signal.find_peaks</code>. If wlen is None, 200 will be used.</li>
<li><strong>width:</strong>  optional. Defaults to None.
width value used in <code>scipy.signal.find_peaks</code>. If width is None, 2 will be used.</li>
<li><strong>hht_chain:</strong>  optional. Defaults to None.
List of hht_chain window sizes. If None, no hht sharpening is performed.</li>
<li><strong>bgm_kwargs:</strong>  kwargs for bayesian_gaussian_mixture</li>
<li>sharpening 'hht' or None. Defaults to None.
If 'hht' hht sharpening will be performed before finding peaks.</li>
<li><strong>strategy:</strong>  optional. Defauts to 'topo'.
Peakfinding method</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>ListPeakCandidateMultiModel: Located peak groups</p>
</blockquote>
</div>


                            </div>
                            <div id="Spectrum.find_peak_multipeak_filter" class="classattr">
                                        <input id="Spectrum.find_peak_multipeak_filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-add_spectrum_filter">@add_spectrum_filter</div>
        <div class="decorator decorator-validate_call">@validate_call(config=dict(arbitrary_types_allowed=True))</div>

        <span class="def">def</span>
        <span class="name">find_peak_multipeak_filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">old_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="n">new_spe</span><span class="p">:</span> <span class="n"><a href="#Spectrum">Spectrum</a></span>,</span><span class="param">	<span class="o">/</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectrum.find_peak_multipeak_filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectrum.find_peak_multipeak_filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectrum.find_peak_multipeak_filter-197"><a href="#Spectrum.find_peak_multipeak_filter-197"><span class="linenos">197</span></a><span class="nd">@add_spectrum_filter</span>
</span><span id="Spectrum.find_peak_multipeak_filter-198"><a href="#Spectrum.find_peak_multipeak_filter-198"><span class="linenos">198</span></a><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Spectrum.find_peak_multipeak_filter-199"><a href="#Spectrum.find_peak_multipeak_filter-199"><span class="linenos">199</span></a><span class="k">def</span><span class="w"> </span><span class="nf">find_peak_multipeak_filter</span><span class="p">(</span>
</span><span id="Spectrum.find_peak_multipeak_filter-200"><a href="#Spectrum.find_peak_multipeak_filter-200"><span class="linenos">200</span></a>        <span class="n">old_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak_filter-201"><a href="#Spectrum.find_peak_multipeak_filter-201"><span class="linenos">201</span></a>        <span class="n">new_spe</span><span class="p">:</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
</span><span id="Spectrum.find_peak_multipeak_filter-202"><a href="#Spectrum.find_peak_multipeak_filter-202"><span class="linenos">202</span></a>        <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Spectrum.find_peak_multipeak_filter-203"><a href="#Spectrum.find_peak_multipeak_filter-203"><span class="linenos">203</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Spectrum.find_peak_multipeak_filter-204"><a href="#Spectrum.find_peak_multipeak_filter-204"><span class="linenos">204</span></a><span class="sd">    Same as `find_peak_multipeak` but the result is stored as metadata in the returned spectrum.</span>
</span><span id="Spectrum.find_peak_multipeak_filter-205"><a href="#Spectrum.find_peak_multipeak_filter-205"><span class="linenos">205</span></a>
</span><span id="Spectrum.find_peak_multipeak_filter-206"><a href="#Spectrum.find_peak_multipeak_filter-206"><span class="linenos">206</span></a><span class="sd">    Args:</span>
</span><span id="Spectrum.find_peak_multipeak_filter-207"><a href="#Spectrum.find_peak_multipeak_filter-207"><span class="linenos">207</span></a><span class="sd">        old_spe: internal use only</span>
</span><span id="Spectrum.find_peak_multipeak_filter-208"><a href="#Spectrum.find_peak_multipeak_filter-208"><span class="linenos">208</span></a><span class="sd">        new_spe: internal use only</span>
</span><span id="Spectrum.find_peak_multipeak_filter-209"><a href="#Spectrum.find_peak_multipeak_filter-209"><span class="linenos">209</span></a><span class="sd">        *args, **kwargs: same as `find_peak_multipeak`</span>
</span><span id="Spectrum.find_peak_multipeak_filter-210"><a href="#Spectrum.find_peak_multipeak_filter-210"><span class="linenos">210</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Spectrum.find_peak_multipeak_filter-211"><a href="#Spectrum.find_peak_multipeak_filter-211"><span class="linenos">211</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">old_spe</span><span class="o">.</span><span class="n">find_peak_multipeak</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="Spectrum.find_peak_multipeak_filter-212"><a href="#Spectrum.find_peak_multipeak_filter-212"><span class="linenos">212</span></a>    <span class="n">new_spe</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Same as <code><a href="#Spectrum.find_peak_multipeak">find_peak_multipeak</a></code> but the result is stored as metadata in the returned spectrum.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>old_spe:</strong>  internal use only</li>
<li><strong>new_spe:</strong>  internal use only</li>
<li><strong><em>args, *</em>kwargs:</strong>  same as <code><a href="#Spectrum.find_peak_multipeak">find_peak_multipeak</a></code></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../misc/plottable.html#Plottable">ramanchada2.misc.plottable.Plottable</a></dt>
                                <dd id="Spectrum.plot" class="function"><a href="../misc/plottable.html#Plottable.plot">plot</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>